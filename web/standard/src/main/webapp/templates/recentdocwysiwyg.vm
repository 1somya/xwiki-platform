<div class="xwikidatacontent">
    #set($rsvc= $xwiki.xWiki.getRightService())
    #if ($request.getParameter("text"))
    #set ($text = $request.getParameter("text") )
    #else
    #set($text = "")
    #end
    <p style="font-weight:bold"> $msg.get("listofrecentlyviewedpages") : </p>
    #set ($sql = "where doc.name like '%$text%' order by doc.date desc")
    #set ($start = 0)
    #set ($nb = 50)

    <!--
    Sql: $sql
    Sql: $start
    Sql: $nb
    -->
    <table width="95%">
    #set($counter=0)
    #foreach ($item in $xwiki.searchDocuments($sql , $nb , $start))
    #if ($xwiki.hasAccessLevel("view", "${context.database}:${item}"))
    #if($counter < 13)
    <tr>
    #set($bentrydoc = $xwiki.getDocument($item))
      <td>* <a href="#" onclick="document.forms[0].wiki_page.value='$bentrydoc.name';if ('$doc.web' != '$bentrydoc.web') document.forms[0].wiki_space.value='$bentrydoc.web'; else document.forms[0].wiki_space.value=''; return false;">
          $bentrydoc.name </a>in $bentrydoc.web space. Created by  $xwiki.getLocalUserName($bentrydoc.author) on $xwiki.formatDate($bentrydoc.date,"MMMM dd, yyyy HH:mm") </td>
    </tr>
    #end
    #end
    #set( $counter = $counter + 1)
    #end
    </table>
</div>