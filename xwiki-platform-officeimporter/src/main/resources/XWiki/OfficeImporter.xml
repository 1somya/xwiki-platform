<?xml version="1.0" encoding="UTF-8"?>
<xwikidoc>
<web>XWiki</web>
<name>OfficeImporter</name>
<language></language>
<defaultLanguage>en</defaultLanguage>
<translation>0</translation>
<parent>XWiki.WebHome</parent>
<creator>XWiki.Admin</creator>
<author>XWiki.Admin</author>
<customClass></customClass>
<contentAuthor>XWiki.Admin</contentAuthor>
<creationDate>1217261143000</creationDate>
<date>1243420465000</date>
<contentUpdateDate>1243420465000</contentUpdateDate>
<version>21.1</version>
<title>Office Importer</title>
<template></template>
<defaultTemplate></defaultTemplate>
<validationScript></validationScript>
<comment></comment>
<minorEdit>false</minorEdit>
<syntaxId>xwiki/1.0</syntaxId>
<hidden>false</hidden>
<class>
<name>XWiki.OfficeImporter</name>
<customClass></customClass>
<customMapping></customMapping>
<defaultViewSheet></defaultViewSheet>
<defaultEditSheet></defaultEditSheet>
<defaultWeb></defaultWeb>
<nameField></nameField>
<validationScript></validationScript>
<spacesList>
<cache>0</cache>
<classname></classname>
<displayType>select</displayType>
<idField></idField>
<multiSelect>0</multiSelect>
<name>spacesList</name>
<number>1</number>
<picker>0</picker>
<prettyName>spacesList</prettyName>
<relationalStorage>0</relationalStorage>
<separator> </separator>
<separators></separators>
<size>1</size>
<sort>none</sort>
<sql>select distinct doc.space from XWikiDocument doc</sql>
<unmodifiable>0</unmodifiable>
<validationMessage></validationMessage>
<validationRegExp></validationRegExp>
<valueField></valueField>
<classType>com.xpn.xwiki.objects.classes.DBListClass</classType>
</spacesList>
</class>
<content>{pre}
&lt;script type="text/javascript"&gt;
function populateTargetPageInputField(fileName) {
  var dot = fileName.lastIndexOf(".");
  if (-1 != dot) {
    fileName = fileName.substring(0, dot);
  }
  fileName = fileName.replace(/[\.:]/g, "-");
  document.officeImporterForm.targetPage.value = fileName;
}
&lt;/script&gt;
{/pre}

#if($isguest)
  #error($msg.get("xe.officeimporter.notallowed"))  
#else
  #if($request.page)
    #set($targetdoc = $xwiki.getDocument($request.page))
  #end
  &lt;h1&gt;$msg.get("xe.officeimporter.import.title")&lt;/h1&gt;
  &lt;form name="officeImporterForm" action="$xwiki.getURL('XWiki.OfficeImporterResults','view')" enctype="multipart/form-data" method="post"&gt;
  {table}
  &lt;p&gt;$msg.get("xe.officeimporter.import.document")&lt;/p&gt;|&lt;p&gt;&lt;input id="filepath" type="file" name="filePath" value="" size="40" onChange="javascript:populateTargetPageInputField(this.value);"/&gt;&lt;/p&gt;

  &lt;p&gt;$msg.get("xe.officeimporter.import.targetspace")&lt;/p&gt;|&lt;p&gt;&lt;input id="targetSpaceInputId" type="text" name="targetSpace" value="$!{targetdoc.space}"/&gt;&lt;/p&gt;

  &lt;p&gt;$msg.get("xe.officeimporter.import.targetpage")&lt;/p&gt;|&lt;p&gt;&lt;input name="targetPage" type="text" value="$!{targetdoc.name}" onChange="javascript:validateUserInputs();"/&gt; &lt;input name="appendContent" type="checkbox" value="true"/&gt;$msg.get("xe.officeimporter.import.appendresult")&lt;/p&gt;  

  &lt;p&gt;$msg.get("xe.officeimporter.import.styles")&lt;/p&gt;|&lt;p&gt;&lt;input name="filterStyles" type="checkbox" value="strict" $filter/&gt;$msg.get("xe.officeimporter.import.filterstyles")&lt;/p&gt;

  &lt;p&gt;$msg.get("xe.officeimporter.import.splitting")&lt;/p&gt;|&lt;p&gt;&lt;input name="splitDocument" type="checkbox" value="true"/&gt; $msg.get("xe.officeimporter.import.splitting.splitdocument")&lt;br/&gt;&lt;br/&gt;&amp;nbsp;$msg.get("xe.officeimporter.import.splitting.headinglevels"): &lt;br/&gt;&lt;br/&gt;&amp;nbsp;&lt;select size="5" multiple="multiple" name="headingLevelsToSplit"&gt;#foreach($h in [1..6]) &lt;option value="${h}"&gt;$msg.get("xe.officeimporter.import.splitting.heading")-${h}&lt;/option&gt;#end&lt;/select&gt;&lt;br/&gt;&lt;br/&gt;&amp;nbsp;$msg.get("xe.officeimporter.import.splitting.naming"): &lt;select name="childPagesNamingMethod"&gt;&lt;option value="headingNames"&gt;$msg.get("xe.officeimporter.import.splitting.naming.headingnames")&lt;/option&gt;&lt;option value="mainPageNameAndHeading"&gt;$msg.get("xe.officeimporter.import.splitting.naming.mainpagenameandheading")&lt;/option&gt;&lt;option value="mainPageNameAndNumbering"&gt;$msg.get("xe.officeimporter.import.splitting.naming.mainpagenameandnumbering")&lt;/option&gt;&lt;/select&gt;&lt;/p&gt;
  {table}
  &lt;input type="hidden" name="groovyFilter" value="" /&gt;
  &lt;p&gt;&lt;input type="submit" value="$msg.get("xe.officeimporter.import.import")"/&gt;&lt;/p&gt;
  &lt;/form&gt;
#end

{pre}
&lt;script type="text/javascript"&gt;
  var field = document.getElementById("targetSpaceInputId");
  if (typeof(XWiki.widgets.Suggest) != "undefined") {
    new XWiki.widgets.Suggest(field, {
        script: "$doc.URL?xpage=suggest&amp;classname=$doc.fullName&amp;fieldname=spacesList&amp;firCol=space&amp;secCol=-&amp;",
    });  
  }
&lt;/script&gt;
{/pre}</content>
</xwikidoc>