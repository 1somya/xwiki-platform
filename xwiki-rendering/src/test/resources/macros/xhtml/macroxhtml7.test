.#----------------------------------------------------------------------------------
.input|xwiki/2.0
.# Verify that the XHTML Macro knows how to handle CDATA and that they are not lost.
.# Also verify that characters are not escaped when inside the CDATA section.
.#----------------------------------------------------------------------------------
{{xhtml escapeWikiSyntax="true"}}
<script type="text/javascript">
   //<![CDATA[
         if (2 > 1)
             alert("Hello, World")
   // ]]>
</script>
{{/xhtml}}
.#-----------------------------------------------------
.expect|event
.#-----------------------------------------------------
beginDocument
beginMacroMarker [xhtml] [escapeWikiSyntax=true] [
<script type="text/javascript">
   //<![CDATA[
         if (2 > 1)
             alert("Hello, World")
   // ]]>
</script>
]
beginXMLNode [script] [type=text/javascript]
onWord [//]
beginXMLNode [CDATA]
onWord [
         if (2 > 1)
             alert("Hello, World")
   // ]
endXMLNode [CDATA]
endXMLNode [script] [type=text/javascript]
endMacroMarker [xhtml] [escapeWikiSyntax=true] [
<script type="text/javascript">
   //<![CDATA[
         if (2 > 1)
             alert("Hello, World")
   // ]]>
</script>
]
endDocument
.#-----------------------------------------------------
.expect|xhtml
.#-----------------------------------------------------
<!--startmacro:xhtml|-|escapeWikiSyntax="true"|-|
<script type="text/javascript">
   //<![CDATA[
         if (2 > 1)
             alert("Hello, World")
   // ]]>
</script>
--><script type="text/javascript">//<![CDATA[
         if (2 > 1)
             alert("Hello, World")
   // ]]></script><!--stopmacro-->