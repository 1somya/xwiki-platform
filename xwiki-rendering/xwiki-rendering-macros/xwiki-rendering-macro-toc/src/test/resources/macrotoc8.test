.#-----------------------------------------------------
.input|xwiki/2.0
.#-----------------------------------------------------
{{toc/}}

= h1 =

== h2 ==
.#-----------------------------------------------------
.expect|event/1.0
.#-----------------------------------------------------
beginDocument
beginMacroMarkerStandalone [toc] [] []
beginList [BULLETED]
beginListItem
beginLink [Anchor = [testid]] [false]
onWord [h2]
endLink [Anchor = [testid]] [false]
endListItem
endList [BULLETED]
endMacroMarkerStandalone [toc] [] []
beginSection
beginHeader [1]
onWord [h1]
endHeader [1]
beginSection
onId [testid]
beginHeader [2]
onWord [h2]
endHeader [2]
endSection
endSection
endDocument
.#-----------------------------------------------------
.expect|xhtml/1.0
.#-----------------------------------------------------
<!--startmacro:toc|-||-|--><ul><li><!--startwikilink:#testid--><span class="wikilink"><a href="/xwiki/bin/view/currentdoc#testid">h2</a></span><!--stopwikilink--></li></ul><!--stopmacro--><h1 id="Hh1"><span>h1</span></h1><a id="testid" name="testid"></a><h2 id="Hh2"><span>h2</span></h2>
.#-----------------------------------------------------
.input|xhtml/1.0|skip
.# The problem is that the Id macro can generate invalid XHTML (in this example it generates a A element at the level of BODY).
.# see http://jira.xwiki.org/jira/browse/XWIKI-3367
.#-----------------------------------------------------
<!--startmacro:toc|-||-|--><ul><li><!--startwikilink:#testid--><span class="wikilink"><a href="/xwiki/bin/view/currentdoc#testid">h2</a></span><!--stopwikilink--></li></ul><!--stopmacro--><h1 id="Hh1"><span>h1</span></h1><a id="testid" name="testid"></a><h2 id="Hh2"><span>h2</span></h2>