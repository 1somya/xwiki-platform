<?xml version="1.0" encoding="UTF-8"?>

<!--
 *
 * See the NOTICE file distributed with this work for additional
 * information regarding copyright ownership.
 *
 * This is free software; you can redistribute it and/or modify it
 * under the terms of the GNU Lesser General Public License as
 * published by the Free Software Foundation; either version 2.1 of
 * the License, or (at your option) any later version.
 *
 * This software is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this software; if not, write to the Free
 * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
 * 02110-1301 USA, or see the FSF site: http://www.fsf.org.
 *
-->

<component-set>
  <components>
    <component>
      <role>org.xwiki.rendering.parser.Parser</role>
      <role-hint>xwiki/1.0</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.XWikiParser</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <requirements>
        <requirement>
          <role>org.xwiki.rendering.parser.xwiki10.Filter</role>
          <field-name>filters</field-name>
        </requirement>
        <requirement>
          <role>org.xwiki.rendering.parser.Parser</role>
          <role-hint>xwiki/2.0</role-hint>
        </requirement>
      </requirements>
    </component>

    <!-- Replace \r\n and \r by \n to simplify following regex -->
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.Filter</role>
      <role-hint>nl</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.NewLineFilter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <configuration>
        <priority>0</priority>
      </configuration>
    </component>

    <!-- Code macro -->
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.Filter</role>
      <role-hint>code</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.CodeMacroFilter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <configuration>
        <priority>10</priority>
      </configuration>
      <requirements>
        <requirement>
          <role>org.xwiki.rendering.parser.xwiki10.macro.RadeoxMacroConverter</role>
          <role-hint>code</role-hint>
        </requirement>
      </requirements>
    </component>

    <!-- Protect velocity comments, convert velocity macro into 2.9 macros/syntax and add needed 2.0 velocity macros and convert -->
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.Filter</role>
      <role-hint>velocity</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.VelocityFilter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <configuration>
        <priority>20</priority>
      </configuration>
    </component>
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.macro.VelocityMacroConverter</role>
      <role-hint>includeInContext</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.macro.IncludeInContextVelocityMacroConverter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
    </component>
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.macro.VelocityMacroConverter</role>
      <role-hint>includeTopic</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.macro.IncludeTopicVelocityMacroConverter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
    </component>
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.macro.VelocityMacroConverter</role>
      <role-hint>includeMacros</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.macro.IncludeInContextVelocityMacroConverter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
    </component>
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.macro.VelocityMacroConverter</role>
      <role-hint>includeForm</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.macro.IncludeInContextVelocityMacroConverter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
    </component>
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.macro.VelocityMacroConverter</role>
      <role-hint>toc</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.macro.TocVelocityMacroConverter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
    </component>
    
    <!-- Groovy macro -->
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.Filter</role>
      <role-hint>groovy</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.GroovyFilter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <configuration>
        <priority>30</priority>
      </configuration>
    </component>
    
    <!-- Radeox macros -->
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.Filter</role>
      <role-hint>radeoxmacros</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.RadeoxMacrosFilter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <configuration>
        <priority>100</priority>
      </configuration>
    </component>
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.macro.RadeoxMacroConverter</role>
      <role-hint>attach</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.macro.AttachRadeoxMacroConverter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
    </component>
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.macro.RadeoxMacroConverter</role>
      <role-hint>image</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.macro.ImageRadeoxMacroConverter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
    </component>
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.macro.RadeoxMacroConverter</role>
      <role-hint>code</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.macro.CodeRadeoxMacroConverter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
    </component>
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.macro.RadeoxMacroConverter</role>
      <role-hint>table</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.macro.TableRadeoxMacroConverter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
    </component>
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.macro.RadeoxMacroConverter</role>
      <role-hint>quote</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.macro.QuoteRadeoxMacroConverter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <requirements>
        <requirement>
          <role>org.xwiki.rendering.parser.xwiki10.Filter</role>
          <role-hint>standalonenewlinecleanning</role-hint>
        </requirement>
      </requirements>
    </component>
    
    <!-- Pre filter -->
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.Filter</role>
      <role-hint>pre</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.PreFilter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <configuration>
        <priority>100</priority>
      </configuration>
    </component>
    
    <!-- Wiki Syntaxes -->
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.Filter</role>
      <role-hint>hr</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.HrFilter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <configuration>
        <priority>800</priority>
      </configuration>
    </component>
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.Filter</role>
      <role-hint>list</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.ListSyntaxFilter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <configuration>
        <priority>900</priority>
      </configuration>
    </component>
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.Filter</role>
      <role-hint>link</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.LinkSyntaxFilter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <configuration>
        <priority>1000</priority>
      </configuration>
    </component>
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.Filter</role>
      <role-hint>url</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.UrlFilter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <configuration>
        <priority>1000</priority>
      </configuration>
    </component>
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.Filter</role>
      <role-hint>section</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.SectionSyntaxFilter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <configuration>
        <priority>1000</priority>
      </configuration>
    </component>
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.Filter</role>
      <role-hint>italic</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.ItalicSyntaxFilter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <configuration>
        <priority>1000</priority>
      </configuration>
    </component>
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.Filter</role>
      <role-hint>bold</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.BoldSyntaxFilter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <configuration>
        <priority>1000</priority>
      </configuration>
    </component>
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.Filter</role>
      <role-hint>strikeout</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.StrikeoutSyntaxFilter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <configuration>
        <priority>1000</priority>
      </configuration>
    </component>
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.Filter</role>
      <role-hint>underline</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.UnderlineSyntaxFilter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <configuration>
        <priority>1000</priority>
      </configuration>
    </component>
    
    <!-- XHTML spaces interpretation -->
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.Filter</role>
      <role-hint>standalonenewlinecleanning</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.StandaloneNewLineCleaningFilter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <configuration>
        <priority>2000</priority>
      </configuration>
    </component>
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.Filter</role>
      <role-hint>spacescleanning</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.SpacesCleaningFilter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <configuration>
        <priority>2000</priority>
      </configuration>
    </component>
    
    <!-- HTML syntax filter -->
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.Filter</role>
      <role-hint>htmlmacro</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.HTMLFilter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <configuration>
        <priority>3000</priority>
      </configuration>
    </component>
    
    <!-- 2.0 syntax escaping filter -->
    <component>
      <role>org.xwiki.rendering.parser.xwiki10.Filter</role>
      <role-hint>escape</role-hint>
      <implementation>org.xwiki.rendering.internal.parser.xwiki10.Escape20SyntaxFilter</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <configuration>
        <priority>10000</priority>
      </configuration>
    </component>
  </components>
</component-set>
