<component-set>
  <components>
    <!-- The registry component allows using Jakarta Commons Configuration to store configuration
         data for XWiki components, in addition to using components.xml files. This allows storing
         configurations files in various formats (properties file, xml files, in a database, etc).
         See Jakarta Commons Configuration for all options.
    -->
    <!-- Note: We're not using it yet. We need to ensure it works fine before we do so. We
         haven't tested it yet. We also need to decide if we need to implement our own solution.
         For example the current Registry implementation will not let component access to general
         configuration data, only those configured for the component in question.
    <component>
      <role>org.codehaus.plexus.registry.Registry</role>
      <implementation>org.codehaus.plexus.registry.commons.CommonsConfigurationRegistry</implementation>
      <role-hint>commons-configuration</role-hint>
      <configuration>
        <properties>
          Q: How can we put this file in WEB-INF/
          <properties fileName="xwiki.properties" config-at="org.xwiki"/>
        </properties>
      </configuration>
     </component-->

    <!-- Components added for testing -->

    <component>
      <role>org.xwiki.rendering.macro.Macro</role>
      <role-hint>testsimplemacro/xwiki</role-hint>
      <implementation>org.xwiki.rendering.transformation.TestSimpleMacro</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <lifecycle-handler>xwiki</lifecycle-handler>
    </component>
    <component>
      <role>org.xwiki.rendering.macro.Macro</role>
      <role-hint>testnestedmacro/xwiki</role-hint>
      <implementation>org.xwiki.rendering.transformation.TestNestedMacro</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <lifecycle-handler>xwiki</lifecycle-handler>
    </component>
    <component>
      <role>org.xwiki.rendering.macro.Macro</role>
      <role-hint>testrecursivemacro/xwiki</role-hint>
      <implementation>org.xwiki.rendering.transformation.TestRecursiveMacro</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <lifecycle-handler>xwiki</lifecycle-handler>
    </component>
    <component>
      <role>org.xwiki.rendering.macro.Macro</role>
      <role-hint>testprioritymacro/xwiki</role-hint>
      <implementation>org.xwiki.rendering.transformation.TestPriorityMacro</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <lifecycle-handler>xwiki</lifecycle-handler>
      <configuration>
        <!-- Ensure that this macro gets executed before the other macros for testing priorities -->
        <priority>500</priority>
      </configuration>
    </component>

    <!-- Override default Velocity Manager component implementation for testing -->
    <component>
      <role>org.xwiki.velocity.VelocityManager</role>
      <role-hint>default</role-hint>
      <implementation>org.xwiki.rendering.macro.MockVelocityManager</implementation>
      <instantiation-strategy>singleton</instantiation-strategy>
      <lifecycle-handler>xwiki</lifecycle-handler>
    </component>
  </components>
</component-set>
