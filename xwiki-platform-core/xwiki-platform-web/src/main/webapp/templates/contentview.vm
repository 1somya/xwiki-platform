###
### Display document contents in "view" mode.
###
## -------------------------------
## Compute the content to display 
## -------------------------------
#set($inlineSheets = $services.sheet.getInlineSheets($cdoc.documentReference, $context.action))
#set($renderedContent = $util.null)
#if($inlineSheets.isEmpty())
  #setVariable("$renderedContent" "#renderContent($cdoc.content $cdoc.syntax.toIdString())")
#else
  #foreach($inlineSheet in $inlineSheets)
    #set($sheetDoc = $xwiki.getDocument($inlineSheet))
    #set($renderedPartialContent = $util.null)
    #setVariable("$renderedPartialContent" "#renderContent($sheetDoc.content $sheetDoc.syntax.toIdString())")
    #set($renderedContent = "$!{renderedContent}$!{renderedPartialContent}")
  #end
#end
## ----------------------------------------------------------------------------
## Compute title to display and modify rendered content accordingly.
## ----------------------------------------------------------------------------
#template("titlevars.vm")
## ----------------------------
## Display the title
## ----------------------------
<div id="document-title"><h1>$titleToDisplay</h1></div>
## --------------------------------------------------------------------------
## Drop permissions as they are no longer needed. This allows us not to have
## to review the code below for security holes since nothing bad can happen.
## --------------------------------------------------------------------------
$xcontext.dropPermissions()
## ----------------------------
## Display the shortcuts
## ----------------------------
#if($displayShortcuts)
  #template("shortcuts.vm")
#end
## ----------------------------
## Display the rendered content
## ----------------------------
<div id="xwikicontent">
$renderedContent
</div>
## -----------------------------------------------------------------------------------
## Display the footnotes if the document is in 1.0 syntax and if there are any defined
## -----------------------------------------------------------------------------------
#set($footnotes = "#putFootnotes()")
$xwiki.renderText($footnotes, $doc)
