<?xml version="1.0" encoding="UTF-8"?>

<!--
 * See the NOTICE file distributed with this work for additional
 * information regarding copyright ownership.
 *
 * This is free software; you can redistribute it and/or modify it
 * under the terms of the GNU Lesser General Public License as
 * published by the Free Software Foundation; either version 2.1 of
 * the License, or (at your option) any later version.
 *
 * This software is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this software; if not, write to the Free
 * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
 * 02110-1301 USA, or see the FSF site: http://www.fsf.org.
-->

<xwikidoc version="1.2" reference="XWiki.OfficeImporterAdmin" locale="">
  <web>XWiki</web>
  <name>OfficeImporterAdmin</name>
  <language/>
  <defaultLanguage/>
  <translation>0</translation>
  <creator>xwiki:XWiki.Admin</creator>
  <creationDate>1235987110000</creationDate>
  <parent>XWiki.OfficeImporter</parent>
  <author>xwiki:XWiki.Admin</author>
  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>
  <date>1299711367000</date>
  <contentUpdateDate>1299711367000</contentUpdateDate>
  <version>1.1</version>
  <title>$services.localization.render('admin.ooserver')</title>
  <comment/>
  <minorEdit>false</minorEdit>
  <syntaxId>xwiki/2.1</syntaxId>
  <hidden>true</hidden>
  <content>{{velocity}}
###
### Perform actions (if asked)
###
#if ($hasAdmin &amp;&amp; $xcontext.isMainWiki())
  #set ($currentAction = "$!{request.action}")
  #if ($currentAction == 'stop' &amp;&amp; $services.csrf.isTokenValid("$!request.form_token"))
    #if(!$services.officemanager.stopServer())
      {{error}}$services.officemanager.lastErrorMessage{{/error}}

    #end
  #elseif ($currentAction == 'start' &amp;&amp; $services.csrf.isTokenValid("$!request.form_token"))
    #if (!$services.officemanager.startServer())
      {{error}}$services.officemanager.lastErrorMessage{{/error}}

    #end
  #elseif ($currentAction == 'restart' &amp;&amp; $services.csrf.isTokenValid("$!request.form_token"))
    #if (!$services.officemanager.stopServer())
      {{error}}$services.officemanager.lastErrorMessage{{/error}}

    #elseif (!$services.officemanager.startServer())
      {{error}}$services.officemanager.lastErrorMessage{{/error}}

    #end
  #end
#end
###
### Compute the correct actions name depending on the configuration.
### ex: use 'connect' if the office server is an external instance or 'start' if it's an internally managed instance
###
#set ($actionStart     = $services.localization.render('xe.officeimporter.openoffice.actions.connect'))
#set ($actionStop      = $services.localization.render('xe.officeimporter.openoffice.actions.disconnect'))
#set ($autoStart       = $services.localization.render('xe.officeimporter.openoffice.autoconnect'))
#if ($services.officemanager.config.serverType == 0)
  #set ($serverType    = $services.localization.render('xe.officeimporter.openoffice.servertype.internal'))
  #set ($actionStart   = $services.localization.render('xe.officeimporter.openoffice.actions.start'))
  #set ($actionStop    = $services.localization.render('xe.officeimporter.openoffice.actions.stop'))
  #set ($actionRestart = $services.localization.render('xe.officeimporter.openoffice.actions.restart'))
  #set ($autoStart     = $services.localization.render('xe.officeimporter.openoffice.autostart'))
#elseif ($services.officemanager.config.serverType == 1)
  #set ($serverType    = $services.localization.render('xe.officeimporter.openoffice.servertype.external'))
#elseif ($services.officemanager.config.serverType == 2)
  #set ($serverType    = $services.localization.render('xe.officeimporter.openoffice.servertype.remote'))
#end
###
### Display the configuration and the actions form
###
{{html}}
  &lt;form action="$xwiki.relativeRequestURL" method="post" class="xform"&gt;
    &lt;fieldset&gt;
      &lt;legend&gt;$escapetool.html($services.localization.render('admin.ooserver.options'))&lt;/legend&gt;
      ###
      ### Info about the place to modify the configuration
      ###
      &lt;p&gt;
        &lt;span class="box infomessage"&gt;
          ## TODO: we do not escape this string because we inject some HTML code. We should improve it.
          $services.localization.render('admin.ooserver.options.source', ['&lt;span class="monospace"&gt;xwiki.properties&lt;/span&gt;'])
        &lt;/span&gt;
      &lt;/p&gt;
      &lt;dl&gt;
        ###
        ### Server Type
        ###
        &lt;dt&gt;
          &lt;label&gt;$escapetool.html($services.localization.render('xe.officeimporter.openoffice.servertype'))&lt;/label&gt;
          &lt;span class="xHint"&gt;
            $escapetool.xml($services.localization.render('office.config.serverType.hint'))
          &lt;/span&gt;
        &lt;/dt&gt;
        &lt;dd&gt;$escapetool.html($serverType)&lt;/dd&gt;
        ###
        ### Server Port
        ###
        &lt;dt&gt;
          &lt;label&gt;$escapetool.html($services.localization.render('xe.officeimporter.openoffice.serverport'))&lt;/label&gt;
          &lt;span class="xHint"&gt;
            $escapetool.xml($services.localization.render('office.config.serverPort.hint'))
          &lt;/span&gt;
        &lt;/dt&gt;
        &lt;dd&gt;$escapetool.html($services.officemanager.config.serverPort)&lt;/dd&gt;
        ###
        ### Auto Start
        ###
        &lt;dt&gt;
          &lt;label&gt;$escapetool.html($autoStart)&lt;/label&gt;
          &lt;span class="xHint"&gt;
            $escapetool.xml($services.localization.render('office.config.autoStart.hint'))
          &lt;/span&gt;
        &lt;/dt&gt;
        &lt;dd&gt;
          #if($services.officemanager.config.autoStart)
            $escapetool.html($services.localization.render('xe.officeimporter.openoffice.yes'))
          #else
            $escapetool.html($services.localization.render('xe.officeimporter.openoffice.no'))
          #end
        &lt;/dd&gt;
        ###
        ### If the server is an internally managed office server instance.
        ###
        #if($services.officemanager.config.serverType == 0)
          ###
          ### Server Path
          ###
          &lt;dt&gt;
            &lt;label&gt;$escapetool.html($services.localization.render('xe.officeimporter.openoffice.serverpath'))&lt;/label&gt;
            &lt;span class="xHint"&gt;
              $escapetool.xml($services.localization.render('office.config.serverPath.hint'))
            &lt;/span&gt;
          &lt;/dt&gt;
          &lt;dd&gt;#set ($homePath = $services.officemanager.config.homePath)
              #if ("$!homePath" != '')
                $escapetool.html($homePath)
              #else
                &lt;div class="box errormessage"&gt;$escapetool.html($services.localization.render('office.configuration.serverpath.error.notSetNotAutodetected'))&lt;/div&gt;
              #end
          &lt;/dd&gt;
          ###
          ### Server Profile
          ###
          &lt;dt&gt;&lt;label&gt;$escapetool.html($services.localization.render('xe.officeimporter.openoffice.serverprofile'))&lt;/label&gt;&lt;/dt&gt;
          &lt;dd&gt;
            #if("$!services.officemanager.config.profilePath" == '' &amp;&amp; $services.officemanager.config.profilePath != '')
              $escapetool.html($services.localization.render('xe.officeimporter.openoffice.serverprofile.default'))
            #else
              $escapetool.html($services.officemanager.config.profilePath)
            #end
          &lt;/dd&gt;
        #end
        ###
        ### Server State
        ###
        &lt;dt&gt;&lt;label&gt;$escapetool.html($services.localization.render('xe.officeimporter.openoffice.serverstate'))&lt;/label&gt;&lt;/dt&gt;
        &lt;dd&gt;$escapetool.html($services.officemanager.serverState)&lt;/dd&gt;
      &lt;/dl&gt;
    &lt;/fieldset&gt;
    ###
    ### Actions
    ###
    #if($hasAdmin &amp;&amp; $xcontext.isMainWiki())
      &lt;fieldset&gt;
        &lt;legend&gt;$escapetool.html($services.localization.render('xe.officeimporter.openoffice.actions'))&lt;/legend&gt;
        ###
        ### Start server
        ###
        &lt;p&gt;&lt;label for="action1"&gt;&lt;input id="action1" name="action" type="radio" value="start" checked="checked"/&gt; $escapetool.html($actionStart)&lt;/label&gt;&lt;/p&gt;
        ###
        ### Stop Server
        ###
        &lt;p&gt;&lt;label for="action2"&gt;&lt;input id="action2" name="action" type="radio" value="stop"/&gt; $escapetool.html($actionStop)&lt;/label&gt;&lt;/p&gt;
        ###
        ### Restart Server
        ###
        #if($actionRestart)
          &lt;p&gt;&lt;label for="action3"&gt;&lt;input id="action3" name="action" type="radio" value="restart"/&gt; $escapetool.html($actionRestart)&lt;/label&gt;&lt;/p&gt;
        #end
      &lt;/fieldset&gt;
      ###
      ### Button to perform the action
      ###
      &lt;div class="buttons"&gt;
        &lt;input type="hidden" name="form_token" value="$!{services.csrf.getToken()}" /&gt;
        &lt;span class="buttonwrapper"&gt;&lt;input type="submit" value="$escapetool.html($services.localization.render('xe.officeimporter.openoffice.update'))" class="button"/&gt;&lt;/span&gt;
      &lt;/div&gt;
    #end
  &lt;/form&gt;
{{/html}}

###
### Display a warning message if the wiki is not the main one
###
#if($hasAdmin &amp;&amp; !$xcontext.isMainWiki())
  {{info}}$services.localization.render('xe.officeimporter.openoffice.limitedcontrol'){{/info}}
#end
{{/velocity}}
</content>
  <attachment>
    <filename>icon.png</filename>
    <author>xwiki:XWiki.Admin</author>
    <date>1503912297000</date>
    <version>1.1</version>
    <comment/>
    <content/>
    <filesize>0</filesize>
  </attachment>
  <object>
    <name>XWiki.OfficeImporterAdmin</name>
    <number>0</number>
    <className>XWiki.ConfigurableClass</className>
    <guid>6a2961ee-0b0e-4ca8-b039-c26365dd2bd1</guid>
    <class>
      <name>XWiki.ConfigurableClass</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <categoryIcon>
        <customDisplay/>
        <disabled>0</disabled>
        <name>categoryIcon</name>
        <number>11</number>
        <picker>0</picker>
        <prettyName>categoryIcon</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </categoryIcon>
      <codeToExecute>
        <customDisplay/>
        <disabled>0</disabled>
        <editor>Text</editor>
        <name>codeToExecute</name>
        <number>7</number>
        <picker>0</picker>
        <prettyName>codeToExecute</prettyName>
        <rows>5</rows>
        <size>40</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </codeToExecute>
      <configurationClass>
        <customDisplay/>
        <disabled>0</disabled>
        <name>configurationClass</name>
        <number>3</number>
        <picker>0</picker>
        <prettyName>configurationClass</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </configurationClass>
      <configureGlobally>
        <customDisplay/>
        <defaultValue/>
        <disabled>0</disabled>
        <displayFormType>checkbox</displayFormType>
        <displayType/>
        <name>configureGlobally</name>
        <number>4</number>
        <prettyName>configureGlobally</prettyName>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </configureGlobally>
      <displayBeforeCategory>
        <customDisplay/>
        <disabled>0</disabled>
        <name>displayBeforeCategory</name>
        <number>10</number>
        <picker>0</picker>
        <prettyName>displayBeforeCategory</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </displayBeforeCategory>
      <displayInCategory>
        <customDisplay/>
        <disabled>0</disabled>
        <name>displayInCategory</name>
        <number>9</number>
        <picker>0</picker>
        <prettyName>displayInCategory</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </displayInCategory>
      <displayInSection>
        <customDisplay/>
        <disabled>0</disabled>
        <name>displayInSection</name>
        <number>1</number>
        <picker>0</picker>
        <prettyName>displayInSection</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </displayInSection>
      <heading>
        <customDisplay/>
        <disabled>0</disabled>
        <name>heading</name>
        <number>2</number>
        <picker>0</picker>
        <prettyName>heading</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </heading>
      <iconAttachment>
        <customDisplay/>
        <disabled>0</disabled>
        <name>iconAttachment</name>
        <number>8</number>
        <picker>0</picker>
        <prettyName>iconAttachment</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </iconAttachment>
      <linkPrefix>
        <customDisplay/>
        <disabled>0</disabled>
        <name>linkPrefix</name>
        <number>5</number>
        <picker>0</picker>
        <prettyName>linkPrefix</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </linkPrefix>
      <propertiesToShow>
        <cache>0</cache>
        <customDisplay/>
        <disabled>0</disabled>
        <displayType>input</displayType>
        <multiSelect>1</multiSelect>
        <name>propertiesToShow</name>
        <number>6</number>
        <picker>0</picker>
        <prettyName>propertiesToShow</prettyName>
        <relationalStorage>1</relationalStorage>
        <separator> </separator>
        <separators> ,|</separators>
        <size>20</size>
        <sort>none</sort>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <values/>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </propertiesToShow>
      <sectionOrder>
        <customDisplay/>
        <disabled>0</disabled>
        <name>sectionOrder</name>
        <number>12</number>
        <numberType>integer</numberType>
        <prettyName>sectionOrder</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <classType>com.xpn.xwiki.objects.classes.NumberClass</classType>
      </sectionOrder>
    </class>
    <property>
      <categoryIcon/>
    </property>
    <property>
      <codeToExecute/>
    </property>
    <property>
      <configurationClass/>
    </property>
    <property>
      <configureGlobally>1</configureGlobally>
    </property>
    <property>
      <displayBeforeCategory/>
    </property>
    <property>
      <displayInCategory>content</displayInCategory>
    </property>
    <property>
      <displayInSection>XWiki.OfficeImporterAdmin</displayInSection>
    </property>
    <property>
      <heading/>
    </property>
    <property>
      <iconAttachment/>
    </property>
    <property>
      <linkPrefix/>
    </property>
    <property>
      <propertiesToShow/>
    </property>
    <property>
      <sectionOrder>600</sectionOrder>
    </property>
  </object>
  <object>
    <name>XWiki.OfficeImporterAdmin</name>
    <number>0</number>
    <className>XWiki.RequiredRightClass</className>
    <guid>eba90c4d-f5d5-4029-815c-97e09894854b</guid>
    <class>
      <name>XWiki.RequiredRightClass</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <level>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>0</multiSelect>
        <name>level</name>
        <number>1</number>
        <picker>0</picker>
        <prettyName>level</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <separators> ,|</separators>
        <size>1</size>
        <sort>none</sort>
        <unmodifiable>0</unmodifiable>
        <validationMessage/>
        <validationRegExp/>
        <values>edit|programming</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </level>
    </class>
    <property>
      <level>programming</level>
    </property>
  </object>
</xwikidoc>
