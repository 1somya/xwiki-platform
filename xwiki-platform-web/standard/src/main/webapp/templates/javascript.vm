##
## CSS files related to JS libraries.
##
<link href="$xwiki.getSkinFile("js/xwiki/fullscreenedit/fullscreenEdit.css")" rel="stylesheet" type="text/css" />
<link href="$xwiki.getSkinFile("js/xwiki/usersandgroups/usersandgroups.css", true)" rel="stylesheet" type="text/css" />
<link href="$xwiki.getSkinFile("js/xwiki/suggest/ajaxSuggest.css")" rel="stylesheet" type="text/css" />
<link href="$xwiki.getSkinFile("js/xwiki/lightbox/lightbox.css", true)" rel="stylesheet" type="text/css" />
<!--[if IE]>
  <link href="$xwiki.getSkinFile("js/xwiki/lightbox/lightboxIE.css", true)" rel="stylesheet" type="text/css" />
<![endif]-->
##
## JS Libraries.
##
<script type="text/javascript" src="$xwiki.getSkinFile("js/xwiki/xwiki.js", true)"></script>
<script type="text/javascript" src="$xwiki.getSkinFile("js/xwiki/util/skin.js")"></script>
<script type="text/javascript" src="$xwiki.getSkinFile("js/xwiki/util/browserdetect.js")"></script>
<script type="text/javascript" src="$xwiki.getSkinFile("js/xwiki/util/shortcuts.js", true)"></script>
<script type="text/javascript" src="$xwiki.getSkinFile("js/prototype/prototype.js")"></script>
<script type="text/javascript" src="$xwiki.getSkinFile("js/xwiki/fullscreenedit/fullscreenEdit.js", true)"></script>
<script type="text/javascript" src="$xwiki.getSkinFile("js/xwiki/usersandgroups/usersandgroups.js", true)"></script>
<script type="text/javascript" src="$xwiki.getSkinFile("js/xwiki/suggest/ajaxSuggest.js")"></script>
<script type="text/javascript" src="$xwiki.getSkinFile("js/xwiki/lightbox/lightbox.js", true)"></script>
<script type="text/javascript">
// <![CDATA[
XWiki.webapppath = "${xwiki.webAppPath}";
XWiki.servletpath = "${xwiki.servletPath}";
// ]]>
</script>
#if(($context.action=="inline")||($context.action=="edit") || ($context.action=="admin"))
<script type="text/javascript">
// <![CDATA[
 var cancelEditNextOnunload;
 var cancelCancelEditFlag = true;
 var  lockEditFlag = false;

 function cancelEditResponse(){
 }

 function cancelEdit(){
     if (cancelCancelEditFlag) {
       var surl = "$doc.getExternalURL("cancel", "ajax=1")";
       var myAjax = new Ajax.Request(
                 surl,
                 {
                     method: 'get',
                     parameters: "",
                     asynchronous: true,
                     discardResponse: true
                 });
        cancelCancelEditFlag = false;
     }
     if (cancelEditNextOnunload!=null)
           cancelEditNextOnunload();
 }

 function lockEdit(){
    if (lockEditFlag==false) {
#if($context.action=="inline")
      var surl = "$doc.getExternalURL("lock")?action=inline&ajax=1&${docvariant.replaceAll("&amp;", "&")}";
#else
      var surl = "$doc.getExternalURL("lock")?ajax=1&${docvariant.replaceAll("&amp;", "&")}";
#end
      var myAjax = new Ajax.Request(
                surl,
                {
                    method: 'get',
                    parameters: "",
                    asynchronous: true
                });
       lockEditFlag = false;
    }
 }

 function prepareCancelEdit() {
    lockEdit();
 }
 function cancelCancelEdit() {
     cancelCancelEditFlag = false;
 }
    Event.observe(window, "unload", cancelEdit);
    Event.observe(window, "pagehide", cancelEdit);
// ]]>
</script>
#end
## Hook for inserting JavaScript skin extensions
<!-- com.xpn.xwiki.plugin.skinx.JsSkinExtensionPlugin -->
<!-- com.xpn.xwiki.plugin.skinx.JsSkinFileExtensionPlugin -->
$xwiki.jsx.use("XWiki.WebDAV")
