#set($formname = "update")
#set($saveaction = "save")
#set($interface = $request.get("interface"))
#if(!$interface)
  #set($interface = $xwiki.rightsmanager.defaultUi)
#end
<div id="xwikieditcontent">
#set($url = "?xpage=getgroups")
## switch between the new and the old interface
<select name="switchInterface" onchange="if(this.options[this.selectedIndex].value=='new') { location='?editor=groups&amp;space=XWiki&amp;interface=new';  } else if(this.options[this.selectedIndex].value=='stable') { location='?editor=groups&amp;space=XWiki&amp;interface=stable';  } ">
<option value="choose" #if($interface == "") selected="selected" #end>Switch interface</option>
<option value="new" #if($interface == "new") selected="selected" #end>New Interface</option>
<option value="stable" #if($interface == "stable") selected="selected" #end>Stable Interface</option>
</select>
#if($interface == "new")
<div id="wrapper" style="display: none;">
<div id="ajax-loader">Loading...<br />
  <img src="$xwiki.getSkinFile('icons/ajax-loader.gif')" alt="Loading..." title="Loading..." />
</div>
<table cellpadding="0" cellspacing="5" id="groupstable">
<tr><td colspan="2" id="showLimits"></td></tr>
<tr><td valign="top" style="width:800px">
      <table border="0" cellpadding="2" cellspacing="0" width="100%" class="display">
      <thead class="theader">
          <tr>
                  <td class="hgroupname">Groupname</td>
              <td class="groupmembers">Members</td>
              <td class="hgroupmanage" id="hgroupmanage">Filter<img src="$xwiki.getSkinFile('icons/rights-manager/filter.png')" alt="Filters" title="Filters" /></td>
          </tr>
          <tr id="table-filters">
              <td class="fgroupname" colspan="2"><input name="name" type="text" /></td>
              <td class="gmanage">
                #if($context.database != "xwiki") #set($mainwk = false) #else #set($mainwk = true) #end
                #if(!$mainwk)
                <select name="wiki">
                  <option value="local" selected="selected">Local</option>
                  <option value="global">Global</option>
                  <option value="both">Both</option>
                </select>
                #else <input type="hidden" value="local" name="wiki" /> #end
              </td>
          </tr>
      </thead>
      <tbody id="display1"><tr><td>&nbsp;</td></tr></tbody>
      </table></td>
    <td valign="top">
      <div id="scrollbar1" class="scrollbar"><div class="inscrollbar">&nbsp;</div></div>
    </td>
    <td id="buff"></td>
</tr>
<tr><td colspan="2"><div id="add-new-user" class="btn"><span class="btnTxt">Add New Group</span></div></td></tr>
</table>
<script type="text/javascript">
        $('wrapper').style.display = "block";
        var ta = new ASSTable("$url", 15, "display1", "scrollbar1", "groupstable", displayGroups, true); 
        Event.observe($('hgroupmanage'), 'click', showHideFilters(ta));
        ##//Event.observe( $('add-new-user'), 'click', ta.createAddHandler(ta));
        #set($url = $xwiki.getURL("XWiki.XWikiGroups", "view", "xpage=addnewgroup"))
        #set($saveurl = $xwiki.getURL("XWiki.XWikiGroups", "view"))
        #set($redirecturl = $doc.getURL())
        Event.observe($('add-new-user'), "click", makeAddHandler("$url", "$saveurl", "$redirecturl"));
</script>
</div>
#else
<div class="layoutsubsection">
<div style="overflow:auto">
$xwiki.parseMessage("editgroupsredirect")
</div>
</div>
#end
</div>
