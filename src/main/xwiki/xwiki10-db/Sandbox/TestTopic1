<?xml version="1.0" encoding="UTF-8"?>

<xwikidoc>
<web>Sandbox</web>
<name>TestTopic1</name>
<language></language>
<defaultLanguage>en</defaultLanguage>
<translation>0</translation>
<parent></parent>
<creator>XWiki.Admin</creator>
<author>XWiki.Admin</author>
<contentAuthor>XWiki.Admin</contentAuthor>
<creationDate>1154175385000</creationDate>
<date>1155306086000</date>
<contentUpdateDate>1155306086000</contentUpdateDate>
<version>1.23</version>
<title></title>
<template></template>
<attachment>
<filename>with spaces .jpg</filename>
<filesize>8742</filesize>
<author>XWiki.Admin</author>
<date>1155305950000</date>
<version>1.1</version>
<comment></comment>
<content>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</content>
</attachment>
<attachment>
<filename>with spaces.zip</filename>
<filesize>58275</filesize>
<author>XWiki.Admin</author>
<date>1155306086000</date>
<version>1.1</version>
<comment></comment>
<content>ZGlmZiAtdSAtciAtLWV4Y2x1ZGU9LnN2biAtLW5ldy1maWxlIC0taWdub3JlLW1hdGNoaW5nLWxpbmVzPSdeaW1wb3J0JyAtLWlnbm9yZS1ibGFuay1saW5lcyAtLWlnbm9yZS1hbGwtc3BhY2Ugc3JjL21haW4vamF2YS9jb20veHBuL3h3aWtpL1hXaWtpLmphdmEgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS9YV2lraS5qYXZhCi0tLSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvWFdpa2kuamF2YQkyMDA2LTA4LTA5IDIwOjA4OjM3LjAwMDAwMDAwMCArMDMwMAorKysgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS9YV2lraS5qYXZhCTIwMDYtMDgtMDkgMjE6MTk6NDguMDAwMDAwMDAwICswMzAwCkBAIC0xMjk3LDYgKzEzMzksOCBAQAogICAgIH0KIAogICAgIHB1YmxpYyBTdHJpbmcgZ2V0TGFuZ3VhZ2VQcmVmZXJlbmNlKFhXaWtpQ29udGV4dCBjb250ZXh0KSB7CisgICAgCXJldHVybiBnZXREb2NMYW5ndWFnZVByZWZlcmVuY2UoY29udGV4dCk7CisgICAgICAgIC8qCiAgICAgICAgIC8vIEZpcnN0IHdlIGdldCB0aGUgbGFuZ3VhZ2UgZnJvbSB0aGUgcmVxdWVzdAogICAgICAgICBTdHJpbmcgbGFuZ3VhZ2U7CiAKQEAgLTEzNzgsNiArMTQyMiwxODYgQEAKIAogICAgICAgICBjb250ZXh0LnNldExhbmd1YWdlKCIiKTsKICAgICAgICAgcmV0dXJuICIiOworICAgICAgICAqLworICAgIH0KKworICAgIHB1YmxpYyBTdHJpbmcgZ2V0RG9jTGFuZ3VhZ2VQcmVmZXJlbmNlKFhXaWtpQ29udGV4dCBjb250ZXh0KSB7CisgICAgICAgIFN0cmluZyBsYW5ndWFnZSA9ICIiLCByZXF1ZXN0TGFuZ3VhZ2UgPSAiIiwgdXNlclByZWZlcmVuY2VMYW5ndWFnZSA9ICIiLCBuYXZpZ2F0b3JMYW5ndWFnZSA9ICIiLCBjb29raWVMYW5ndWFnZSA9ICIiLCBjb250ZXh0TGFuZ3VhZ2UgPSAiIjsKKyAgICAgICAgYm9vbGVhbiBzZXRDb29raWUgPSBmYWxzZTsKKworICAgICAgICBpZiAoIWNvbnRleHQuZ2V0V2lraSgpLmlzTXVsdGlMaW5ndWFsKGNvbnRleHQpKSB7CisgICAgICAgICAgICBsYW5ndWFnZSA9IGNvbnRleHQuZ2V0V2lraSgpLmdldFhXaWtpUHJlZmVyZW5jZSgibGFuZ3VhZ2UiLCAiIiwgY29udGV4dCk7CisgICAgICAgICAgICBjb250ZXh0LnNldExhbmd1YWdlKGxhbmd1YWdlKTsKKyAgICAgICAgICAgIHJldHVybiBsYW5ndWFnZTsKKyAgICAgICAgfQorCisgICAgICAgIC8vIEdldCByZXF1ZXN0IGxhbmd1YWdlCisgICAgICAgIHRyeXsKKyAgICAgICAgCXJlcXVlc3RMYW5ndWFnZSA9IGNvbnRleHQuZ2V0UmVxdWVzdCgpLmdldFBhcmFtZXRlcigibGFuZ3VhZ2UiKTsKKyAgICAgICAgfQorICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KXsKKyAgICAgICAgfQorCisgICAgICAgIC8vIEdldCBjb250ZXh0IGxhbmd1YWdlCisgICAgICAgCWNvbnRleHRMYW5ndWFnZSA9IGNvbnRleHQuZ2V0TGFuZ3VhZ2UoKTsKKworICAgICAgICAvLyBHZXQgdXNlciBwcmVmZXJlbmNlCisgICAgICAgIHRyeSB7CisgICAgICAgICAgICBTdHJpbmcgdXNlciA9IGNvbnRleHQuZ2V0VXNlcigpOworICAgICAgICAgICAgWFdpa2lEb2N1bWVudCB1c2VyZG9jID0gZ2V0RG9jdW1lbnQodXNlciwgY29udGV4dCk7CisgICAgICAgICAgICBpZiAodXNlcmRvYyAhPSBudWxsKSB7CisgICAgICAgICAgICAgICAgdXNlclByZWZlcmVuY2VMYW5ndWFnZSA9IHVzZXJkb2MuZ2V0U3RyaW5nVmFsdWUoIlhXaWtpLlhXaWtpVXNlcnMiLCAiZGVmYXVsdF9sYW5ndWFnZSIpOworICAgICAgICAgICAgfQorICAgICAgICB9IGNhdGNoIChYV2lraUV4Y2VwdGlvbiBlKSB7CisgICAgICAgIH0KKworICAgICAgICAvLyBHZXQgbmF2aWdhdG9yIGxhbmd1YWdlIHNldHRpbmcKKyAgICAgICAgaWYgKGNvbnRleHQuZ2V0UmVxdWVzdCgpICE9IG51bGwpIHsKKyAgICAgICAgICAgIFN0cmluZyBhY2NlcHQgPSBjb250ZXh0LmdldFJlcXVlc3QoKS5nZXRIZWFkZXIoIkFjY2VwdC1MYW5ndWFnZSIpOworICAgICAgICAgICAgaWYgKChhY2NlcHQgIT0gbnVsbCkgJiYgKCFhY2NlcHQuZXF1YWxzKCIiKSkpIHsKKwkgICAgICAgICAgICBTdHJpbmdbXSBhbGlzdCA9IFN0cmluZ1V0aWxzLnNwbGl0KGFjY2VwdCwgIiw7LSIpOworCSAgICAgICAgICAgIGlmICgoYWxpc3QgIT0gbnVsbCkgJiYgIShhbGlzdC5sZW5ndGggPT0gMCkpIHsKKwkgICAgICAgICAgICAgICAgY29udGV4dC5zZXRMYW5ndWFnZShhbGlzdFswXSk7CisJICAgICAgICAgICAgICAgIG5hdmlnYXRvckxhbmd1YWdlID0gYWxpc3RbMF07CisJICAgICAgICAgICAgfQorICAgICAgICAgICAgfQorICAgICAgICB9CisKKyAgICAgICAgLy8gR2V0IGxhbmd1YWdlIGZyb20gY29va2llCisgICAgICAgIHRyeSB7CisgICAgICAgICAgICBjb29raWVMYW5ndWFnZSA9IGdldFVzZXJQcmVmZXJlbmNlRnJvbUNvb2tpZSgibGFuZ3VhZ2UiLCBjb250ZXh0KTsKKyAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKKyAgICAgICAgfQorCisgICAgICAgIC8vIERldGVybWluZSB3aGljaCBsYW5ndWFnZSB0byB1c2UKKyAgICAgICAgLy8gRmlyc3Qgd2UgZ2V0IHRoZSBsYW5ndWFnZSBmcm9tIHRoZSByZXF1ZXN0CisgICAgICAgIGlmICgocmVxdWVzdExhbmd1YWdlICE9IG51bGwpICYmICghcmVxdWVzdExhbmd1YWdlLmVxdWFscygiIikpKSB7CisgICAgICAgICAgICBpZiAocmVxdWVzdExhbmd1YWdlLmVxdWFscygiZGVmYXVsdCIpKSB7CisgICAgICAgICAgICAgICAgc2V0Q29va2llID0gdHJ1ZTsKKyAgICAgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICAgICAgbGFuZ3VhZ2UgPSByZXF1ZXN0TGFuZ3VhZ2U7CisgICAgICAgICAgICAgICAgY29udGV4dC5zZXRMYW5ndWFnZShsYW5ndWFnZSk7CisgICAgICAgICAgICAJQ29va2llIGNvb2tpZSA9IG5ldyBDb29raWUoImxhbmd1YWdlIiwgbGFuZ3VhZ2UpOworICAgICAgICAgICAgICAgIGNvb2tpZS5zZXRNYXhBZ2UoNjAgKiA2MCAqIDI0ICogMzY1ICogMTApOworICAgICAgICAgICAgICAgIGNvb2tpZS5zZXRQYXRoKCIvIik7CisgICAgICAgICAgICAgICAgY29udGV4dC5nZXRSZXNwb25zZSgpLmFkZENvb2tpZShjb29raWUpOworICAgICAgICAgICAgICAgIHJldHVybiBsYW5ndWFnZTsKKyAgICAgICAgICAgIH0KKyAgICAgICAgfQorICAgICAgICAvLyBOZXh0IHdlIGdldCB0aGUgbGFuZ3VhZ2UgZnJvbSB0aGUgY29udGV4dAorICAgICAgICBpZihjb250ZXh0TGFuZ3VhZ2UgIT0gbnVsbCAmJiBjb250ZXh0TGFuZ3VhZ2UgIT0gIiIpeworICAgICAgICAJbGFuZ3VhZ2UgPSBjb250ZXh0TGFuZ3VhZ2U7CisgICAgICAgIH0KKyAgICAgICAgLy8gTmV4dCB3ZSBnZXQgdGhlIGxhbmd1YWdlIGZyb20gdGhlIGNvb2tpZQorICAgICAgICBlbHNlIGlmKGNvb2tpZUxhbmd1YWdlICE9IG51bGwgJiYgY29va2llTGFuZ3VhZ2UgIT0gIiIpeworICAgICAgICAJbGFuZ3VhZ2UgPSBjb29raWVMYW5ndWFnZTsKKyAgICAgICAgfQorICAgICAgICAvLyBOZXh0IGZyb20gdGhlIGRlZmF1bHQgdXNlciBwcmVmZXJlbmNlCisgICAgICAgIGVsc2UgaWYodXNlclByZWZlcmVuY2VMYW5ndWFnZSAhPSBudWxsICYmIHVzZXJQcmVmZXJlbmNlTGFuZ3VhZ2UgIT0gIiIpeworICAgICAgICAJbGFuZ3VhZ2UgPSB1c2VyUHJlZmVyZW5jZUxhbmd1YWdlOworICAgICAgICB9CisgICAgICAgIC8vIFRoZW4gZnJvbSB0aGUgbmF2aWdhdG9yIGxhbmd1YWdlIHNldHRpbmcKKyAgICAgICAgZWxzZSBpZihuYXZpZ2F0b3JMYW5ndWFnZSAhPSBudWxsICYmIG5hdmlnYXRvckxhbmd1YWdlICE9ICIiKXsKKyAgICAgICAgCWxhbmd1YWdlID0gbmF2aWdhdG9yTGFuZ3VhZ2U7CisgICAgICAgIH0KKyAgICAgICAgY29udGV4dC5zZXRMYW5ndWFnZShsYW5ndWFnZSk7CisgICAgICAgIGlmKHNldENvb2tpZSl7CisgICAgICAgIAlDb29raWUgY29va2llID0gbmV3IENvb2tpZSgibGFuZ3VhZ2UiLCBsYW5ndWFnZSk7CisgICAgICAgICAgICBjb29raWUuc2V0TWF4QWdlKDYwICogNjAgKiAyNCAqIDM2NSAqIDEwKTsKKyAgICAgICAgICAgIGNvb2tpZS5zZXRQYXRoKCIvIik7CisgICAgICAgICAgICBjb250ZXh0LmdldFJlc3BvbnNlKCkuYWRkQ29va2llKGNvb2tpZSk7CisgICAgICAgIH0KKyAgICAgICAgcmV0dXJuIGxhbmd1YWdlOworICAgIH0KKworICAgIHB1YmxpYyBTdHJpbmcgZ2V0SW50ZXJmYWNlTGFuZ3VhZ2VQcmVmZXJlbmNlKFhXaWtpQ29udGV4dCBjb250ZXh0KSB7CisgICAgICAgIFN0cmluZyBsYW5ndWFnZSA9ICIiLCByZXF1ZXN0TGFuZ3VhZ2UgPSAiIiwgdXNlclByZWZlcmVuY2VMYW5ndWFnZSA9ICIiLCBuYXZpZ2F0b3JMYW5ndWFnZSA9ICIiLCBjb29raWVMYW5ndWFnZSA9ICIiLCBjb250ZXh0TGFuZ3VhZ2UgPSAiIjsKKyAgICAgICAgYm9vbGVhbiBzZXRDb29raWUgPSBmYWxzZTsKKworICAgICAgICBpZiAoIWNvbnRleHQuZ2V0V2lraSgpLmlzTXVsdGlMaW5ndWFsKGNvbnRleHQpKSB7CisgICAgICAgICAgICBsYW5ndWFnZSA9IGNvbnRleHQuZ2V0V2lraSgpLmdldFhXaWtpUHJlZmVyZW5jZSgibGFuZ3VhZ2UiLCAiIiwgY29udGV4dCk7CisgICAgICAgICAgICBjb250ZXh0LnNldEludGVyZmFjZUxhbmd1YWdlKGxhbmd1YWdlKTsKKyAgICAgICAgICAgIHJldHVybiBsYW5ndWFnZTsKKyAgICAgICAgfQorCisgICAgICAgIC8vIEdldCByZXF1ZXN0IGxhbmd1YWdlCisgICAgICAgIHRyeXsKKyAgICAgICAgCXJlcXVlc3RMYW5ndWFnZSA9IGNvbnRleHQuZ2V0UmVxdWVzdCgpLmdldFBhcmFtZXRlcigiaW50ZXJmYWNlbGFuZ3VhZ2UiKTsKKyAgICAgICAgfQorICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KXsKKyAgICAgICAgfQorCisgICAgICAgIC8vIEdldCBjb250ZXh0IGxhbmd1YWdlCisgICAgICAgCWNvbnRleHRMYW5ndWFnZSA9IGNvbnRleHQuZ2V0SW50ZXJmYWNlTGFuZ3VhZ2UoKTsKKworICAgICAgICAvLyBHZXQgdXNlciBwcmVmZXJlbmNlCisgICAgICAgIHRyeSB7CisgICAgICAgICAgICBTdHJpbmcgdXNlciA9IGNvbnRleHQuZ2V0VXNlcigpOworICAgICAgICAgICAgWFdpa2lEb2N1bWVudCB1c2VyZG9jID0gbnVsbDsKKyAgICAgICAgICAgIHVzZXJkb2MgPSBnZXREb2N1bWVudCh1c2VyLCBjb250ZXh0KTsKKyAgICAgICAgICAgIGlmICh1c2VyZG9jICE9IG51bGwpIHsKKyAgICAgICAgICAgICAgICB1c2VyUHJlZmVyZW5jZUxhbmd1YWdlID0gdXNlcmRvYy5nZXRTdHJpbmdWYWx1ZSgiWFdpa2kuWFdpa2lVc2VycyIsICJkZWZhdWx0X2ludGVyZmFjZV9sYW5ndWFnZSIpOworICAgICAgICAgICAgfQorICAgICAgICB9IGNhdGNoIChYV2lraUV4Y2VwdGlvbiBlKSB7CisgICAgICAgIH0KKworICAgICAgICAvLyBHZXQgbmF2aWdhdG9yIGxhbmd1YWdlIHNldHRpbmcKKyAgICAgICAgaWYgKGNvbnRleHQuZ2V0UmVxdWVzdCgpICE9IG51bGwpIHsKKyAgICAgICAgICAgIFN0cmluZyBhY2NlcHQgPSBjb250ZXh0LmdldFJlcXVlc3QoKS5nZXRIZWFkZXIoIkFjY2VwdC1MYW5ndWFnZSIpOworICAgICAgICAgICAgaWYgKChhY2NlcHQgIT0gbnVsbCkgJiYgKCFhY2NlcHQuZXF1YWxzKCIiKSkpIHsKKwkgICAgICAgICAgICBTdHJpbmdbXSBhbGlzdCA9IFN0cmluZ1V0aWxzLnNwbGl0KGFjY2VwdCwgIiw7LSIpOworCSAgICAgICAgICAgIGlmICgoYWxpc3QgIT0gbnVsbCkgJiYgIShhbGlzdC5sZW5ndGggPT0gMCkpIHsKKwkgICAgICAgICAgICAgICAgY29udGV4dC5zZXRMYW5ndWFnZShhbGlzdFswXSk7CisJICAgICAgICAgICAgICAgIG5hdmlnYXRvckxhbmd1YWdlID0gYWxpc3RbMF07CisJICAgICAgICAgICAgfQorICAgICAgICAgICAgfQorICAgICAgICB9CisKKyAgICAgICAgLy8gR2V0IGxhbmd1YWdlIGZyb20gY29va2llCisgICAgICAgIHRyeSB7CisgICAgICAgICAgICBjb29raWVMYW5ndWFnZSA9IGdldFVzZXJQcmVmZXJlbmNlRnJvbUNvb2tpZSgiaW50ZXJmYWNlbGFuZ3VhZ2UiLCBjb250ZXh0KTsKKyAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKKyAgICAgICAgfQorCisgICAgICAgIC8vIERldGVybWluZSB3aGljaCBsYW5ndWFnZSB0byB1c2UKKyAgICAgICAgLy8gRmlyc3Qgd2UgZ2V0IHRoZSBsYW5ndWFnZSBmcm9tIHRoZSByZXF1ZXN0CisgICAgICAgIGlmICgocmVxdWVzdExhbmd1YWdlICE9IG51bGwpICYmICghcmVxdWVzdExhbmd1YWdlLmVxdWFscygiIikpKSB7CisgICAgICAgICAgICBpZiAocmVxdWVzdExhbmd1YWdlLmVxdWFscygiZGVmYXVsdCIpKSB7CisgICAgICAgICAgICAgICAgc2V0Q29va2llID0gdHJ1ZTsKKyAgICAgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICAgICAgbGFuZ3VhZ2UgPSByZXF1ZXN0TGFuZ3VhZ2U7CisgICAgICAgICAgICAgICAgY29udGV4dC5zZXRMYW5ndWFnZShsYW5ndWFnZSk7CisgICAgICAgICAgICAJQ29va2llIGNvb2tpZSA9IG5ldyBDb29raWUoImludGVyZmFjZWxhbmd1YWdlIiwgbGFuZ3VhZ2UpOworICAgICAgICAgICAgICAgIGNvb2tpZS5zZXRNYXhBZ2UoNjAgKiA2MCAqIDI0ICogMzY1ICogMTApOworICAgICAgICAgICAgICAgIGNvb2tpZS5zZXRQYXRoKCIvIik7CisgICAgICAgICAgICAgICAgY29udGV4dC5nZXRSZXNwb25zZSgpLmFkZENvb2tpZShjb29raWUpOworICAgICAgICAgICAgICAgIHJldHVybiBsYW5ndWFnZTsKKyAgICAgICAgICAgIH0KKyAgICAgICAgfQorICAgICAgICAvLyBOZXh0IHdlIGdldCB0aGUgbGFuZ3VhZ2UgZnJvbSB0aGUgY29udGV4dAorICAgICAgICBpZihjb250ZXh0TGFuZ3VhZ2UgIT0gbnVsbCAmJiBjb250ZXh0TGFuZ3VhZ2UgIT0gIiIpeworICAgICAgICAJbGFuZ3VhZ2UgPSBjb250ZXh0TGFuZ3VhZ2U7CisgICAgICAgIH0KKyAgICAgICAgLy8gTmV4dCB3ZSBnZXQgdGhlIGxhbmd1YWdlIGZyb20gdGhlIGNvb2tpZQorICAgICAgICBlbHNlIGlmKGNvb2tpZUxhbmd1YWdlICE9IG51bGwgJiYgY29va2llTGFuZ3VhZ2UgIT0gIiIpeworICAgICAgICAJbGFuZ3VhZ2UgPSBjb29raWVMYW5ndWFnZTsKKyAgICAgICAgfQorICAgICAgICAvLyBOZXh0IGZyb20gdGhlIGRlZmF1bHQgdXNlciBwcmVmZXJlbmNlCisgICAgICAgZWxzZSBpZih1c2VyUHJlZmVyZW5jZUxhbmd1YWdlICE9IG51bGwgJiYgdXNlclByZWZlcmVuY2VMYW5ndWFnZSAhPSAiIil7CisgICAgICAgIAlsYW5ndWFnZSA9IHVzZXJQcmVmZXJlbmNlTGFuZ3VhZ2U7CisgICAgICAgfQorICAgICAgICAvLyBUaGVuIGZyb20gdGhlIG5hdmlnYXRvciBsYW5ndWFnZSBzZXR0aW5nCisgICAgICAgIGVsc2UgaWYobmF2aWdhdG9yTGFuZ3VhZ2UgIT0gbnVsbCAmJiBuYXZpZ2F0b3JMYW5ndWFnZSAhPSAiIil7CisgICAgICAgIAlsYW5ndWFnZSA9IG5hdmlnYXRvckxhbmd1YWdlOworICAgICAgICB9CisgICAgICAgIGNvbnRleHQuc2V0TGFuZ3VhZ2UobGFuZ3VhZ2UpOworICAgICAgICBpZihzZXRDb29raWUpeworICAgICAgICAJQ29va2llIGNvb2tpZSA9IG5ldyBDb29raWUoImludGVyZmFjZWxhbmd1YWdlIiwgbGFuZ3VhZ2UpOworICAgICAgICAgICAgY29va2llLnNldE1heEFnZSg2MCAqIDYwICogMjQgKiAzNjUgKiAxMCk7CisgICAgICAgICAgICBjb29raWUuc2V0UGF0aCgiLyIpOworICAgICAgICAgICAgY29udGV4dC5nZXRSZXNwb25zZSgpLmFkZENvb2tpZShjb29raWUpOworICAgICAgICB9CisgICAgICAgIHJldHVybiBsYW5ndWFnZTsKICAgICB9CiAKICAgICBwdWJsaWMgbG9uZyBnZXRYV2lraVByZWZlcmVuY2VBc0xvbmcoU3RyaW5nIHByZWZuYW1lLCBYV2lraUNvbnRleHQgY29udGV4dCkgewpAQCAtMjA4OSw3ICsyMzEzLDcgQEAKIAogICAgIHB1YmxpYyB2b2lkIHByZXBhcmVSZXNvdXJjZXMoWFdpa2lDb250ZXh0IGNvbnRleHQpIHsKICAgICAgICAgaWYgKGNvbnRleHQuZ2V0KCJtc2ciKSA9PSBudWxsKSB7Ci0gICAgICAgICAgICBTdHJpbmcgbGFuZ3VhZ2UgPSBnZXRMYW5ndWFnZVByZWZlcmVuY2UoY29udGV4dCk7CisgICAgICAgICAgICBTdHJpbmcgbGFuZ3VhZ2UgPSBnZXRJbnRlcmZhY2VMYW5ndWFnZVByZWZlcmVuY2UoY29udGV4dCk7CiAgICAgICAgICAgICBpZiAoY29udGV4dC5nZXRSZXNwb25zZSgpICE9IG51bGwpCiAgICAgICAgICAgICAgICAgY29udGV4dC5nZXRSZXNwb25zZSgpLnNldExvY2FsZShuZXcgTG9jYWxlKGxhbmd1YWdlKSk7CiAgICAgICAgICAgICBSZXNvdXJjZUJ1bmRsZSBidW5kbGUgPSBSZXNvdXJjZUJ1bmRsZS5nZXRCdW5kbGUoIkFwcGxpY2F0aW9uUmVzb3VyY2VzIiwgbmV3IExvY2FsZShsYW5ndWFnZSkpOwpAQCAtMjYyNyw3ICsyODUxLDcgQEAKICAgICB9CiAKICAgICBwdWJsaWMgU3RyaW5nIGdldEVuY29kaW5nKCkgewotICAgICAgICByZXR1cm4gUGFyYW0oInh3aWtpLmVuY29kaW5nIiwgIklTTy04ODU5LTEiKTsKKyAgICAgICAgcmV0dXJuIFBhcmFtKCJ4d2lraS5lbmNvZGluZyIsICJVVEYtOCIpOwogICAgIH0KIAogCkBAIC0zNTg1LDYgKzM4MDksOSBAQAogCiAgICAgcHVibGljIFN0cmluZyBnZXRFZGl0b3JQcmVmZXJlbmNlKFhXaWtpQ29udGV4dCBjb250ZXh0KSB7CiAgICAgICAgIFN0cmluZyBwcmVmID0gZ2V0VXNlclByZWZlcmVuY2UoImVkaXRvciIsIGNvbnRleHQpOworICAgICAgICBpZiAocHJlZi5lcXVhbHMoIi0tLSIpKXsKKyAgICAgICAgCXByZWYgPSBnZXRXZWJQcmVmZXJlbmNlKCJlZGl0b3IiLCBjb250ZXh0KTsKKyAgICAgICAgfQogICAgICAgICBpZiAocHJlZi5lcXVhbHMoIiIpKQogICAgICAgICAgICAgcHJlZiA9IFBhcmFtKCJ4d2lraS5lZGl0b3IiLCAiIik7CiAgICAgICAgIHJldHVybiBwcmVmLnRvTG93ZXJDYXNlKCk7CmRpZmYgLXUgLXIgLS1leGNsdWRlPS5zdm4gLS1uZXctZmlsZSAtLWlnbm9yZS1tYXRjaGluZy1saW5lcz0nXmltcG9ydCcgLS1pZ25vcmUtYmxhbmstbGluZXMgLS1pZ25vcmUtYWxsLXNwYWNlIHNyYy9tYWluL2phdmEvY29tL3hwbi94d2lraS9YV2lraUNvbnRleHQuamF2YSBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL1hXaWtpQ29udGV4dC5qYXZhCi0tLSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvWFdpa2lDb250ZXh0LmphdmEJMjAwNi0wOC0wOSAyMDowODozNy4wMDAwMDAwMDAgKzAzMDAKKysrIHNyY19pbnRlcmZhY2UvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvWFdpa2lDb250ZXh0LmphdmEJMjAwNi0wOC0wOSAyMToyMDo1Ni4wMDAwMDAwMDAgKzAzMDAKQEAgLTYyLDYgKzYxLDcgQEAKICAgIHByaXZhdGUgYm9vbGVhbiB2aXJ0dWFsOw0KICAgIHByaXZhdGUgWFdpa2lVc2VyIHVzZXI7DQogICAgcHJpdmF0ZSBTdHJpbmcgbGFuZ3VhZ2U7DQorICAgcHJpdmF0ZSBTdHJpbmcgaW50ZXJmYWNlTGFuZ3VhZ2U7DQogICAgcHJpdmF0ZSBpbnQgbW9kZTsNCiAgICBwcml2YXRlIFVSTCB1cmw7DQogICAgcHJpdmF0ZSBYV2lraVVSTEZhY3RvcnkgVVJMRmFjdG9yeTsNCkBAIC0xOTMsNiArMTkzLDE0IEBACiAgICAgICAgIHRoaXMubGFuZ3VhZ2UgPSBsYW5ndWFnZTsNCiAgICAgfQ0KIA0KKyAgICBwdWJsaWMgU3RyaW5nIGdldEludGVyZmFjZUxhbmd1YWdlKCkgew0KKyAgICAgICAgcmV0dXJuIGludGVyZmFjZUxhbmd1YWdlOw0KKyAgICB9DQorDQorICAgIHB1YmxpYyB2b2lkIHNldEludGVyZmFjZUxhbmd1YWdlKFN0cmluZyBpbnRlcmZhY2VMYW5ndWFnZSkgew0KKyAgICAgICAgdGhpcy5pbnRlcmZhY2VMYW5ndWFnZSA9IGludGVyZmFjZUxhbmd1YWdlOw0KKyAgICB9DQorDQogICAgIHB1YmxpYyBpbnQgZ2V0TW9kZSgpIHsNCiAgICAgICAgIHJldHVybiBtb2RlOw0KICAgICB9DQpkaWZmIC11IC1yIC0tZXhjbHVkZT0uc3ZuIC0tbmV3LWZpbGUgLS1pZ25vcmUtbWF0Y2hpbmctbGluZXM9J15pbXBvcnQnIC0taWdub3JlLWJsYW5rLWxpbmVzIC0taWdub3JlLWFsbC1zcGFjZSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvWFdpa2lJbnRlcmZhY2UuamF2YSBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL1hXaWtpSW50ZXJmYWNlLmphdmEKLS0tIHNyYy9tYWluL2phdmEvY29tL3hwbi94d2lraS9YV2lraUludGVyZmFjZS5qYXZhCTIwMDYtMDgtMDkgMjA6MDg6MzcuMDAwMDAwMDAwICswMzAwCisrKyBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL1hXaWtpSW50ZXJmYWNlLmphdmEJMjAwNi0wOC0wOSAyMToyMTo1OC4wMDAwMDAwMDAgKzAzMDAKQEAgLTE0NCw2ICsxNDQsMTAgQEAKIA0KICAgICBTdHJpbmcgZ2V0TGFuZ3VhZ2VQcmVmZXJlbmNlKFhXaWtpQ29udGV4dCBjb250ZXh0KTsNCiANCisgICAgU3RyaW5nIGdldERvY0xhbmd1YWdlUHJlZmVyZW5jZShYV2lraUNvbnRleHQgY29udGV4dCk7DQorDQorICAgIFN0cmluZyBnZXRJbnRlcmZhY2VMYW5ndWFnZVByZWZlcmVuY2UoWFdpa2lDb250ZXh0IGNvbnRleHQpOw0KKw0KICAgICBsb25nIGdldFhXaWtpUHJlZmVyZW5jZUFzTG9uZyhTdHJpbmcgcHJlZm5hbWUsIFhXaWtpQ29udGV4dCBjb250ZXh0KTsNCiANCiAgICAgbG9uZyBnZXRXZWJQcmVmZXJlbmNlQXNMb25nKFN0cmluZyBwcmVmbmFtZSwgWFdpa2lDb250ZXh0IGNvbnRleHQpOw0KZGlmZiAtdSAtciAtLWV4Y2x1ZGU9LnN2biAtLW5ldy1maWxlIC0taWdub3JlLW1hdGNoaW5nLWxpbmVzPSdeaW1wb3J0JyAtLWlnbm9yZS1ibGFuay1saW5lcyAtLWlnbm9yZS1hbGwtc3BhY2Ugc3JjL21haW4vamF2YS9jb20veHBuL3h3aWtpL2FwaS9DbGFzcy5qYXZhIHNyY19pbnRlcmZhY2UvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvYXBpL0NsYXNzLmphdmEKLS0tIHNyYy9tYWluL2phdmEvY29tL3hwbi94d2lraS9hcGkvQ2xhc3MuamF2YQkyMDA2LTA3LTEyIDE0OjA5OjUwLjAwMDAwMDAwMCArMDMwMAorKysgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS9hcGkvQ2xhc3MuamF2YQkyMDA2LTA4LTA5IDIxOjIzOjEyLjAwMDAwMDAwMCArMDMwMApAQCAtNTUsNiArNTcsNyBAQAogICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ID0gY29sbC5pdGVyYXRvcigpOyBpdC5oYXNOZXh0KCk7aSsrKSB7DQogICAgICAgICAgICAgcHJvcGVydGllc1tpXSA9IG5ldyBQcm9wZXJ0eUNsYXNzKChjb20ueHBuLnh3aWtpLm9iamVjdHMuY2xhc3Nlcy5Qcm9wZXJ0eUNsYXNzKSBpdC5uZXh0KCksIGNvbnRleHQpOw0KICAgICAgICAgfQ0KKyAgICAgICAgQXJyYXlzLnNvcnQocHJvcGVydGllcywgbmV3IFByb3BlcnR5Q29tcGFyYXRvcigpKTsNCiAgICAgICAgIHJldHVybiBwcm9wZXJ0aWVzOw0KICAgICB9DQogDQpAQCAtODksNSArOTIsMTMgQEAKICAgICAgICAgQmFzZU9iamVjdCBvYmogPSAoQmFzZU9iamVjdClnZXRCYXNlQ2xhc3MoKS5uZXdPYmplY3QoY29udGV4dCk7DQogICAgICAgICByZXR1cm4gb2JqLm5ld09iamVjdEFwaShvYmosIGNvbnRleHQpOw0KICAgICB9DQotDQorfQ0KK2NsYXNzIFByb3BlcnR5Q29tcGFyYXRvciBpbXBsZW1lbnRzIENvbXBhcmF0b3J7DQorCXB1YmxpYyBpbnQgY29tcGFyZShqYXZhLmxhbmcuT2JqZWN0IG8xLCBqYXZhLmxhbmcuT2JqZWN0IG8yKSB7DQorCQlQcm9wZXJ0eUNsYXNzIHBvMSA9IChQcm9wZXJ0eUNsYXNzKW8xOw0KKwkJUHJvcGVydHlDbGFzcyBwbzIgPSAoUHJvcGVydHlDbGFzcylvMjsNCisJCWlmKHBvMS5nZXROdW1iZXIoKSA8IHBvMi5nZXROdW1iZXIoKSkgcmV0dXJuIC0xOw0KKwkJaWYocG8xLmdldE51bWJlcigpID4gcG8yLmdldE51bWJlcigpKSByZXR1cm4gMTsNCisJCXJldHVybiAwOw0KKwl9DQogfQpcIE5vIG5ld2xpbmUgYXQgZW5kIG9mIGZpbGUKZGlmZiAtdSAtciAtLWV4Y2x1ZGU9LnN2biAtLW5ldy1maWxlIC0taWdub3JlLW1hdGNoaW5nLWxpbmVzPSdeaW1wb3J0JyAtLWlnbm9yZS1ibGFuay1saW5lcyAtLWlnbm9yZS1hbGwtc3BhY2Ugc3JjL21haW4vamF2YS9jb20veHBuL3h3aWtpL2FwaS9Db250ZXh0LmphdmEgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS9hcGkvQ29udGV4dC5qYXZhCi0tLSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvYXBpL0NvbnRleHQuamF2YQkyMDA2LTA3LTEyIDE0OjA5OjUwLjAwMDAwMDAwMCArMDMwMAorKysgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS9hcGkvQ29udGV4dC5qYXZhCTIwMDYtMDgtMDkgMjE6MjQ6MzYuMDAwMDAwMDAwICswMzAwCkBAIC0xMTUsNiArMTE1LDE0IEBACiANCiAgICAgLyoqDQogICAgICAqDQorICAgICAqIEByZXR1cm4gdGhlIGludGVyZmFjZSBsYW5ndWFnZSBwcmVmZXJlbmNlIG9mIHRoZSBjdXJyZW50IHVzZXINCisgICAgICovDQorICAgIHB1YmxpYyBTdHJpbmcgZ2V0SW50ZXJmYWNlTGFuZ3VhZ2UoKSB7DQorICAgICAgICAgcmV0dXJuIGNvbnRleHQuZ2V0SW50ZXJmYWNlTGFuZ3VhZ2UoKTsNCisgICAgfQ0KKw0KKyAgICAvKioNCisgICAgICoNCiAgICAgICogQHJldHVybiB0aGUgWFdpa2kgb2JqZWN0IGlmIHlvdSBoYXZlIHRoZSBwcm9ncmFtbWluZyByaWdodA0KICAgICAgKi8NCiAgICAgcHVibGljIGNvbS54cG4ueHdpa2kuWFdpa2kgZ2V0WFdpa2koKSB7DQpkaWZmIC11IC1yIC0tZXhjbHVkZT0uc3ZuIC0tbmV3LWZpbGUgLS1pZ25vcmUtbWF0Y2hpbmctbGluZXM9J15pbXBvcnQnIC0taWdub3JlLWJsYW5rLWxpbmVzIC0taWdub3JlLWFsbC1zcGFjZSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvYXBpL1hXaWtpLmphdmEgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS9hcGkvWFdpa2kuamF2YQotLS0gc3JjL21haW4vamF2YS9jb20veHBuL3h3aWtpL2FwaS9YV2lraS5qYXZhCTIwMDYtMDgtMDkgMjA6MDg6MzQuMDAwMDAwMDAwICswMzAwCisrKyBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL2FwaS9YV2lraS5qYXZhCTIwMDYtMDgtMDkgMjE6MjU6MzkuMDAwMDAwMDAwICswMzAwCkBAIC0zOTQsNiArMzk2LDE0IEBACiAgICAgICAgIHJldHVybiB4d2lraS5nZXRMYW5ndWFnZVByZWZlcmVuY2UoY29udGV4dCk7CiAgICAgfQogCisgICAgcHVibGljIFN0cmluZyBnZXREb2NMYW5ndWFnZVByZWZlcmVuY2UoKSB7CisgICAgICAgIHJldHVybiB4d2lraS5nZXREb2NMYW5ndWFnZVByZWZlcmVuY2UoY29udGV4dCk7CisgICAgfQorCisgICAgcHVibGljIFN0cmluZyBnZXRJbnRlcmZhY2VMYW5ndWFnZVByZWZlcmVuY2UoKSB7CisgICAgICAgIHJldHVybiB4d2lraS5nZXRJbnRlcmZhY2VMYW5ndWFnZVByZWZlcmVuY2UoY29udGV4dCk7CisgICAgfQorCiAgICAgcHVibGljIGJvb2xlYW4gaXNWaXJ0dWFsKCkgewogICAgICAgICByZXR1cm4geHdpa2kuaXNWaXJ0dWFsKCk7CiAgICAgfQpAQCAtOTk4LDcgKzEwMDgsNyBAQAogCiAgICAgcHVibGljIE9iamVjdCBwYXJzZUdyb292eUZyb21TdHJpbmcoU3RyaW5nIHNjcmlwdCkgdGhyb3dzIFhXaWtpRXhjZXB0aW9uIHsKICAgICAgICAgaWYgKGNoZWNrUHJvZ3JhbW1pbmdSaWdodHMoKSkKLSAgICAgICAgICByZXR1cm4geHdpa2kucGFyc2VHcm9vdnlGcm9tU3RyaW5nKHNjcmlwdCwgY29udGV4dCk7CisgICAgICAgICAgcmV0dXJuIChPYmplY3QpeHdpa2kucGFyc2VHcm9vdnlGcm9tU3RyaW5nKHNjcmlwdCwgY29udGV4dCk7CiAgICAgICAgIGVsc2UKICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICB9CmRpZmYgLXUgLXIgLS1leGNsdWRlPS5zdm4gLS1uZXctZmlsZSAtLWlnbm9yZS1tYXRjaGluZy1saW5lcz0nXmltcG9ydCcgLS1pZ25vcmUtYmxhbmstbGluZXMgLS1pZ25vcmUtYWxsLXNwYWNlIHNyYy9tYWluL2phdmEvY29tL3hwbi94d2lraS9kb2MvWFdpa2lEb2N1bWVudC5qYXZhIHNyY19pbnRlcmZhY2UvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvZG9jL1hXaWtpRG9jdW1lbnQuamF2YQotLS0gc3JjL21haW4vamF2YS9jb20veHBuL3h3aWtpL2RvYy9YV2lraURvY3VtZW50LmphdmEJMjAwNi0wOC0wOSAyMDowODozMS4wMDAwMDAwMDAgKzAzMDAKKysrIHNyY19pbnRlcmZhY2UvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvZG9jL1hXaWtpRG9jdW1lbnQuamF2YQkyMDA2LTA4LTA5IDIxOjMwOjIwLjAwMDAwMDAwMCArMDMwMApAQCAtNTAxLDIyICs1MTEsMjIgQEAKIAogICAgIHB1YmxpYyBTdHJpbmcgZ2V0QXR0YWNobWVudFVSTChTdHJpbmcgZmlsZW5hbWUsIFN0cmluZyBhY3Rpb24sIFhXaWtpQ29udGV4dCBjb250ZXh0KSB7CiAgICAgICAgIFVSTCB1cmwgPSBjb250ZXh0LmdldFVSTEZhY3RvcnkoKS5jcmVhdGVBdHRhY2htZW50VVJMKGZpbGVuYW1lLCBnZXRXZWIoKSwgZ2V0TmFtZSgpLCBhY3Rpb24sIG51bGwsIGNvbnRleHQpOwotICAgICAgICByZXR1cm4gY29udGV4dC5nZXRVUkxGYWN0b3J5KCkuZ2V0VVJMKHVybCwgY29udGV4dCk7CisgICAgICAgIHJldHVybiBjb250ZXh0LmdldFVSTEZhY3RvcnkoKS5nZXRVUkwodXJsLCBjb250ZXh0KS50b1N0cmluZygpLnJlcGxhY2VBbGwoIiYiLCAiJmFtcDsiKS5yZXBsYWNlQWxsKCImYW1wO2FtcDsiLCAiJmFtcDsiKTsKICAgICB9CiAKICAgICBwdWJsaWMgU3RyaW5nIGdldEF0dGFjaG1lbnRVUkwoU3RyaW5nIGZpbGVuYW1lLCBTdHJpbmcgYWN0aW9uLCBTdHJpbmcgcXVlcnlzdHJpbmcsIFhXaWtpQ29udGV4dCBjb250ZXh0KSB7CiAgICAgICAgIFVSTCB1cmwgPSBjb250ZXh0LmdldFVSTEZhY3RvcnkoKS5jcmVhdGVBdHRhY2htZW50VVJMKGZpbGVuYW1lLCBnZXRXZWIoKSwgZ2V0TmFtZSgpLCBhY3Rpb24sIHF1ZXJ5c3RyaW5nLCBjb250ZXh0KTsKLSAgICAgICAgcmV0dXJuIGNvbnRleHQuZ2V0VVJMRmFjdG9yeSgpLmdldFVSTCh1cmwsIGNvbnRleHQpOworICAgICAgICByZXR1cm4gY29udGV4dC5nZXRVUkxGYWN0b3J5KCkuZ2V0VVJMKHVybCwgY29udGV4dCkudG9TdHJpbmcoKS5yZXBsYWNlQWxsKCImIiwgIiZhbXA7IikucmVwbGFjZUFsbCgiJmFtcDthbXA7IiwgIiZhbXA7Iik7CiAgICAgfQogCiAgICAgcHVibGljIFN0cmluZyBnZXRBdHRhY2htZW50UmV2aXNpb25VUkwoU3RyaW5nIGZpbGVuYW1lLCBTdHJpbmcgcmV2aXNpb24sIFhXaWtpQ29udGV4dCBjb250ZXh0KSB7CiAgICAgICAgIFVSTCB1cmwgPSBjb250ZXh0LmdldFVSTEZhY3RvcnkoKS5jcmVhdGVBdHRhY2htZW50UmV2aXNpb25VUkwoZmlsZW5hbWUsIGdldFdlYigpLCBnZXROYW1lKCksIHJldmlzaW9uLCBudWxsLCBjb250ZXh0KTsKLSAgICAgICAgcmV0dXJuIGNvbnRleHQuZ2V0VVJMRmFjdG9yeSgpLmdldFVSTCh1cmwsIGNvbnRleHQpOworICAgICAgICByZXR1cm4gY29udGV4dC5nZXRVUkxGYWN0b3J5KCkuZ2V0VVJMKHVybCwgY29udGV4dCkudG9TdHJpbmcoKS5yZXBsYWNlQWxsKCImIiwgIiZhbXA7IikucmVwbGFjZUFsbCgiJmFtcDthbXA7IiwgIiZhbXA7Iik7CiAgICAgfQogCiAgICAgcHVibGljIFN0cmluZyBnZXRBdHRhY2htZW50UmV2aXNpb25VUkwoU3RyaW5nIGZpbGVuYW1lLCBTdHJpbmcgcmV2aXNpb24sIFN0cmluZyBxdWVyeXN0cmluZywgWFdpa2lDb250ZXh0IGNvbnRleHQpIHsKICAgICAgICAgVVJMIHVybCA9IGNvbnRleHQuZ2V0VVJMRmFjdG9yeSgpLmNyZWF0ZUF0dGFjaG1lbnRSZXZpc2lvblVSTChmaWxlbmFtZSwgZ2V0V2ViKCksIGdldE5hbWUoKSwgcmV2aXNpb24sIHF1ZXJ5c3RyaW5nLCBjb250ZXh0KTsKLSAgICAgICAgcmV0dXJuIGNvbnRleHQuZ2V0VVJMRmFjdG9yeSgpLmdldFVSTCh1cmwsIGNvbnRleHQpOworICAgICAgICByZXR1cm4gY29udGV4dC5nZXRVUkxGYWN0b3J5KCkuZ2V0VVJMKHVybCwgY29udGV4dCkudG9TdHJpbmcoKS5yZXBsYWNlQWxsKCImIiwgIiZhbXA7IikucmVwbGFjZUFsbCgiJmFtcDthbXA7IiwgIiZhbXA7Iik7CiAgICAgfQogCiAgICAgcHVibGljIFN0cmluZyBnZXRVUkwoU3RyaW5nIGFjdGlvbiwgYm9vbGVhbiByZWRpcmVjdCwgWFdpa2lDb250ZXh0IGNvbnRleHQpIHsKQEAgLTUyNSw5ICs1MzUsOSBAQAogICAgICAgICAgICAgaWYgKHVybCA9PSBudWxsKQogICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICAgZWxzZQotICAgICAgICAgICAgICAgIHJldHVybiB1cmwudG9TdHJpbmcoKTsKKyAgICAgICAgICAgICAgICByZXR1cm4gdXJsLnRvU3RyaW5nKCkudG9TdHJpbmcoKS5yZXBsYWNlQWxsKCImIiwgIiZhbXA7IikucmVwbGFjZUFsbCgiJmFtcDthbXA7IiwgIiZhbXA7Iik7CiAgICAgICAgIH0gZWxzZQotICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuZ2V0VVJMRmFjdG9yeSgpLmdldFVSTCh1cmwsIGNvbnRleHQpOworICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQuZ2V0VVJMRmFjdG9yeSgpLmdldFVSTCh1cmwsIGNvbnRleHQpLnRvU3RyaW5nKCkucmVwbGFjZUFsbCgiJiIsICImYW1wOyIpLnJlcGxhY2VBbGwoIiZhbXA7YW1wOyIsICImYW1wOyIpOwogICAgIH0KIAogICAgIHB1YmxpYyBTdHJpbmcgZ2V0VVJMKFN0cmluZyBhY3Rpb24sIFhXaWtpQ29udGV4dCBjb250ZXh0KSB7CkBAIC01MzcsMTkgKzU0NywxOSBAQAogICAgIHB1YmxpYyBTdHJpbmcgZ2V0VVJMKFN0cmluZyBhY3Rpb24sIFN0cmluZyBxdWVyeXN0cmluZywgWFdpa2lDb250ZXh0IGNvbnRleHQpIHsKICAgICAgICAgVVJMIHVybCA9IGNvbnRleHQuZ2V0VVJMRmFjdG9yeSgpLmNyZWF0ZVVSTChnZXRXZWIoKSwgZ2V0TmFtZSgpLCBhY3Rpb24sCiAgICAgICAgICAgICAgICAgcXVlcnlzdHJpbmcsIG51bGwsIGNvbnRleHQpOwotICAgICAgICByZXR1cm4gY29udGV4dC5nZXRVUkxGYWN0b3J5KCkuZ2V0VVJMKHVybCwgY29udGV4dCk7CisgICAgICAgIHJldHVybiBjb250ZXh0LmdldFVSTEZhY3RvcnkoKS5nZXRVUkwodXJsLCBjb250ZXh0KS50b1N0cmluZygpLnJlcGxhY2VBbGwoIiYiLCAiJmFtcDsiKS5yZXBsYWNlQWxsKCImYW1wO2FtcDsiLCAiJmFtcDsiKTsKICAgICB9CiAKICAgICBwdWJsaWMgU3RyaW5nIGdldEV4dGVybmFsVVJMKFN0cmluZyBhY3Rpb24sIFhXaWtpQ29udGV4dCBjb250ZXh0KSB7CiAgICAgICAgIFVSTCB1cmwgPSBjb250ZXh0LmdldFVSTEZhY3RvcnkoKS5jcmVhdGVFeHRlcm5hbFVSTChnZXRXZWIoKSwgZ2V0TmFtZSgpLCBhY3Rpb24sCiAgICAgICAgICAgICAgICAgbnVsbCwgbnVsbCwgY29udGV4dCk7Ci0gICAgICAgIHJldHVybiB1cmwudG9TdHJpbmcoKTsKKyAgICAgICAgcmV0dXJuIHVybC50b1N0cmluZygpLnRvU3RyaW5nKCkucmVwbGFjZUFsbCgiJiIsICImYW1wOyIpLnJlcGxhY2VBbGwoIiZhbXA7YW1wOyIsICImYW1wOyIpOwogICAgIH0KIAogICAgIHB1YmxpYyBTdHJpbmcgZ2V0RXh0ZXJuYWxVUkwoU3RyaW5nIGFjdGlvbiwgU3RyaW5nIHF1ZXJ5c3RyaW5nLCBYV2lraUNvbnRleHQgY29udGV4dCkgewogICAgICAgICBVUkwgdXJsID0gY29udGV4dC5nZXRVUkxGYWN0b3J5KCkuY3JlYXRlRXh0ZXJuYWxVUkwoZ2V0V2ViKCksIGdldE5hbWUoKSwgYWN0aW9uLAogICAgICAgICAgICAgICAgIHF1ZXJ5c3RyaW5nLCBudWxsLCBjb250ZXh0KTsKLSAgICAgICAgcmV0dXJuIHVybC50b1N0cmluZygpOworICAgICAgICByZXR1cm4gdXJsLnRvU3RyaW5nKCkudG9TdHJpbmcoKS5yZXBsYWNlQWxsKCImIiwgIiZhbXA7IikucmVwbGFjZUFsbCgiJmFtcDthbXA7IiwgIiZhbXA7Iik7CiAgICAgfQogCiAKQEAgLTU1Nyw3ICs1NjcsNyBAQAogICAgICAgICBYV2lraURvY3VtZW50IGRvYyA9IG5ldyBYV2lraURvY3VtZW50KCk7CiAgICAgICAgIGRvYy5zZXRGdWxsTmFtZShnZXRQYXJlbnQoKSwgY29udGV4dCk7CiAgICAgICAgIFVSTCB1cmwgPSBjb250ZXh0LmdldFVSTEZhY3RvcnkoKS5jcmVhdGVVUkwoZG9jLmdldFdlYigpLCBkb2MuZ2V0TmFtZSgpLCBjb250ZXh0KTsKLSAgICAgICAgcmV0dXJuIGNvbnRleHQuZ2V0VVJMRmFjdG9yeSgpLmdldFVSTCh1cmwsIGNvbnRleHQpOworICAgICAgICByZXR1cm4gY29udGV4dC5nZXRVUkxGYWN0b3J5KCkuZ2V0VVJMKHVybCwgY29udGV4dCkudG9TdHJpbmcoKS5yZXBsYWNlQWxsKCImIiwgIiZhbXA7IikucmVwbGFjZUFsbCgiJmFtcDthbXA7IiwgIiZhbXA7Iik7CiAgICAgfQogCiAgICAgcHVibGljIFhXaWtpRG9jdW1lbnRBcmNoaXZlIGdldERvY3VtZW50QXJjaGl2ZShYV2lraUNvbnRleHQgY29udGV4dCkgdGhyb3dzIFhXaWtpRXhjZXB0aW9uIHsKQEAgLTI0NjIsNyArMjQ3Miw3IEBACiAgICAgICAgICAgICBlZGl0cGFyYW1zLmFwcGVuZCgibGFuZ3VhZ2U9Iik7CiAgICAgICAgICAgICBlZGl0cGFyYW1zLmFwcGVuZChsYW5ndWFnZSk7CiAgICAgICAgIH0KLSAgICAgICAgcmV0dXJuIGdldFVSTChhY3Rpb24sIGVkaXRwYXJhbXMudG9TdHJpbmcoKSwgY29udGV4dCk7CisgICAgICAgIHJldHVybiBnZXRVUkwoYWN0aW9uLCBlZGl0cGFyYW1zLnRvU3RyaW5nKCksIGNvbnRleHQpLnRvU3RyaW5nKCkucmVwbGFjZUFsbCgiJiIsICImYW1wOyIpLnJlcGxhY2VBbGwoIiZhbXA7YW1wOyIsICImYW1wOyIpOwogICAgIH0KIAogICAgIHB1YmxpYyBTdHJpbmcgZ2V0RGVmYXVsdFRlbXBsYXRlKCkgewpkaWZmIC11IC1yIC0tZXhjbHVkZT0uc3ZuIC0tbmV3LWZpbGUgLS1pZ25vcmUtbWF0Y2hpbmctbGluZXM9J15pbXBvcnQnIC0taWdub3JlLWJsYW5rLWxpbmVzIC0taWdub3JlLWFsbC1zcGFjZSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvb2JqZWN0cy9jbGFzc2VzL0Jvb2xlYW5DbGFzcy5qYXZhIHNyY19pbnRlcmZhY2UvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvb2JqZWN0cy9jbGFzc2VzL0Jvb2xlYW5DbGFzcy5qYXZhCi0tLSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvb2JqZWN0cy9jbGFzc2VzL0Jvb2xlYW5DbGFzcy5qYXZhCTIwMDYtMDctMTIgMTQ6MDk6NTEuMDAwMDAwMDAwICswMzAwCisrKyBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL29iamVjdHMvY2xhc3Nlcy9Cb29sZWFuQ2xhc3MuamF2YQkyMDA2LTA4LTA5IDIxOjM1OjUxLjAwMDAwMDAwMCArMDMwMApAQCAtOTMsNiArOTQsMTQgQEAKIA0KIA0KICAgICBwdWJsaWMgdm9pZCBkaXNwbGF5RWRpdChTdHJpbmdCdWZmZXIgYnVmZmVyLCBTdHJpbmcgbmFtZSwgU3RyaW5nIHByZWZpeCwgQmFzZUNvbGxlY3Rpb24gb2JqZWN0LCBYV2lraUNvbnRleHQgY29udGV4dCkgew0KKyAgICAJaWYoZ2V0RGlzcGxheVR5cGUoKS5lcXVhbHMoImNoZWNrYm94Iikpew0KKyAgICAJCWRpc3BsYXlDaGVja2JveEVkaXQoYnVmZmVyLCBuYW1lLCBwcmVmaXgsIG9iamVjdCwgY29udGV4dCk7DQorICAgIAl9DQorICAgIAllbHNlIHsNCisgICAgCQlkaXNwbGF5U2VsZWN0RWRpdChidWZmZXIsIG5hbWUsIHByZWZpeCwgb2JqZWN0LCBjb250ZXh0KTsNCisgICAgCX0NCisgICAgfQ0KKyAgICBwdWJsaWMgdm9pZCBkaXNwbGF5U2VsZWN0RWRpdChTdHJpbmdCdWZmZXIgYnVmZmVyLCBTdHJpbmcgbmFtZSwgU3RyaW5nIHByZWZpeCwgQmFzZUNvbGxlY3Rpb24gb2JqZWN0LCBYV2lraUNvbnRleHQgY29udGV4dCkgew0KICAgICAgICAgc2VsZWN0IHNlbGVjdCA9IG5ldyBzZWxlY3QocHJlZml4ICsgbmFtZSwgMSk7DQogICAgICAgICBTdHJpbmcgU3RyaW5nMCA9IGdldERpc3BsYXlWYWx1ZShjb250ZXh0LCAwKTsNCiAgICAgICAgIFN0cmluZyBTdHJpbmcxID0gZ2V0RGlzcGxheVZhbHVlKGNvbnRleHQsIDEpOw0KQEAgLTExOSw3ICsxMjgsOCBAQAogICAgICAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlPT0wKQ0KICAgICAgICAgICAgICAgICAgICAgb3B0aW9uc1syXS5zZXRTZWxlY3RlZCh0cnVlKTsNCiAgICAgICAgICAgICB9DQotICAgICAgICB9fSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsNCisJICAgICAgICB9DQorICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgew0KICAgICAgICAgICAgIC8vIFRoaXMgc2hvdWxkIG5vdCBoYXBwZW4NCiAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpOw0KICAgICAgICAgfQ0KQEAgLTEyNywxNiArMTM3LDQ4IEBACiAgICAgICAgIGJ1ZmZlci5hcHBlbmQoc2VsZWN0LnRvU3RyaW5nKCkpOw0KICAgICB9DQogDQorICAgIHB1YmxpYyB2b2lkIGRpc3BsYXlDaGVja2JveEVkaXQoU3RyaW5nQnVmZmVyIGJ1ZmZlciwgU3RyaW5nIG5hbWUsIFN0cmluZyBwcmVmaXgsIEJhc2VDb2xsZWN0aW9uIG9iamVjdCwgWFdpa2lDb250ZXh0IGNvbnRleHQpIHsNCisgICAgICAgIG9yZy5hcGFjaGUuZWNzLnhodG1sLmlucHV0IGNoZWNrID0gbmV3IGlucHV0KGlucHV0LmNoZWNrYm94LCBwcmVmaXggKyBuYW1lLCAxKTsNCisgICAgICAgIG9yZy5hcGFjaGUuZWNzLnhodG1sLmlucHV0IGNoZWNrTm8gPSBuZXcgaW5wdXQoaW5wdXQuaGlkZGVuLCBwcmVmaXggKyBuYW1lLCAwKTsNCisNCisgICAgICAgIHRyeSB7DQorICAgICAgICBJbnRlZ2VyUHJvcGVydHkgcHJvcCA9IChJbnRlZ2VyUHJvcGVydHkpIG9iamVjdC5zYWZlZ2V0KG5hbWUpOw0KKyAgICAgICAgaWYgKHByb3AhPW51bGwpIHsNCisgICAgICAgICAgICBJbnRlZ2VyIGl2YWx1ZSA9IChJbnRlZ2VyKXByb3AuZ2V0VmFsdWUoKTsNCisgICAgICAgICAgICBpZiAoaXZhbHVlIT1udWxsKSB7DQorICAgICAgICAgICAgICAgIGludCB2YWx1ZSA9IGl2YWx1ZS5pbnRWYWx1ZSgpOw0KKyAgICAgICAgICAgICAgICBpZiAodmFsdWU9PTEpDQorICAgICAgICAgICAgICAgICAgICBjaGVjay5zZXRDaGVja2VkKHRydWUpOw0KKyAgICAgICAgICAgICAgICBlbHNlIGlmICh2YWx1ZT09MCkNCisgICAgICAgICAgICAgICAgCWNoZWNrLnNldENoZWNrZWQoZmFsc2UpOw0KKyAgICAgICAgICAgIH0NCisgICAgICAgICAgICBlbHNlIHsNCisgICAgICAgICAgICAgICAgaW50IHZhbHVlID0gZ2V0RGVmYXVsdFZhbHVlKCk7DQorICAgICAgICAgICAgICAgIGlmICh2YWx1ZT09MSkNCisgICAgICAgICAgICAgICAgICAgIGNoZWNrLnNldENoZWNrZWQodHJ1ZSk7DQorICAgICAgICAgICAgICAgIGVsc2UNCisgICAgICAgICAgICAgICAgICAgIGNoZWNrLnNldENoZWNrZWQoZmFsc2UpOw0KKyAgICAgICAgICAgIH0NCisgICAgICAgIH19IGNhdGNoIChFeGNlcHRpb24gZSkgew0KKyAgICAgICAgICAgIC8vIFRoaXMgc2hvdWxkIG5vdCBoYXBwZW4NCisgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpOw0KKyAgICAgICAgfQ0KKyAgICAgICAgYnVmZmVyLmFwcGVuZChjaGVjay50b1N0cmluZygpKTsNCisgICAgICAgIGJ1ZmZlci5hcHBlbmQoY2hlY2tOby50b1N0cmluZygpKTsNCisgICAgfQ0KKw0KIA0KICAgICBwcml2YXRlIFN0cmluZyBnZXREaXNwbGF5VmFsdWUoWFdpa2lDb250ZXh0IGNvbnRleHQsIGludCB2YWx1ZSkgew0KICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICBYV2lraU1lc3NhZ2VUb29sIG1zZyA9IChYV2lraU1lc3NhZ2VUb29sKSBjb250ZXh0LmdldCgibXNnIik7DQogICAgICAgICAgICAgU3RyaW5nIHN0cm5hbWUgPSBnZXREaXNwbGF5VHlwZSgpICsgIl8iICsgdmFsdWU7DQogICAgICAgICAgICAgU3RyaW5nIHJlc3VsdCA9IG1zZy5nZXQoc3RybmFtZSk7DQotICAgICAgICAgICAgaWYgKHJlc3VsdC5lcXVhbHMoc3RybmFtZSkpDQorICAgICAgICAgICAgaWYgKHJlc3VsdC5lcXVhbHMoc3RybmFtZSkpew0KICAgICAgICAgICAgICByZXR1cm4gIiIgKyB2YWx1ZTsNCi0gICAgICAgICAgICBlbHNlDQorICAgICAgICAgICAgfQ0KKyAgICAgICAgICAgIGVsc2V7DQogICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7DQorICAgICAgICAgICAgfQ0KICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsNCiAgICAgICAgICAgICByZXR1cm4gIiIgKyB2YWx1ZTsNCiAgICAgICAgIH0NCmRpZmYgLXUgLXIgLS1leGNsdWRlPS5zdm4gLS1uZXctZmlsZSAtLWlnbm9yZS1tYXRjaGluZy1saW5lcz0nXmltcG9ydCcgLS1pZ25vcmUtYmxhbmstbGluZXMgLS1pZ25vcmUtYWxsLXNwYWNlIHNyYy9tYWluL2phdmEvY29tL3hwbi94d2lraS9vYmplY3RzL2NsYXNzZXMvRGF0ZUNsYXNzLmphdmEgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS9vYmplY3RzL2NsYXNzZXMvRGF0ZUNsYXNzLmphdmEKLS0tIHNyYy9tYWluL2phdmEvY29tL3hwbi94d2lraS9vYmplY3RzL2NsYXNzZXMvRGF0ZUNsYXNzLmphdmEJMjAwNi0wNy0xMiAxNDowOTo1MS4wMDAwMDAwMDAgKzAzMDAKKysrIHNyY19pbnRlcmZhY2UvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvb2JqZWN0cy9jbGFzc2VzL0RhdGVDbGFzcy5qYXZhCTIwMDYtMDgtMDkgMjE6Mzc6MTYuMDAwMDAwMDAwICswMzAwCkBAIC0xNDAsNiArMTQwLDcgQEAKIA0KICAgICAgICAgaW5wdXQuc2V0VHlwZSgidGV4dCIpOw0KICAgICAgICAgaW5wdXQuc2V0TmFtZShwcmVmaXggKyBuYW1lKTsNCisgICAgICAgIGlucHV0LnNldElEKHByZWZpeCArIG5hbWUpOw0KICAgICAgICAgaW5wdXQuc2V0U2l6ZShnZXRTaXplKCkpOw0KICAgICAgICAgYnVmZmVyLmFwcGVuZChpbnB1dC50b1N0cmluZygpKTsNCiAgICAgfQ0KZGlmZiAtdSAtciAtLWV4Y2x1ZGU9LnN2biAtLW5ldy1maWxlIC0taWdub3JlLW1hdGNoaW5nLWxpbmVzPSdeaW1wb3J0JyAtLWlnbm9yZS1ibGFuay1saW5lcyAtLWlnbm9yZS1hbGwtc3BhY2Ugc3JjL21haW4vamF2YS9jb20veHBuL3h3aWtpL29iamVjdHMvY2xhc3Nlcy9Hcm91cHNDbGFzcy5qYXZhIHNyY19pbnRlcmZhY2UvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvb2JqZWN0cy9jbGFzc2VzL0dyb3Vwc0NsYXNzLmphdmEKLS0tIHNyYy9tYWluL2phdmEvY29tL3hwbi94d2lraS9vYmplY3RzL2NsYXNzZXMvR3JvdXBzQ2xhc3MuamF2YQkyMDA2LTA4LTA5IDIwOjA4OjIzLjAwMDAwMDAwMCArMDMwMAorKysgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS9vYmplY3RzL2NsYXNzZXMvR3JvdXBzQ2xhc3MuamF2YQkyMDA2LTA4LTA5IDIxOjQwOjQ3LjAwMDAwMDAwMCArMDMwMApAQCAtODAsNyArODEsNyBAQAogICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCkKICAgICAgICAgICAgIHJldHVybiBsaXN0OwogCi0gICAgICAgIFN0cmluZyB2YWwgPSBTdHJpbmdVdGlscy5yZXBsYWNlKHZhbHVlLCAiXFwsIiwgIiVTRVAlIik7CisgICAgICAgIHZhbHVlID0gU3RyaW5nVXRpbHMucmVwbGFjZSh2YWx1ZSwgIlxcLCIsICIlU0VQJSIpOwogICAgICAgICBTdHJpbmdbXSByZXN1bHQgPSBTdHJpbmdVdGlscy5zcGxpdCh2YWx1ZSwgIiwgIik7CiAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgbGlzdC5hZGQoU3RyaW5nVXRpbHMucmVwbGFjZShyZXN1bHRbaV0sICIlU0VQJSIsICIsIikpOwpAQCAtMTM1LDYgKzEzNiw3IEBACiAgICAgICAgICBpZiAoIWlzVXNlc0xpc3QoKSkgewogICAgICAgICAgICAgaW5wdXQgaW4gPSBuZXcgaW5wdXQoKTsKICAgICAgICAgICAgIGluLnNldE5hbWUocHJlZml4ICsgIm5ld2dyb3VwIik7CisgICAgICAgICAgICBpbi5zZXRJRChwcmVmaXggKyAibmV3Z3JvdXAiKTsKICAgICAgICAgICAgIGluLnNldFNpemUoMTUpOwogICAgICAgICAgICAgYnVmZmVyLmFwcGVuZCgiPGJyIC8+Iik7CiAgICAgICAgICAgICBidWZmZXIuYXBwZW5kKGluLnRvU3RyaW5nKCkpOwpkaWZmIC11IC1yIC0tZXhjbHVkZT0uc3ZuIC0tbmV3LWZpbGUgLS1pZ25vcmUtbWF0Y2hpbmctbGluZXM9J15pbXBvcnQnIC0taWdub3JlLWJsYW5rLWxpbmVzIC0taWdub3JlLWFsbC1zcGFjZSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvb2JqZWN0cy9jbGFzc2VzL0xldmVsc0NsYXNzLmphdmEgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS9vYmplY3RzL2NsYXNzZXMvTGV2ZWxzQ2xhc3MuamF2YQotLS0gc3JjL21haW4vamF2YS9jb20veHBuL3h3aWtpL29iamVjdHMvY2xhc3Nlcy9MZXZlbHNDbGFzcy5qYXZhCTIwMDYtMDgtMDkgMjA6MDg6MjMuMDAwMDAwMDAwICswMzAwCisrKyBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL29iamVjdHMvY2xhc3Nlcy9MZXZlbHNDbGFzcy5qYXZhCTIwMDYtMDgtMDkgMjE6NDI6MDUuMDAwMDAwMDAwICswMzAwCkBAIC0xMTYsNiArMTE3LDcgQEAKICAgICAgICAgaW5wdXQgaW4gPSBuZXcgaW5wdXQoKTsKICAgICAgICAgaW4uc2V0VHlwZSgiaGlkZGVuIik7CiAgICAgICAgIGluLnNldE5hbWUocHJlZml4ICsgbmFtZSk7CisgICAgICAgIGluLnNldElEKHByZWZpeCArIG5hbWUpOwogICAgICAgICBidWZmZXIuYXBwZW5kKGluLnRvU3RyaW5nKCkpOwogICAgIH0KIH0KZGlmZiAtdSAtciAtLWV4Y2x1ZGU9LnN2biAtLW5ldy1maWxlIC0taWdub3JlLW1hdGNoaW5nLWxpbmVzPSdeaW1wb3J0JyAtLWlnbm9yZS1ibGFuay1saW5lcyAtLWlnbm9yZS1hbGwtc3BhY2Ugc3JjL21haW4vamF2YS9jb20veHBuL3h3aWtpL29iamVjdHMvY2xhc3Nlcy9MaXN0Q2xhc3MuamF2YSBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL29iamVjdHMvY2xhc3Nlcy9MaXN0Q2xhc3MuamF2YQotLS0gc3JjL21haW4vamF2YS9jb20veHBuL3h3aWtpL29iamVjdHMvY2xhc3Nlcy9MaXN0Q2xhc3MuamF2YQkyMDA2LTA3LTEyIDE0OjA5OjUxLjAwMDAwMDAwMCArMDMwMAorKysgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS9vYmplY3RzL2NsYXNzZXMvTGlzdENsYXNzLmphdmEJMjAwNi0wOC0wOSAyMTo0ODo1MS4wMDAwMDAwMDAgKzAzMDAKQEAgLTE4Niw2ICsxODYsNyBAQAogDQogICAgICAgICBpbnB1dC5zZXRUeXBlKCJoaWRkZW4iKTsNCiAgICAgICAgIGlucHV0LnNldE5hbWUocHJlZml4ICsgbmFtZSk7DQorICAgICAgICBpbnB1dC5zZXRJRChwcmVmaXggKyBuYW1lKTsNCiAgICAgICAgIGJ1ZmZlci5hcHBlbmQoaW5wdXQudG9TdHJpbmcoKSk7DQogICAgIH0NCiANCkBAIC0yMDgsMTEgKzIwOSw1MSBAQAogICAgICAgICAgICAgaW5wdXQuc2V0VHlwZSgidGV4dCIpOw0KICAgICAgICAgICAgIGlucHV0LnNldFNpemUoNjApOw0KICAgICAgICAgICAgIGlucHV0LnNldE5hbWUocHJlZml4ICsgbmFtZSk7DQorICAgICAgICAgICAgaW5wdXQuc2V0SUQocHJlZml4ICsgbmFtZSk7DQogICAgICAgICAgICAgYnVmZmVyLmFwcGVuZChpbnB1dC50b1N0cmluZygpKTsNCisgICAgICAgIH0gZWxzZSBpZiAoZ2V0RGlzcGxheVR5cGUoKS5lcXVhbHMoInJhZGlvIikpIHsNCisgICAgICAgIAlkaXNwbGF5UmFkaW9FZGl0KGJ1ZmZlciwgbmFtZSwgcHJlZml4LCBvYmplY3QsIGNvbnRleHQpOw0KKyAgICAgICAgfQ0KKyAgICAgICAgZWxzZSB7DQorICAgICAgICAJZGlzcGxheVNlbGVjdEVkaXQoYnVmZmVyLCBuYW1lLCBwcmVmaXgsIG9iamVjdCwgY29udGV4dCk7DQorICAgICAgICB9DQorICAgIH0NCisgICAgDQorICAgIHByb3RlY3RlZCB2b2lkIGRpc3BsYXlSYWRpb0VkaXQoU3RyaW5nQnVmZmVyIGJ1ZmZlciwgU3RyaW5nIG5hbWUsIFN0cmluZyBwcmVmaXgsIEJhc2VDb2xsZWN0aW9uIG9iamVjdCwgWFdpa2lDb250ZXh0IGNvbnRleHQpew0KKyAgICAgICAgTGlzdCBsaXN0ID0gZ2V0TGlzdChjb250ZXh0KTsNCisgICAgICAgIExpc3Qgc2VsZWN0bGlzdDsNCisNCisgICAgICAgIEJhc2VQcm9wZXJ0eSBwcm9wID0gIChCYXNlUHJvcGVydHkpb2JqZWN0LnNhZmVnZXQobmFtZSk7DQorICAgICAgICBpZiAocHJvcD09bnVsbCkgew0KKyAgICAgICAgICAgIHNlbGVjdGxpc3QgPSBuZXcgQXJyYXlMaXN0KCk7DQorICAgICAgICB9IGVsc2UgaWYgKChwcm9wIGluc3RhbmNlb2YgTGlzdFByb3BlcnR5KXx8KHByb3AgaW5zdGFuY2VvZiBEQlN0cmluZ0xpc3RQcm9wZXJ0eSkpIHsNCisgICAgICAgICAgICBzZWxlY3RsaXN0ID0gKExpc3QpIHByb3AuZ2V0VmFsdWUoKTsNCiAgICAgICAgIH0gZWxzZSB7DQorICAgICAgICAgICAgc2VsZWN0bGlzdCA9IG5ldyBBcnJheUxpc3QoKTsNCisgICAgICAgICAgICBzZWxlY3RsaXN0LmFkZChwcm9wLmdldFZhbHVlKCkpOw0KKyAgICAgICAgfQ0KKw0KKyAgICAgICAgLy8gQWRkIG9wdGlvbnMgZnJvbSBTZXQNCisgICAgICAgIGZvciAoSXRlcmF0b3IgaXQ9bGlzdC5pdGVyYXRvcigpO2l0Lmhhc05leHQoKTspIHsNCisgICAgICAgICAgICBTdHJpbmcgdmFsdWUgPSBpdC5uZXh0KCkudG9TdHJpbmcoKTsNCisgICAgICAgICAgICBpbnB1dCByYWRpbyA9IG5ldyBpbnB1dChpbnB1dC5yYWRpbywgcHJlZml4ICsgbmFtZSwgdmFsdWUpOw0KKw0KKyAgICAgICAgICAgIGlmIChzZWxlY3RsaXN0LmNvbnRhaW5zKHZhbHVlKSkNCisgICAgICAgICAgICAgICAgcmFkaW8uc2V0Q2hlY2tlZCh0cnVlKTsNCisgICAgICAgICAgICByYWRpby5hZGRFbGVtZW50KHZhbHVlKTsNCisgICAgICAgICAgICBidWZmZXIuYXBwZW5kKHJhZGlvLnRvU3RyaW5nKCkpOw0KKyAgICAgICAgICAgIGlmKGl0Lmhhc05leHQoKSl7DQorICAgICAgICAgICAgCWJ1ZmZlci5hcHBlbmQoIjxici8+Iik7DQorICAgICAgICAgICAgfQ0KKyAgICAgICAgfQ0KKyAgICB9DQorDQorICAgIHByb3RlY3RlZCB2b2lkIGRpc3BsYXlTZWxlY3RFZGl0KFN0cmluZ0J1ZmZlciBidWZmZXIsIFN0cmluZyBuYW1lLCBTdHJpbmcgcHJlZml4LCBCYXNlQ29sbGVjdGlvbiBvYmplY3QsIFhXaWtpQ29udGV4dCBjb250ZXh0KXsNCiAgICAgICAgICAgICBzZWxlY3Qgc2VsZWN0ID0gbmV3IHNlbGVjdChwcmVmaXggKyBuYW1lLCAxKTsNCiAgICAgICAgICAgICBzZWxlY3Quc2V0TXVsdGlwbGUoaXNNdWx0aVNlbGVjdCgpKTsNCiAgICAgICAgICAgICBzZWxlY3Quc2V0U2l6ZShnZXRTaXplKCkpOw0KKyAgICAgICAgc2VsZWN0LnNldE5hbWUocHJlZml4ICsgbmFtZSk7DQorICAgICAgICBzZWxlY3Quc2V0SUQocHJlZml4ICsgbmFtZSk7DQogDQogICAgICAgICAgICAgTGlzdCBsaXN0ID0gZ2V0TGlzdChjb250ZXh0KTsNCiAgICAgICAgICAgICBMaXN0IHNlbGVjdGxpc3Q7DQpAQCAtMjM5LDkgKzI4MCw2IEBACiANCiAgICAgICAgICAgICBidWZmZXIuYXBwZW5kKHNlbGVjdC50b1N0cmluZygpKTsNCiAgICAgICAgIH0NCi0gICAgfQ0KIA0KICAgICBwdWJsaWMgYWJzdHJhY3QgTGlzdCBnZXRMaXN0KFhXaWtpQ29udGV4dCBjb250ZXh0KTsNCi0NCi0NCiB9DQpkaWZmIC11IC1yIC0tZXhjbHVkZT0uc3ZuIC0tbmV3LWZpbGUgLS1pZ25vcmUtbWF0Y2hpbmctbGluZXM9J15pbXBvcnQnIC0taWdub3JlLWJsYW5rLWxpbmVzIC0taWdub3JlLWFsbC1zcGFjZSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvb2JqZWN0cy9jbGFzc2VzL051bWJlckNsYXNzLmphdmEgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS9vYmplY3RzL2NsYXNzZXMvTnVtYmVyQ2xhc3MuamF2YQotLS0gc3JjL21haW4vamF2YS9jb20veHBuL3h3aWtpL29iamVjdHMvY2xhc3Nlcy9OdW1iZXJDbGFzcy5qYXZhCTIwMDYtMDctMTIgMTQ6MDk6NTEuMDAwMDAwMDAwICswMzAwCisrKyBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL29iamVjdHMvY2xhc3Nlcy9OdW1iZXJDbGFzcy5qYXZhCTIwMDYtMDgtMDkgMjE6NDk6MjguMDAwMDAwMDAwICswMzAwCkBAIC0xMDgsNiArMTA4LDcgQEAKIA0KICAgICAgICAgaW5wdXQuc2V0VHlwZSgidGV4dCIpOw0KICAgICAgICAgaW5wdXQuc2V0TmFtZShwcmVmaXggKyBuYW1lKTsNCisgICAgICAgIGlucHV0LnNldElEKHByZWZpeCArIG5hbWUpOw0KICAgICAgICAgaW5wdXQuc2V0U2l6ZShnZXRTaXplKCkpOw0KICAgICAgICAgYnVmZmVyLmFwcGVuZChpbnB1dC50b1N0cmluZygpKTsNCiAgICAgfQ0KZGlmZiAtdSAtciAtLWV4Y2x1ZGU9LnN2biAtLW5ldy1maWxlIC0taWdub3JlLW1hdGNoaW5nLWxpbmVzPSdeaW1wb3J0JyAtLWlnbm9yZS1ibGFuay1saW5lcyAtLWlnbm9yZS1hbGwtc3BhY2Ugc3JjL21haW4vamF2YS9jb20veHBuL3h3aWtpL29iamVjdHMvY2xhc3Nlcy9Qcm9wZXJ0eUNsYXNzLmphdmEgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS9vYmplY3RzL2NsYXNzZXMvUHJvcGVydHlDbGFzcy5qYXZhCi0tLSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvb2JqZWN0cy9jbGFzc2VzL1Byb3BlcnR5Q2xhc3MuamF2YQkyMDA2LTA3LTEyIDE0OjA5OjUxLjAwMDAwMDAwMCArMDMwMAorKysgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS9vYmplY3RzL2NsYXNzZXMvUHJvcGVydHlDbGFzcy5qYXZhCTIwMDYtMDgtMDkgMjE6NDk6NTIuMDAwMDAwMDAwICswMzAwCkBAIC0xMTcsNiArMTE3LDcgQEAKIA0KICAgICAgICBpbnB1dC5zZXRUeXBlKCJoaWRkZW4iKTsNCiAgICAgICAgaW5wdXQuc2V0TmFtZShwcmVmaXggKyBuYW1lKTsNCisgICAgICAgaW5wdXQuc2V0SUQocHJlZml4ICsgbmFtZSk7DQogICAgICAgIGJ1ZmZlci5hcHBlbmQoaW5wdXQudG9TdHJpbmcoKSk7DQogICAgIH0NCiANCkBAIC0xMjcsNiArMTI4LDcgQEAKIA0KICAgICAgICAgaW5wdXQuc2V0VHlwZSgidGV4dCIpOw0KICAgICAgICAgaW5wdXQuc2V0TmFtZShwcmVmaXggKyBuYW1lKTsNCisgICAgICAgIGlucHV0LnNldElEKHByZWZpeCArIG5hbWUpOw0KICAgICAgICAgYnVmZmVyLmFwcGVuZChpbnB1dC50b1N0cmluZygpKTsNCiAgICAgfQ0KIA0KQEAgLTE0Miw2ICsxNDQsNyBAQAogDQogICAgICAgICBpbnB1dC5zZXRUeXBlKCJ0ZXh0Iik7DQogICAgICAgICBpbnB1dC5zZXROYW1lKHByZWZpeCArIG5hbWUpOw0KKyAgICAgICAgaW5wdXQuc2V0SUQocHJlZml4ICsgbmFtZSk7DQogICAgICAgICBidWZmZXIuYXBwZW5kKGlucHV0LnRvU3RyaW5nKCkpOw0KICAgICB9DQogDQpkaWZmIC11IC1yIC0tZXhjbHVkZT0uc3ZuIC0tbmV3LWZpbGUgLS1pZ25vcmUtbWF0Y2hpbmctbGluZXM9J15pbXBvcnQnIC0taWdub3JlLWJsYW5rLWxpbmVzIC0taWdub3JlLWFsbC1zcGFjZSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvb2JqZWN0cy9jbGFzc2VzL1N0cmluZ0NsYXNzLmphdmEgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS9vYmplY3RzL2NsYXNzZXMvU3RyaW5nQ2xhc3MuamF2YQotLS0gc3JjL21haW4vamF2YS9jb20veHBuL3h3aWtpL29iamVjdHMvY2xhc3Nlcy9TdHJpbmdDbGFzcy5qYXZhCTIwMDYtMDctMTIgMTQ6MDk6NTIuMDAwMDAwMDAwICswMzAwCisrKyBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL29iamVjdHMvY2xhc3Nlcy9TdHJpbmdDbGFzcy5qYXZhCTIwMDYtMDgtMDkgMjE6NTA6MDguMDAwMDAwMDAwICswMzAwCkBAIC03Myw2ICs3Myw3IEBACiANCiAgICAgICAgIGlucHV0LnNldFR5cGUoInRleHQiKTsNCiAgICAgICAgIGlucHV0LnNldE5hbWUocHJlZml4ICsgbmFtZSk7DQorICAgICAgICBpbnB1dC5zZXRJRChwcmVmaXggKyBuYW1lKTsNCiAgICAgICAgIGlucHV0LnNldFNpemUoZ2V0U2l6ZSgpKTsNCiAgICAgICAgIGJ1ZmZlci5hcHBlbmQoaW5wdXQudG9TdHJpbmcoKSk7DQogICAgIH0NCmRpZmYgLXUgLXIgLS1leGNsdWRlPS5zdm4gLS1uZXctZmlsZSAtLWlnbm9yZS1tYXRjaGluZy1saW5lcz0nXmltcG9ydCcgLS1pZ25vcmUtYmxhbmstbGluZXMgLS1pZ25vcmUtYWxsLXNwYWNlIHNyYy9tYWluL2phdmEvY29tL3hwbi94d2lraS9wbHVnaW4vaW1hZ2UvSW1hZ2VQbHVnaW4uamF2YSBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL3BsdWdpbi9pbWFnZS9JbWFnZVBsdWdpbi5qYXZhCi0tLSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvcGx1Z2luL2ltYWdlL0ltYWdlUGx1Z2luLmphdmEJMjAwNi0wOC0wOSAyMDowODozMS4wMDAwMDAwMDAgKzAzMDAKKysrIHNyY19pbnRlcmZhY2UvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvcGx1Z2luL2ltYWdlL0ltYWdlUGx1Z2luLmphdmEJMjAwNi0wOC0wOSAyMDo1NjoxMi4wMDAwMDAwMDAgKzAzMDAKQEAgLTE1Miw5ICsxNTIsOCBAQAogICAgICAgICAgICAgfQogICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgYXR0YWNobWVudENsb25lID0gYXR0YWNobWVudDsKLSAgICAgICAgfSBmaW5hbGx5IHsKLSAgICAgICAgICAgIHJldHVybiBhdHRhY2htZW50Q2xvbmU7CiAgICAgICAgIH0KKyAgICAgICAgcmV0dXJuIGF0dGFjaG1lbnRDbG9uZTsKICAgICB9CiAKICAgICBwdWJsaWMgWFdpa2lBdHRhY2htZW50IGdldEltYWdlQnlIZWlnaHQoWFdpa2lBdHRhY2htZW50IGF0dGFjaG1lbnQsIGludCB0aHVtYm5haWxIZWlnaHQsIFhXaWtpQ29udGV4dCBjb250ZXh0KSB0aHJvd3MgRXhjZXB0aW9uIHsKZGlmZiAtdSAtciAtLWV4Y2x1ZGU9LnN2biAtLW5ldy1maWxlIC0taWdub3JlLW1hdGNoaW5nLWxpbmVzPSdeaW1wb3J0JyAtLWlnbm9yZS1ibGFuay1saW5lcyAtLWlnbm9yZS1hbGwtc3BhY2Ugc3JjL21haW4vamF2YS9jb20veHBuL3h3aWtpL3JlbmRlci9YV2lraVJhZGVveFJlbmRlckVuZ2luZS5qYXZhIHNyY19pbnRlcmZhY2UvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvcmVuZGVyL1hXaWtpUmFkZW94UmVuZGVyRW5naW5lLmphdmEKLS0tIHNyYy9tYWluL2phdmEvY29tL3hwbi94d2lraS9yZW5kZXIvWFdpa2lSYWRlb3hSZW5kZXJFbmdpbmUuamF2YQkyMDA2LTA3LTEyIDE0OjA5OjU3LjAwMDAwMDAwMCArMDMwMAorKysgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS9yZW5kZXIvWFdpa2lSYWRlb3hSZW5kZXJFbmdpbmUuamF2YQkyMDA2LTA4LTA5IDIxOjUxOjU4LjAwMDAwMDAwMCArMDMwMApAQCAtMjgwLDEwICsyODAsNiBAQAogICAgICAgICAgICAgaWYgKChkYj09bnVsbCl8fChkYXRhYmFzZS5lcXVhbHMoZGIpKSkNCiAgICAgICAgICAgICAgYWRkTGlua1RvQ29udGV4dChuZXdkb2MuZ2V0RnVsbE5hbWUoKSwgY29udGV4dCk7DQogDQotICAgICAgICAgICAgU3RyaW5nIGVkaXRvciA9IGNvbnRleHQuZ2V0V2lraSgpLmdldEVkaXRvclByZWZlcmVuY2UoY29udGV4dCk7DQotICAgICAgICAgICAgaWYgKCghZWRpdG9yLmVxdWFscygiIikmJighZWRpdG9yLmVxdWFscygidGV4dCIpKSkpDQotICAgICAgICAgICAgICAgIHF1ZXJ5c3RyaW5nICs9ICImeHBhZ2U9IiArIGVkaXRvcjsNCi0NCiAgICAgICAgICAgICBVUkwgdXJsID0gY29udGV4dC5nZXRVUkxGYWN0b3J5KCkuY3JlYXRlVVJMKG5ld2RvYy5nZXRXZWIoKSwgbmV3ZG9jLmdldE5hbWUoKSwNCiAgICAgICAgICAgICAgICAgICAgICJlZGl0IiwgcXVlcnlzdHJpbmcsIG51bGwsIGNvbnRleHQpOw0KICAgICAgICAgICAgIFN0cmluZyBzdXJsID0gY29udGV4dC5nZXRVUkxGYWN0b3J5KCkuZ2V0VVJMKHVybCwgY29udGV4dCk7DQpkaWZmIC11IC1yIC0tZXhjbHVkZT0uc3ZuIC0tbmV3LWZpbGUgLS1pZ25vcmUtbWF0Y2hpbmctbGluZXM9J15pbXBvcnQnIC0taWdub3JlLWJsYW5rLWxpbmVzIC0taWdub3JlLWFsbC1zcGFjZSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvcmVuZGVyL2ZpbHRlci9YV2lraUhlYWRpbmdGaWx0ZXIuamF2YSBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL3JlbmRlci9maWx0ZXIvWFdpa2lIZWFkaW5nRmlsdGVyLmphdmEKLS0tIHNyYy9tYWluL2phdmEvY29tL3hwbi94d2lraS9yZW5kZXIvZmlsdGVyL1hXaWtpSGVhZGluZ0ZpbHRlci5qYXZhCTIwMDYtMDgtMDkgMTQ6NDY6MTIuMDAwMDAwMDAwICswMzAwCisrKyBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL3JlbmRlci9maWx0ZXIvWFdpa2lIZWFkaW5nRmlsdGVyLmphdmEJMjAwNi0wOC0wOSAyMjowMDo0NS4wMDAwMDAwMDAgKzAzMDAKQEAgLTY4LDYgKzY4LDggQEAKICAgcHVibGljIFN0cmluZyBoYW5kbGVNYXRjaChNYXRjaFJlc3VsdCByZXN1bHQsIEZpbHRlckNvbnRleHQgY29udGV4dCkgew0KICAgICBTdHJpbmcgaWQgPSBudWxsOw0KICAgICBTdHJpbmcgbGV2ZWwgPSByZXN1bHQuZ3JvdXAoMSk7DQorCSAgIGludCBsZXZlbF9pID0gKGxldmVsLmxlbmd0aCgpKzMpLzI7CisJICAgU3RyaW5nIGhsZXZlbCA9IChsZXZlbF9pIDw9IDYgPyBsZXZlbF9pIDogNikrICIiOwogICAgIFN0cmluZyB0ZXh0ID0gcmVzdWx0Lmdyb3VwKDMpOw0KICAgICBTdHJpbmcgbnVtYmVyaW5nID0gIiI7DQogICAgIA0KQEAgLTgwLDEwICs4MSwxOSBAQAogICAgICAgcHJvY2Vzc2VkSGVhZGluZ3MgPSBuZXcgQXJyYXlMaXN0KCk7DQogICAgICAgcmNvbnRleHQuc2V0KCJwcm9jZXNzZWRIZWFkaW5ncyIsIHByb2Nlc3NlZEhlYWRpbmdzKTsNCiAgICAgfQ0KKwkgICBib29sZWFuIGlzSWRPayA9IGZhbHNlOworCSAgIGlkID0gVE9DR2VuZXJhdG9yLm1ha2VIZWFkaW5nSUQodGV4dCwgMCwgeGNvbnRleHQpOworCSAgIHdoaWxlKCFpc0lkT2spewogICAgIGludCBvY2N1cmVuY2UgPSAwOw0KLSAgICBmb3IgKEl0ZXJhdG9yIGl0ZXIgPSBwcm9jZXNzZWRIZWFkaW5ncy5pdGVyYXRvcigpOyBpdGVyLmhhc05leHQoKTspIGlmIChpdGVyLm5leHQoKS5lcXVhbHModGV4dCkpIG9jY3VyZW5jZSsrOw0KLSAgICBpZCA9IFRPQ0dlbmVyYXRvci5tYWtlSGVhZGluZ0lEKHRleHQsIG9jY3VyZW5jZSwgeGNvbnRleHQpOw0KLSAgICBwcm9jZXNzZWRIZWFkaW5ncy5hZGQodGV4dCk7DQorCSAgICAgZm9yIChJdGVyYXRvciBpdGVyID0gcHJvY2Vzc2VkSGVhZGluZ3MuaXRlcmF0b3IoKTsgaXRlci5oYXNOZXh0KCk7KXsKKwkgICAgICAgaWYgKGl0ZXIubmV4dCgpLmVxdWFscyhpZCkpIG9jY3VyZW5jZSsrOworCSAgICAgfQorCSAgICAgaWQgPSBUT0NHZW5lcmF0b3IubWFrZUhlYWRpbmdJRChpZCwgb2NjdXJlbmNlLCB4Y29udGV4dCk7CisJICAgICBpZihvY2N1cmVuY2UgPT0gMCl7CisJICAgICAgIGlzSWRPayA9IHRydWU7CisJICAgICB9CisJICAgfQorCSAgIHByb2Nlc3NlZEhlYWRpbmdzLmFkZChpZCk7CiAgICAgDQogICAgIC8vICBhZGQgbnVtYmVyaW5nIGlmIHRoZSBmbGFnIGlzIHNldA0KICAgICBpZiAoeGNvbnRleHQuY29udGFpbnNLZXkoVE9DX05VTUJFUkVEKSAmJiAoKEJvb2xlYW4peGNvbnRleHQuZ2V0KFRPQ19OVU1CRVJFRCkpLmJvb2xlYW5WYWx1ZSgpKSB7DQpAQCAtOTMsNiArMTAzLDYgQEAKICAgICAgIH0NCiAgICAgfQ0KICAgICANCi0gICAgcmV0dXJuIGZvcm1hdHRlci5mb3JtYXQobmV3IE9iamVjdFtde2lkLCBsZXZlbC5yZXBsYWNlKCcuJywgJy0nKSwgbnVtYmVyaW5nLCB0ZXh0fSk7DQorCQkgICByZXR1cm4gZm9ybWF0dGVyLmZvcm1hdChuZXcgT2JqZWN0W117aWQsIGxldmVsLnJlcGxhY2UoJy4nLCAnLScpLCBudW1iZXJpbmcsIHRleHQsIGhsZXZlbH0pOwogICB9IA0KIH0NCmRpZmYgLXUgLXIgLS1leGNsdWRlPS5zdm4gLS1uZXctZmlsZSAtLWlnbm9yZS1tYXRjaGluZy1saW5lcz0nXmltcG9ydCcgLS1pZ25vcmUtYmxhbmstbGluZXMgLS1pZ25vcmUtYWxsLXNwYWNlIHNyYy9tYWluL2phdmEvY29tL3hwbi94d2lraS9yZW5kZXIvZmlsdGVyL1hXaWtpTGlua0ZpbHRlci5qYXZhIHNyY19pbnRlcmZhY2UvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvcmVuZGVyL2ZpbHRlci9YV2lraUxpbmtGaWx0ZXIuamF2YQotLS0gc3JjL21haW4vamF2YS9jb20veHBuL3h3aWtpL3JlbmRlci9maWx0ZXIvWFdpa2lMaW5rRmlsdGVyLmphdmEJMjAwNi0wNy0xMiAxNDowOTo1Ny4wMDAwMDAwMDAgKzAzMDAKKysrIHNyY19pbnRlcmZhY2UvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvcmVuZGVyL2ZpbHRlci9YV2lraUxpbmtGaWx0ZXIuamF2YQkyMDA2LTA4LTA5IDIyOjAyOjU4LjAwMDAwMDAwMCArMDMwMApAQCAtODAsNiArODAsNyBAQAogICAgICAgICAgICAgU3RyaW5nIG5hbWUgPSByZXN1bHQuZ3JvdXAoMSk7DQogICAgICAgICAgICAgaWYgKG5hbWUgIT0gbnVsbCkgew0KIA0KKyAgICAgICAgICAgIAkvLyBUT0RPOiBUaGlzIGxpbmUgY3JlYXRlcyBidWcgWFdJS0ktMTg4LiBUaGUgZW5jb2RlciBzZWVtcyB0byBiZSBicm9rZW4uIEZpeCB0aGlzIQ0KICAgICAgICAgICAgICAgICAvLyB0cmltIHRoZSBuYW1lIGFuZCB1bmVzY2FwZSBpdA0KICAgICAgICAgICAgICAgICBuYW1lID0gRW5jb2Rlci51bmVzY2FwZShuYW1lLnRyaW0oKSk7DQogDQpkaWZmIC11IC1yIC0tZXhjbHVkZT0uc3ZuIC0tbmV3LWZpbGUgLS1pZ25vcmUtbWF0Y2hpbmctbGluZXM9J15pbXBvcnQnIC0taWdub3JlLWJsYW5rLWxpbmVzIC0taWdub3JlLWFsbC1zcGFjZSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvcmVuZGVyL21hY3JvL0Rpc3BsYXlNYWNyby5qYXZhIHNyY19pbnRlcmZhY2UvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvcmVuZGVyL21hY3JvL0Rpc3BsYXlNYWNyby5qYXZhCi0tLSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvcmVuZGVyL21hY3JvL0Rpc3BsYXlNYWNyby5qYXZhCTIwMDYtMDctMTIgMTQ6MDk6NTcuMDAwMDAwMDAwICswMzAwCisrKyBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL3JlbmRlci9tYWNyby9EaXNwbGF5TWFjcm8uamF2YQkyMDA2LTA4LTA5IDIyOjA0OjM1LjAwMDAwMDAwMCArMDMwMApAQCAtMTcsNyArMTcsNyBAQAogDQogICogQ3JlYXRlZCBieQ0KICAqIFVzZXI6IEx1ZG92aWMgRHVib3N0DQotICogRGF0ZTogMjUgYW/7dCAyMDA0DQorICogRGF0ZTogMjUgYW/vv710IDIwMDQNCiAgKiBUaW1lOiAxMzo0MzoxOQ0KICAqLw0KIHBhY2thZ2UgY29tLnhwbi54d2lraS5yZW5kZXIubWFjcm87DQpkaWZmIC11IC1yIC0tZXhjbHVkZT0uc3ZuIC0tbmV3LWZpbGUgLS1pZ25vcmUtbWF0Y2hpbmctbGluZXM9J15pbXBvcnQnIC0taWdub3JlLWJsYW5rLWxpbmVzIC0taWdub3JlLWFsbC1zcGFjZSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvcmVuZGVyL21hY3JvL0ltYWdlTWFjcm8uamF2YSBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL3JlbmRlci9tYWNyby9JbWFnZU1hY3JvLmphdmEKLS0tIHNyYy9tYWluL2phdmEvY29tL3hwbi94d2lraS9yZW5kZXIvbWFjcm8vSW1hZ2VNYWNyby5qYXZhCTIwMDYtMDgtMDkgMTQ6NDY6MTIuMDAwMDAwMDAwICswMzAwCisrKyBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL3JlbmRlci9tYWNyby9JbWFnZU1hY3JvLmphdmEJMjAwNi0wOC0wOSAyMjowNjowMS4wMDAwMDAwMDAgKzAzMDAKQEAgLTU2LDEwICs1NiwxMiBAQAogICAgIHN0ci5hcHBlbmQoIjxpbWcgc3JjPVwiIik7DQogICAgIHN0ci5hcHBlbmQoZG9jLmdldEF0dGFjaG1lbnRVUkwoaW1nLCAiZG93bmxvYWQiLCB4Y29udGV4dCkpOw0KICAgICBzdHIuYXBwZW5kKCJcIiAiKTsNCi0gICAgaWYgKCghIm5vbmUiLmVxdWFscyhoZWlnaHQpKSYmKGhlaWdodCE9bnVsbCkpDQotICAgICBzdHIuYXBwZW5kKCJoZWlnaHQ9XCIiICsgaGVpZ2h0ICsgIlwiICIpOw0KLSAgICBpZiAoKCEibm9uZSIuZXF1YWxzKHdpZHRoKSkmJih3aWR0aCE9bnVsbCkpDQotICAgICAgICAgICBzdHIuYXBwZW5kKCJ3aWR0aD1cIiIgKyB3aWR0aCArICJcIiAiKTsNCisgICAgaWYgKCghIm5vbmUiLmVxdWFscyhoZWlnaHQpKSYmKGhlaWdodCE9bnVsbCkmJighIiIuZXF1YWxzKGhlaWdodC50cmltKCkpKSl7CisgICAgICAgIHN0ci5hcHBlbmQoImhlaWdodD1cIiIgKyBoZWlnaHQudHJpbSgpICsgIlwiICIpOworICAgIH0KKyAgICBpZiAoKCEibm9uZSIuZXF1YWxzKHdpZHRoKSkmJih3aWR0aCE9bnVsbCkmJighIiIuZXF1YWxzKHdpZHRoLnRyaW0oKSkpKXsKKyAgICAJc3RyLmFwcGVuZCgid2lkdGg9XCIiICsgd2lkdGgudHJpbSgpICsgIlwiICIpOworICAgIH0KICAgICBzdHIuYXBwZW5kKCJhbHQ9XCIiKTsNCiAgICAgc3RyLmFwcGVuZChpbWcpOw0KICAgICBzdHIuYXBwZW5kKCJcIiAvPiIpOw0KZGlmZiAtdSAtciAtLWV4Y2x1ZGU9LnN2biAtLW5ldy1maWxlIC0taWdub3JlLW1hdGNoaW5nLWxpbmVzPSdeaW1wb3J0JyAtLWlnbm9yZS1ibGFuay1saW5lcyAtLWlnbm9yZS1hbGwtc3BhY2Ugc3JjL21haW4vamF2YS9jb20veHBuL3h3aWtpL3JlbmRlci9tYWNyby9Vc2VNYWNyby5qYXZhIHNyY19pbnRlcmZhY2UvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvcmVuZGVyL21hY3JvL1VzZU1hY3JvLmphdmEKLS0tIHNyYy9tYWluL2phdmEvY29tL3hwbi94d2lraS9yZW5kZXIvbWFjcm8vVXNlTWFjcm8uamF2YQkyMDA2LTA3LTEyIDE0OjA5OjU3LjAwMDAwMDAwMCArMDMwMAorKysgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS9yZW5kZXIvbWFjcm8vVXNlTWFjcm8uamF2YQkyMDA2LTA4LTA5IDIwOjQ5OjMyLjAwMDAwMDAwMCArMDMwMApAQCAtMTcsNyArMTcsNyBAQAogDQogICogQ3JlYXRlZCBieQ0KICAqIFVzZXI6IEx1ZG92aWMgRHVib3N0DQotICogRGF0ZTogMjUgYW/7dCAyMDA0DQorICogRGF0ZTogMjUgYW/vv710IDIwMDQNCiAgKiBUaW1lOiAxMzo0MzoxOQ0KICAqLw0KIHBhY2thZ2UgY29tLnhwbi54d2lraS5yZW5kZXIubWFjcm87DQpkaWZmIC11IC1yIC0tZXhjbHVkZT0uc3ZuIC0tbmV3LWZpbGUgLS1pZ25vcmUtbWF0Y2hpbmctbGluZXM9J15pbXBvcnQnIC0taWdub3JlLWJsYW5rLWxpbmVzIC0taWdub3JlLWFsbC1zcGFjZSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvdXNlci9pbXBsL3h3aWtpL1hXaWtpUmlnaHRTZXJ2aWNlSW1wbC5qYXZhIHNyY19pbnRlcmZhY2UvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvdXNlci9pbXBsL3h3aWtpL1hXaWtpUmlnaHRTZXJ2aWNlSW1wbC5qYXZhCi0tLSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvdXNlci9pbXBsL3h3aWtpL1hXaWtpUmlnaHRTZXJ2aWNlSW1wbC5qYXZhCTIwMDYtMDgtMDkgMjA6MDg6MzcuMDAwMDAwMDAwICswMzAwCisrKyBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL3VzZXIvaW1wbC94d2lraS9YV2lraVJpZ2h0U2VydmljZUltcGwuamF2YQkyMDA2LTA4LTA5IDIyOjA2OjU4LjAwMDAwMDAwMCArMDMwMApAQCAtOTIsNiArOTksOSBAQAogICAgICAgICAgICAgYWN0aW9uTWFwLnB1dCgicmVzZXQiLCAiZGVsZXRlIik7DQogICAgICAgICAgICAgYWN0aW9uTWFwLnB1dCgiY29tbWVudGFkZCIsICJjb21tZW50Iik7DQogICAgICAgICAgICAgYWN0aW9uTWFwLnB1dCgicmVnaXN0ZXIiLCAicmVnaXN0ZXIiKTsNCisgICAgICAgICAgICBhY3Rpb25NYXAucHV0KCJyZWRpcmVjdCIsICJ2aWV3Iik7DQorICAgICAgICAgICAgYWN0aW9uTWFwLnB1dCgianMiLCAidmlldyIpOw0KKyAgICAgICAgICAgIGFjdGlvbk1hcC5wdXQoImFkbWluIiwgImFkbWluIik7DQogICAgICAgICB9DQogDQogICAgICAgICBTdHJpbmcgcmlnaHQgPSAoU3RyaW5nKSBhY3Rpb25NYXAuZ2V0KGFjdGlvbik7DQpkaWZmIC11IC1yIC0tZXhjbHVkZT0uc3ZuIC0tbmV3LWZpbGUgLS1pZ25vcmUtbWF0Y2hpbmctbGluZXM9J15pbXBvcnQnIC0taWdub3JlLWJsYW5rLWxpbmVzIC0taWdub3JlLWFsbC1zcGFjZSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvdXRpbC9UT0NHZW5lcmF0b3IuamF2YSBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL3V0aWwvVE9DR2VuZXJhdG9yLmphdmEKLS0tIHNyYy9tYWluL2phdmEvY29tL3hwbi94d2lraS91dGlsL1RPQ0dlbmVyYXRvci5qYXZhCTIwMDYtMDgtMDkgMTQ6NDY6MTIuMDAwMDAwMDAwICswMzAwCisrKyBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL3V0aWwvVE9DR2VuZXJhdG9yLmphdmEJMjAwNi0wOC0wOSAyMjoxMDo0My4wMDAwMDAwMDAgKzAzMDAKQEAgLTExNSw2ICsxMTYsOCBAQAogICBwdWJsaWMgc3RhdGljIFN0cmluZyBtYWtlSGVhZGluZ0lEIChTdHJpbmcgdGV4dCwgaW50IG9jY3VyZW5jZSwgWFdpa2lDb250ZXh0IGNvbnRleHQpIHsNCiAgICAgLy8gRW5jb2RlIHRvIGNvbnZlcnQgdW5zYWZlIGNoYXJzDQogICAgIHRleHQgPSBVdGlscy5lbmNvZGUodGV4dC50cmltKCksIGNvbnRleHQpOw0KKyAgICB0ZXh0ID0gIkgiICsgWFdpa2kuZ2V0VVJMRW5jb2RlZCh0ZXh0KTsKKyAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlQWxsKCJbXFwrfCVdIiwgIiIpOwogICAgICAgICANCiAgICAgaWYgKG9jY3VyZW5jZSA+IDApIHsNCiAgICAgICByZXR1cm4gdGV4dCArICItIiArIG9jY3VyZW5jZTsNCmRpZmYgLXUgLXIgLS1leGNsdWRlPS5zdm4gLS1uZXctZmlsZSAtLWlnbm9yZS1tYXRjaGluZy1saW5lcz0nXmltcG9ydCcgLS1pZ25vcmUtYmxhbmstbGluZXMgLS1pZ25vcmUtYWxsLXNwYWNlIHNyYy9tYWluL2phdmEvY29tL3hwbi94d2lraS91dGlsL1V0aWwuamF2YSBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL3V0aWwvVXRpbC5qYXZhCi0tLSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvdXRpbC9VdGlsLmphdmEJMjAwNi0wNy0xMiAxNDowOTo1OS4wMDAwMDAwMDAgKzAzMDAKKysrIHNyY19pbnRlcmZhY2UvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvdXRpbC9VdGlsLmphdmEJMjAwNi0wOC0wOSAyMDo1MzozNS4wMDAwMDAwMDAgKzAzMDAKQEAgLTIxMiw3ICsyMjIsNyBAQAogDQogICAgIHB1YmxpYyBzdGF0aWMgU3RyaW5nIG5vYWNjZW50cyhTdHJpbmcgdGV4dCkgew0KICAgICAgICAgU3RyaW5nIHRlbXAgPSB0ZXh0Ow0KLSAgICAgICAgU3RyaW5nIG9yaWcgPSAi4OLk6ejq6+7v9Pb5+/wiOw0KKyAgICAgICAgU3RyaW5nIG9yaWcgPSAi77+977+977+977+977+977+977+977+977+977+977+977+977+977+9IjsNCiAgICAgICAgIFN0cmluZyB0YXJnID0gImFhYWVlZWVpaW9vdXV1IjsNCiAgICAgICAgIGZvciAoaW50IGk9MDtpPG9yaWcubGVuZ3RoKCk7aSsrKQ0KICAgICAgICAgICAgIHRlbXAgPSB0ZW1wLnJlcGxhY2Uob3JpZy5jaGFyQXQoaSksIHRhcmcuY2hhckF0KGkpKTsNCmRpZmYgLXUgLXIgLS1leGNsdWRlPS5zdm4gLS1uZXctZmlsZSAtLWlnbm9yZS1tYXRjaGluZy1saW5lcz0nXmltcG9ydCcgLS1pZ25vcmUtYmxhbmstbGluZXMgLS1pZ25vcmUtYWxsLXNwYWNlIHNyYy9tYWluL2phdmEvY29tL3hwbi94d2lraS93ZWIvQWRtaW5BY3Rpb24uamF2YSBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL3dlYi9BZG1pbkFjdGlvbi5qYXZhCi0tLSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvd2ViL0FkbWluQWN0aW9uLmphdmEJMTk3MC0wMS0wMSAwMjowMDowMC4wMDAwMDAwMDAgKzAyMDAKKysrIHNyY19pbnRlcmZhY2UvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvd2ViL0FkbWluQWN0aW9uLmphdmEJMjAwNi0wOC0wOSAyMjoyNDo1My4wMDAwMDAwMDAgKzAzMDAKQEAgLTAsMCArMSwxMjYgQEAKKy8qDQorICogQ29weXJpZ2h0IDIwMDYsIFhwZXJ0TmV0IFNBUkwsIGFuZCBpbmRpdmlkdWFsIGNvbnRyaWJ1dG9ycyBhcyBpbmRpY2F0ZWQNCisgKiBieSB0aGUgY29udHJpYnV0b3JzLnR4dC4NCisgKg0KKyAqIFRoaXMgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeSBpdA0KKyAqIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzDQorICogcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIuMSBvZg0KKyAqIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLg0KKyAqDQorICogVGhpcyBzb2Z0d2FyZSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLA0KKyAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mDQorICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiBTZWUgdGhlIEdOVQ0KKyAqIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuDQorICoNCisgKiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljDQorICogTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgc29mdHdhcmU7IGlmIG5vdCwgd3JpdGUgdG8gdGhlIEZyZWUNCisgKiBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBJbmMuLCA1MSBGcmFua2xpbiBTdCwgRmlmdGggRmxvb3IsIEJvc3RvbiwgTUENCisgKiAwMjExMC0xMzAxIFVTQSwgb3Igc2VlIHRoZSBGU0Ygc2l0ZTogaHR0cDovL3d3dy5mc2Yub3JnLg0KKyAqDQorICogQGF1dGhvciBtYXJ0YQ0KKyAqLw0KKw0KK3BhY2thZ2UgY29tLnhwbi54d2lraS53ZWI7DQorDQoraW1wb3J0IG9yZy5hcGFjaGUudmVsb2NpdHkuVmVsb2NpdHlDb250ZXh0Ow0KK2ltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubG9nZ2luZy5Mb2c7DQoraW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sb2dnaW5nLkxvZ0ZhY3Rvcnk7DQorDQoraW1wb3J0IGNvbS54cG4ueHdpa2kuWFdpa2lDb250ZXh0Ow0KK2ltcG9ydCBjb20ueHBuLnh3aWtpLlhXaWtpRXhjZXB0aW9uOw0KK2ltcG9ydCBjb20ueHBuLnh3aWtpLmFwaS5Eb2N1bWVudDsNCitpbXBvcnQgY29tLnhwbi54d2lraS5kb2MuWFdpa2lEb2N1bWVudDsNCitpbXBvcnQgY29tLnhwbi54d2lraS5kb2MuWFdpa2lMb2NrOw0KKw0KK3B1YmxpYyBjbGFzcyBBZG1pbkFjdGlvbiBleHRlbmRzIFhXaWtpQWN0aW9uIHsNCisgICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9nIGxvZyA9IExvZ0ZhY3RvcnkuZ2V0TG9nKEFkbWluQWN0aW9uLmNsYXNzKTsNCisNCisJcHVibGljIFN0cmluZyByZW5kZXIoWFdpa2lDb250ZXh0IGNvbnRleHQpIHRocm93cyBYV2lraUV4Y2VwdGlvbiB7DQorICAgICAgICBYV2lraVJlcXVlc3QgcmVxdWVzdCA9IGNvbnRleHQuZ2V0UmVxdWVzdCgpOw0KKyAgICAgICAgU3RyaW5nIGNvbnRlbnQgPSByZXF1ZXN0LmdldFBhcmFtZXRlcigiY29udGVudCIpOw0KKyAgICAgICAgWFdpa2lEb2N1bWVudCBkb2MgPSBjb250ZXh0LmdldERvYygpOw0KKyAgICAgICAgWFdpa2lGb3JtIGZvcm0gPSBjb250ZXh0LmdldEZvcm0oKTsNCisgICAgICAgIFZlbG9jaXR5Q29udGV4dCB2Y29udGV4dCA9IChWZWxvY2l0eUNvbnRleHQpIGNvbnRleHQuZ2V0KCJ2Y29udGV4dCIpOw0KKw0KKyAgICAgICAgc3luY2hyb25pemVkIChkb2MpIHsNCisgICAgICAgICAgICBYV2lraURvY3VtZW50IHRkb2MgPSAoWFdpa2lEb2N1bWVudCkgY29udGV4dC5nZXQoInRkb2MiKTsNCisgICAgICAgICAgICBFZGl0Rm9ybSBwZWZvcm0gPSAoRWRpdEZvcm0pIGZvcm07DQorICAgICAgICAgICAgU3RyaW5nIHBhcmVudCA9IHBlZm9ybS5nZXRQYXJlbnQoKTsNCisgICAgICAgICAgICBpZiAocGFyZW50IT1udWxsKQ0KKyAgICAgICAgICAgICAgICBkb2Muc2V0UGFyZW50KHBhcmVudCk7DQorICAgICAgICAgICAgU3RyaW5nIGNyZWF0b3IgPSBwZWZvcm0uZ2V0Q3JlYXRvcigpOw0KKyAgICAgICAgICAgIGlmIChjcmVhdG9yIT1udWxsKQ0KKyAgICAgICAgICAgICAgICBkb2Muc2V0Q3JlYXRvcihjcmVhdG9yKTsNCisgICAgICAgICAgICBTdHJpbmcgZGVmYXVsdFRlbXBsYXRlID0gcGVmb3JtLmdldERlZmF1bHRUZW1wbGF0ZSgpOw0KKyAgICAgICAgICAgIGlmIChkZWZhdWx0VGVtcGxhdGUhPW51bGwpDQorICAgICAgICAgICAgICAgIGRvYy5zZXREZWZhdWx0VGVtcGxhdGUoZGVmYXVsdFRlbXBsYXRlKTsNCisgICAgICAgICAgICBTdHJpbmcgZGVmYXVsdExhbmd1YWdlID0gcGVmb3JtLmdldERlZmF1bHRMYW5ndWFnZSgpOw0KKyAgICAgICAgICAgIGlmICgoZGVmYXVsdExhbmd1YWdlIT1udWxsKSYmIWRlZmF1bHRMYW5ndWFnZS5lcXVhbHMoIiIpKQ0KKyAgICAgICAgICAgICAgICBkb2Muc2V0RGVmYXVsdExhbmd1YWdlKGRlZmF1bHRMYW5ndWFnZSk7DQorICAgICAgICAgICAgaWYgKGRvYy5nZXREZWZhdWx0TGFuZ3VhZ2UoKS5lcXVhbHMoIiIpKQ0KKyAgICAgICAgICAgICAgICBkb2Muc2V0RGVmYXVsdExhbmd1YWdlKGNvbnRleHQuZ2V0V2lraSgpLmdldExhbmd1YWdlUHJlZmVyZW5jZShjb250ZXh0KSk7DQorDQorICAgICAgICAgICAgU3RyaW5nIGxhbmd1YWdlID0gY29udGV4dC5nZXRXaWtpKCkuZ2V0TGFuZ3VhZ2VQcmVmZXJlbmNlKGNvbnRleHQpOw0KKyAgICAgICAgICAgIFN0cmluZyBsYW5ndWFnZWZyb21yZXF1ZXN0ID0gY29udGV4dC5nZXRSZXF1ZXN0KCkuZ2V0UGFyYW1ldGVyKCJsYW5ndWFnZSIpOw0KKyAgICAgICAgICAgIFN0cmluZyBsYW5ndWFnZXRvZWRpdCA9ICgobGFuZ3VhZ2Vmcm9tcmVxdWVzdD09bnVsbCl8fChsYW5ndWFnZWZyb21yZXF1ZXN0LmVxdWFscygiIikpKSA/DQorICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZSA6IGxhbmd1YWdlZnJvbXJlcXVlc3Q7DQorDQorICAgICAgICAgICAgaWYgKChsYW5ndWFnZXRvZWRpdD09bnVsbCl8fChsYW5ndWFnZXRvZWRpdC5lcXVhbHMoImRlZmF1bHQiKSkpDQorICAgICAgICAgICAgICAgIGxhbmd1YWdldG9lZGl0ID0gIiI7DQorICAgICAgICAgICAgaWYgKGRvYy5pc05ldygpfHwoZG9jLmdldERlZmF1bHRMYW5ndWFnZSgpLmVxdWFscyhsYW5ndWFnZXRvZWRpdCkpKQ0KKyAgICAgICAgICAgICAgICBsYW5ndWFnZXRvZWRpdCA9ICIiOw0KKw0KKyAgICAgICAgICAgIGlmIChsYW5ndWFnZXRvZWRpdC5lcXVhbHMoIiIpKSB7DQorICAgICAgICAgICAgICAgIC8vIEluIHRoaXMgY2FzZSB0aGUgY3JlYXRlZCBkb2N1bWVudCBpcyBnb2luZyB0byBiZSB0aGUgZGVmYXVsdCBkb2N1bWVudA0KKyAgICAgICAgICAgICAgICB0ZG9jID0gZG9jOw0KKyAgICAgICAgICAgICAgICBjb250ZXh0LnB1dCgidGRvYyIsIGRvYyk7DQorICAgICAgICAgICAgICAgIHZjb250ZXh0LnB1dCgidGRvYyIsIHZjb250ZXh0LmdldCgiZG9jIikpOw0KKyAgICAgICAgICAgICAgICBpZiAoZG9jLmlzTmV3KCkpIHsNCisgICAgICAgICAgICAgICAgICAgIGRvYy5zZXREZWZhdWx0TGFuZ3VhZ2UobGFuZ3VhZ2UpOw0KKyAgICAgICAgICAgICAgICAgICAgZG9jLnNldExhbmd1YWdlKCIiKTsNCisgICAgICAgICAgICAgICAgfQ0KKyAgICAgICAgICAgIH0gZWxzZSB7DQorICAgICAgICAgICAgICAgIC8vIElmIHRoZSB0cmFuc2xhdGVkIGRvYyBvYmplY3QgaXMgdGhlIHNhbWUgYXMgdGhlIGRvYyBvYmplY3QNCisgICAgICAgICAgICAgICAgLy8gdGhpcyBtZWFucyB0aGUgdHJhbnNsYXRlZCBkb2MgZGlkIG5vdCBleGlzdHMgc28gd2UgbmVlZCB0byBjcmVhdGUgaXQNCisgICAgICAgICAgICAgICAgaWYgKCh0ZG9jPT1kb2MpKSB7DQorICAgICAgICAgICAgICAgICAgICB0ZG9jID0gbmV3IFhXaWtpRG9jdW1lbnQoZG9jLmdldFdlYigpLCBkb2MuZ2V0TmFtZSgpKTsNCisgICAgICAgICAgICAgICAgICAgIHRkb2Muc2V0TGFuZ3VhZ2UobGFuZ3VhZ2V0b2VkaXQpOw0KKyAgICAgICAgICAgICAgICAgICAgdGRvYy5zZXRDb250ZW50KGRvYy5nZXRDb250ZW50KCkpOw0KKyAgICAgICAgICAgICAgICAgICAgdGRvYy5zZXRBdXRob3IoY29udGV4dC5nZXRVc2VyKCkpOw0KKyAgICAgICAgICAgICAgICAgICAgdGRvYy5zZXRTdG9yZShkb2MuZ2V0U3RvcmUoKSk7DQorICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnB1dCgidGRvYyIsIHRkb2MpOw0KKyAgICAgICAgICAgICAgICAgICAgdmNvbnRleHQucHV0KCJ0ZG9jIiwgbmV3IERvY3VtZW50KHRkb2MsIGNvbnRleHQpKTsNCisgICAgICAgICAgICAgICAgfQ0KKyAgICAgICAgICAgIH0NCisNCisgICAgICAgICAgICBYV2lraURvY3VtZW50IHRkb2MyID0gKFhXaWtpRG9jdW1lbnQpIHRkb2MuY2xvbmUoKTsNCisgICAgICAgICAgICBpZiAoY29udGVudCAhPSBudWxsICYmICFjb250ZW50LmVxdWFscygiIikpDQorICAgICAgICAgICAgICAgIHRkb2MyLnNldENvbnRlbnQoY29udGVudCk7DQorICAgICAgICAgICAgY29udGV4dC5wdXQoInRkb2MiLCB0ZG9jMik7DQorICAgICAgICAgICAgdmNvbnRleHQucHV0KCJ0ZG9jIiwgbmV3IERvY3VtZW50KHRkb2MyLCBjb250ZXh0KSk7DQorICAgICAgICAgICAgdHJ5ew0KKyAgICAgICAgICAgIAl0ZG9jMi5yZWFkRnJvbVRlbXBsYXRlKHBlZm9ybSwgY29udGV4dCk7DQorICAgICAgICAgICAgfQ0KKyAgICAgICAgICAgIGNhdGNoIChYV2lraUV4Y2VwdGlvbiBlKSB7DQorICAgICAgICAgICAgICAgIGlmIChlLmdldENvZGUoKSA9PSBYV2lraUV4Y2VwdGlvbi5FUlJPUl9YV0lLSV9BUFBfRE9DVU1FTlRfTk9UX0VNUFRZKSB7DQorICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnB1dCgiZXhjZXB0aW9uIiwgZSk7DQorICAgICAgICAgICAgICAgICAgICByZXR1cm4gImRvY2FscmVhZHlleGlzdHMiOw0KKyAgICAgICAgICAgICAgICB9DQorICAgICAgICAgICAgfQ0KKw0KKyAgICAgICAgICAgIC8qIFNldHVwIGEgbG9jayAqLw0KKyAgICAgICAgICAgIHRyeSB7DQorICAgICAgICAgICAgICAgIFhXaWtpTG9jayBsb2NrID0gdGRvYy5nZXRMb2NrKGNvbnRleHQpOw0KKyAgICAgICAgICAgICAgICBpZiAoKGxvY2sgPT0gbnVsbCkgfHwgKGxvY2suZ2V0VXNlck5hbWUoKS5lcXVhbHMoY29udGV4dC5nZXRVc2VyKCkpKSB8fCAocGVmb3JtLmlzTG9ja0ZvcmNlKCkpKQ0KKyAgICAgICAgICAgICAgICAgICAgdGRvYy5zZXRMb2NrKGNvbnRleHQuZ2V0VXNlcigpLGNvbnRleHQpOw0KKyAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7DQorICAgICAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7DQorICAgICAgICAgICAgICAgIC8vIExvY2sgc2hvdWxkIG5ldmVyIG1ha2UgWFdpa2kgZmFpbA0KKyAgICAgICAgICAgICAgICAvLyBCdXQgd2Ugc2hvdWxkIGxvZyBhbnkgcmVsYXRlZCBpbmZvcm1hdGlvbg0KKyAgICAgICAgICAgICAgICBsb2cuZXJyb3IoIkV4Y2VwdGlvbiB3aGlsZSBzZXR0aW5nIHVwIGxvY2siLCBlKTsNCisgICAgICAgICAgICB9DQorICAgICAgICB9DQorDQorICAgICAgICByZXR1cm4gImFkbWluIjsNCisJfQ0KK30NCmRpZmYgLXUgLXIgLS1leGNsdWRlPS5zdm4gLS1uZXctZmlsZSAtLWlnbm9yZS1tYXRjaGluZy1saW5lcz0nXmltcG9ydCcgLS1pZ25vcmUtYmxhbmstbGluZXMgLS1pZ25vcmUtYWxsLXNwYWNlIHNyYy9tYWluL2phdmEvY29tL3hwbi94d2lraS93ZWIvRGVsZXRlQWN0aW9uLmphdmEgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS93ZWIvRGVsZXRlQWN0aW9uLmphdmEKLS0tIHNyYy9tYWluL2phdmEvY29tL3hwbi94d2lraS93ZWIvRGVsZXRlQWN0aW9uLmphdmEJMjAwNi0wNy0xMiAxNDoxMDowMC4wMDAwMDAwMDAgKzAzMDAKKysrIHNyY19pbnRlcmZhY2UvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvd2ViL0RlbGV0ZUFjdGlvbi5qYXZhCTIwMDYtMDgtMDkgMjI6MTI6NDguMDAwMDAwMDAwICswMzAwCkBAIC01NywxMCArNTcsNyBAQAogCX0NCiAJDQogCXB1YmxpYyBTdHJpbmcgcmVuZGVyKFhXaWtpQ29udGV4dCBjb250ZXh0KSB0aHJvd3MgWFdpa2lFeGNlcHRpb24gew0KLSAgICAgICAgWFdpa2kgeHdpa2kgPSBjb250ZXh0LmdldFdpa2koKTsNCiAgICAgICAgIFhXaWtpUmVxdWVzdCByZXF1ZXN0ID0gY29udGV4dC5nZXRSZXF1ZXN0KCk7DQotICAgICAgICBYV2lraVJlc3BvbnNlIHJlc3BvbnNlID0gY29udGV4dC5nZXRSZXNwb25zZSgpOw0KLSAgICAgICAgWFdpa2lEb2N1bWVudCBkb2MgPSBjb250ZXh0LmdldERvYygpOw0KICAgICAgICAgU3RyaW5nIGNvbmZpcm0gPSByZXF1ZXN0LmdldFBhcmFtZXRlcigiY29uZmlybSIpOw0KICAgICAgICAgaWYgKChjb25maXJtIT1udWxsKSYmKGNvbmZpcm0uZXF1YWxzKCIxIikpKSB7DQogICAgICAgICAgICAgcmV0dXJuICJkZWxldGVkIjsNCmRpZmYgLXUgLXIgLS1leGNsdWRlPS5zdm4gLS1uZXctZmlsZSAtLWlnbm9yZS1tYXRjaGluZy1saW5lcz0nXmltcG9ydCcgLS1pZ25vcmUtYmxhbmstbGluZXMgLS1pZ25vcmUtYWxsLXNwYWNlIHNyYy9tYWluL2phdmEvY29tL3hwbi94d2lraS93ZWIvRWRpdEFjdGlvbi5qYXZhIHNyY19pbnRlcmZhY2UvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvd2ViL0VkaXRBY3Rpb24uamF2YQotLS0gc3JjL21haW4vamF2YS9jb20veHBuL3h3aWtpL3dlYi9FZGl0QWN0aW9uLmphdmEJMjAwNi0wOC0wOSAyMDowODozNi4wMDAwMDAwMDAgKzAzMDAKKysrIHNyY19pbnRlcmZhY2UvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvd2ViL0VkaXRBY3Rpb24uamF2YQkyMDA2LTA4LTA5IDIyOjE1OjA4LjAwMDAwMDAwMCArMDMwMApAQCAtOTksNyArOTksMTUgQEAKICAgICAgICAgICAgICAgICB0ZG9jMi5zZXRDb250ZW50KGNvbnRlbnQpOw0KICAgICAgICAgICAgIGNvbnRleHQucHV0KCJ0ZG9jIiwgdGRvYzIpOw0KICAgICAgICAgICAgIHZjb250ZXh0LnB1dCgidGRvYyIsIG5ldyBEb2N1bWVudCh0ZG9jMiwgY29udGV4dCkpOw0KKyAgICAgICAgICAgIHRyeXsNCiAgICAgICAgICAgICB0ZG9jMi5yZWFkRnJvbVRlbXBsYXRlKHBlZm9ybSwgY29udGV4dCk7DQorICAgICAgICAgICAgfQ0KKyAgICAgICAgICAgIGNhdGNoIChYV2lraUV4Y2VwdGlvbiBlKSB7DQorICAgICAgICAgICAgICAgIGlmIChlLmdldENvZGUoKSA9PSBYV2lraUV4Y2VwdGlvbi5FUlJPUl9YV0lLSV9BUFBfRE9DVU1FTlRfTk9UX0VNUFRZKSB7DQorICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnB1dCgiZXhjZXB0aW9uIiwgZSk7DQorICAgICAgICAgICAgICAgICAgICByZXR1cm4gImRvY2FscmVhZHlleGlzdHMiOw0KKyAgICAgICAgICAgICAgICB9DQorICAgICAgICAgICAgfQ0KIA0KICAgICAgICAgICAgIC8qIFNldHVwIGEgbG9jayAqLw0KICAgICAgICAgICAgIHRyeSB7DQpkaWZmIC11IC1yIC0tZXhjbHVkZT0uc3ZuIC0tbmV3LWZpbGUgLS1pZ25vcmUtbWF0Y2hpbmctbGluZXM9J15pbXBvcnQnIC0taWdub3JlLWJsYW5rLWxpbmVzIC0taWdub3JlLWFsbC1zcGFjZSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvd2ViL0pTQWN0aW9uLmphdmEgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS93ZWIvSlNBY3Rpb24uamF2YQotLS0gc3JjL21haW4vamF2YS9jb20veHBuL3h3aWtpL3dlYi9KU0FjdGlvbi5qYXZhCTE5NzAtMDEtMDEgMDI6MDA6MDAuMDAwMDAwMDAwICswMjAwCisrKyBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL3dlYi9KU0FjdGlvbi5qYXZhCTIwMDYtMDgtMDkgMjI6MjU6MjkuMDAwMDAwMDAwICswMzAwCkBAIC0wLDAgKzEsNzEgQEAKKy8qCisgKiBDb3B5cmlnaHQgMjAwNiwgWHBlcnROZXQgU0FSTCwgYW5kIGluZGl2aWR1YWwgY29udHJpYnV0b3JzIGFzIGluZGljYXRlZAorICogYnkgdGhlIGNvbnRyaWJ1dG9ycy50eHQuCisgKgorICogVGhpcyBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5IGl0CisgKiB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcworICogcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIuMSBvZgorICogdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCisgKgorICogVGhpcyBzb2Z0d2FyZSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gU2VlIHRoZSBHTlUKKyAqIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCisgKgorICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYworICogTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgc29mdHdhcmU7IGlmIG5vdCwgd3JpdGUgdG8gdGhlIEZyZWUKKyAqIFNvZnR3YXJlIEZvdW5kYXRpb24sIEluYy4sIDUxIEZyYW5rbGluIFN0LCBGaWZ0aCBGbG9vciwgQm9zdG9uLCBNQQorICogMDIxMTAtMTMwMSBVU0EsIG9yIHNlZSB0aGUgRlNGIHNpdGU6IGh0dHA6Ly93d3cuZnNmLm9yZy4KKyAqCisgKiBAYXV0aG9yIG5hbXBodW5naGFpCisgKiBAYXV0aG9yIHRvcmNxCisgKiBAYXV0aG9yIHNkdW1pdHJpdQorICovCitwYWNrYWdlIGNvbS54cG4ueHdpa2kud2ViOw0KKw0KK2ltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOworCitpbXBvcnQgb3JnLmFwYWNoZS52ZWxvY2l0eS5WZWxvY2l0eUNvbnRleHQ7CisKK2ltcG9ydCBjb20ueHBuLnh3aWtpLlhXaWtpQ29udGV4dDsKK2ltcG9ydCBjb20ueHBuLnh3aWtpLlhXaWtpRXhjZXB0aW9uOworaW1wb3J0IGNvbS54cG4ueHdpa2kuYXBpLkRvY3VtZW50OworaW1wb3J0IGNvbS54cG4ueHdpa2kuZG9jLlhXaWtpRG9jdW1lbnQ7CisNCitwdWJsaWMgY2xhc3MgSlNBY3Rpb24gZXh0ZW5kcyBYV2lraUFjdGlvbiB7DQorICAgIHB1YmxpYyBib29sZWFuIGFjdGlvbihYV2lraUNvbnRleHQgY29udGV4dCkgdGhyb3dzIFhXaWtpRXhjZXB0aW9uIHsNCisgICAgICAgIFhXaWtpUmVxdWVzdCByZXF1ZXN0ID0gY29udGV4dC5nZXRSZXF1ZXN0KCk7DQorICAgICAgICBTdHJpbmcgcmV2ID0gcmVxdWVzdC5nZXRQYXJhbWV0ZXIoInJldiIpOw0KKyAgICAgICAgaWYgKHJldiE9bnVsbCkgew0KKyAgICAgICAgICAgIFN0cmluZyB1cmwgPSBjb250ZXh0LmdldERvYygpLmdldFVSTCgidmlld3JldiIsIHJlcXVlc3QuZ2V0UXVlcnlTdHJpbmcoKSwgY29udGV4dCk7DQorICAgICAgICAgICAgdHJ5IHsNCisgICAgICAgICAgICAgICAgY29udGV4dC5nZXRSZXNwb25zZSgpLnNlbmRSZWRpcmVjdCh1cmwpOw0KKyAgICAgICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUpIHsNCisgICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTsNCisgICAgICAgICAgICB9DQorICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KKyAgICAgICAgfQ0KKyAgICAgICAgcmV0dXJuIHRydWU7DQorICAgIH0NCisNCisgICAgcHVibGljIFN0cmluZyByZW5kZXIoWFdpa2lDb250ZXh0IGNvbnRleHQpIHRocm93cyBYV2lraUV4Y2VwdGlvbiB7DQorICAgICAgICBYV2lraVJlcXVlc3QgcmVxdWVzdCA9IGNvbnRleHQuZ2V0UmVxdWVzdCgpOworICAgICAgICBTdHJpbmcgcmV2ID0gcmVxdWVzdC5nZXRQYXJhbWV0ZXIoInJldiIpOworCisgICAgICAgIGlmIChyZXYhPW51bGwpIHsKKyAgICAgICAgICAgIGNvbnRleHQucHV0KCJyZXYiLCByZXYpOworICAgICAgICAgICAgWFdpa2lEb2N1bWVudCBkb2MgPSAoWFdpa2lEb2N1bWVudCkgY29udGV4dC5nZXQoImRvYyIpOworICAgICAgICAgICAgWFdpa2lEb2N1bWVudCB0ZG9jID0gKFhXaWtpRG9jdW1lbnQpIGNvbnRleHQuZ2V0KCJ0ZG9jIik7CisgICAgICAgICAgICBYV2lraURvY3VtZW50IHJkb2MgPSBjb250ZXh0LmdldFdpa2koKS5nZXREb2N1bWVudChkb2MsIHJldiwgY29udGV4dCk7CisgICAgICAgICAgICBYV2lraURvY3VtZW50IHJ0ZG9jID0gY29udGV4dC5nZXRXaWtpKCkuZ2V0RG9jdW1lbnQodGRvYywgcmV2LCBjb250ZXh0KTsKKyAgICAgICAgICAgIGNvbnRleHQucHV0KCJ0ZG9jIiwgcnRkb2MpOworICAgICAgICAgICAgY29udGV4dC5wdXQoImNkb2MiLCByZG9jKTsKKyAgICAgICAgICAgIGNvbnRleHQucHV0KCJkb2MiLCByZG9jKTsKKyAgICAgICAgICAgIFZlbG9jaXR5Q29udGV4dCB2Y29udGV4dCA9IChWZWxvY2l0eUNvbnRleHQpIGNvbnRleHQuZ2V0KCJ2Y29udGV4dCIpOworICAgICAgICAgICAgdmNvbnRleHQucHV0KCJkb2MiLCBuZXcgRG9jdW1lbnQocmRvYywgY29udGV4dCkpOworICAgICAgICAgICAgdmNvbnRleHQucHV0KCJjZG9jIiwgdmNvbnRleHQuZ2V0KCJkb2MiKSk7CisgICAgICAgICAgICB2Y29udGV4dC5wdXQoInRkb2MiLCBuZXcgRG9jdW1lbnQocnRkb2MsIGNvbnRleHQpKTsKKyAgICAgICAgfQorICAgICAgICByZXR1cm4gImpzIjsKKyAgICB9DQorfQ0KZGlmZiAtdSAtciAtLWV4Y2x1ZGU9LnN2biAtLW5ldy1maWxlIC0taWdub3JlLW1hdGNoaW5nLWxpbmVzPSdeaW1wb3J0JyAtLWlnbm9yZS1ibGFuay1saW5lcyAtLWlnbm9yZS1hbGwtc3BhY2Ugc3JjL21haW4vamF2YS9jb20veHBuL3h3aWtpL3dlYi9SZWRpcmVjdEFjdGlvbi5qYXZhIHNyY19pbnRlcmZhY2UvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvd2ViL1JlZGlyZWN0QWN0aW9uLmphdmEKLS0tIHNyYy9tYWluL2phdmEvY29tL3hwbi94d2lraS93ZWIvUmVkaXJlY3RBY3Rpb24uamF2YQkxOTcwLTAxLTAxIDAyOjAwOjAwLjAwMDAwMDAwMCArMDIwMAorKysgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS93ZWIvUmVkaXJlY3RBY3Rpb24uamF2YQkyMDA2LTA4LTA5IDIyOjI1OjQ5LjAwMDAwMDAwMCArMDMwMApAQCAtMCwwICsxLDM5IEBACisvKgorICogQ29weXJpZ2h0IDIwMDYsIFhwZXJ0TmV0IFNBUkwsIGFuZCBpbmRpdmlkdWFsIGNvbnRyaWJ1dG9ycyBhcyBpbmRpY2F0ZWQKKyAqIGJ5IHRoZSBjb250cmlidXRvcnMudHh0LgorICoKKyAqIFRoaXMgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeSBpdAorICogdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMKKyAqIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyLjEgb2YKKyAqIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorICoKKyAqIFRoaXMgc29mdHdhcmUgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKKyAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCisgKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuIFNlZSB0aGUgR05VCisgKiBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgorICoKKyAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAqIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIHNvZnR3YXJlOyBpZiBub3QsIHdyaXRlIHRvIHRoZSBGcmVlCisgKiBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBJbmMuLCA1MSBGcmFua2xpbiBTdCwgRmlmdGggRmxvb3IsIEJvc3RvbiwgTUEKKyAqIDAyMTEwLTEzMDEgVVNBLCBvciBzZWUgdGhlIEZTRiBzaXRlOiBodHRwOi8vd3d3LmZzZi5vcmcuCisgKgorICogQGF1dGhvciBzZHVtaXRyaXUKKyAqLworcGFja2FnZSBjb20ueHBuLnh3aWtpLndlYjsNCisNCitpbXBvcnQgY29tLnhwbi54d2lraS5YV2lraUNvbnRleHQ7DQoraW1wb3J0IGNvbS54cG4ueHdpa2kuWFdpa2lFeGNlcHRpb247DQorDQorcHVibGljIGNsYXNzIFJlZGlyZWN0QWN0aW9uIGV4dGVuZHMgWFdpa2lBY3Rpb24gew0KKwlwdWJsaWMgYm9vbGVhbiBhY3Rpb24oWFdpa2lDb250ZXh0IGNvbnRleHQpIHRocm93cyBYV2lraUV4Y2VwdGlvbiB7DQorICAgICAgICBYV2lraVJlcXVlc3QgcmVxdWVzdCA9IGNvbnRleHQuZ2V0UmVxdWVzdCgpOw0KKyAgICAgICAgWFdpa2lSZXNwb25zZSByZXNwb25zZSA9IGNvbnRleHQuZ2V0UmVzcG9uc2UoKTsNCisNCisgICAgICAgIFN0cmluZyByZWRpcmVjdDsNCisgICAgICAgIHJlZGlyZWN0ID0gY29udGV4dC5nZXRSZXF1ZXN0KCkuZ2V0UGFyYW1ldGVyKCJ4cmVkaXJlY3QiKTsNCisgICAgICAgIGlmICgocmVkaXJlY3QgPT0gbnVsbCl8fChyZWRpcmVjdC5lcXVhbHMoIiIpKSkNCisgICAgICAgICAgICByZWRpcmVjdCA9IGNvbnRleHQuZ2V0VVJMRmFjdG9yeSgpLmNyZWF0ZVVSTCgiTWFpbiIsICJXZWJIb21lIiwgInZpZXciLCBjb250ZXh0KS50b1N0cmluZygpOw0KKyAgICAgICAgc2VuZFJlZGlyZWN0KHJlc3BvbnNlLCByZWRpcmVjdCk7DQorICAgICAgICByZXR1cm4gZmFsc2U7DQorCX0NCit9DQpkaWZmIC11IC1yIC0tZXhjbHVkZT0uc3ZuIC0tbmV3LWZpbGUgLS1pZ25vcmUtbWF0Y2hpbmctbGluZXM9J15pbXBvcnQnIC0taWdub3JlLWJsYW5rLWxpbmVzIC0taWdub3JlLWFsbC1zcGFjZSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvd2ViL1JvbGxiYWNrQWN0aW9uLmphdmEgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS93ZWIvUm9sbGJhY2tBY3Rpb24uamF2YQotLS0gc3JjL21haW4vamF2YS9jb20veHBuL3h3aWtpL3dlYi9Sb2xsYmFja0FjdGlvbi5qYXZhCTIwMDYtMDctMTIgMTQ6MTA6MDAuMDAwMDAwMDAwICswMzAwCisrKyBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL3dlYi9Sb2xsYmFja0FjdGlvbi5qYXZhCTIwMDYtMDgtMDkgMjI6MTY6NTguMDAwMDAwMDAwICswMzAwCkBAIC0zNCwxMCArMzQsMTUgQEAKICAgICAgICAgWFdpa2lEb2N1bWVudCBkb2MgPSBjb250ZXh0LmdldERvYygpOw0KICAgICAgICAgUm9sbGJhY2tGb3JtIGZvcm0gPSAoUm9sbGJhY2tGb3JtKSBjb250ZXh0LmdldEZvcm0oKTsNCiANCisgICAgICAgIFN0cmluZyBjb25maXJtID0gZm9ybS5nZXRDb25maXJtKCk7DQogICAgICAgICBTdHJpbmcgcmV2ID0gZm9ybS5nZXRSZXYoKTsNCiAgICAgICAgIFN0cmluZyBsYW5ndWFnZSA9IGZvcm0uZ2V0TGFuZ3VhZ2UoKTsNCiAgICAgICAgIFhXaWtpRG9jdW1lbnQgdGRvYzsNCiANCisgICAgICAgIGlmKChjb25maXJtID09IG51bGwpIHx8ICghY29uZmlybS5lcXVhbHMoIjEiKSkpeworICAgICAgICAgICAgcmV0dXJuIHRydWU7CisgICAgICAgIH0KKw0KICAgICAgICAgaWYgKChsYW5ndWFnZT09bnVsbCl8fChsYW5ndWFnZS5lcXVhbHMoIiIpKXx8KGxhbmd1YWdlLmVxdWFscygiZGVmYXVsdCIpKXx8KGxhbmd1YWdlLmVxdWFscyhkb2MuZ2V0RGVmYXVsdExhbmd1YWdlKCkpKSkgew0KICAgICAgICAgICAgIC8vIE5lZWQgdG8gc2F2ZSBwYXJlbnQgYW5kIGRlZmF1bHRMYW5ndWFnZSBpZiB0aGV5IGhhdmUgY2hhbmdlZA0KICAgICAgICAgICAgIHRkb2MgPSBkb2M7DQpAQCAtNjMsNCArNjgsOSBAQAogICAgICAgICBzZW5kUmVkaXJlY3QocmVzcG9uc2UsIHJlZGlyZWN0KTsNCiAgICAgICAgIHJldHVybiBmYWxzZTsNCiAJfQ0KKworICAgIHB1YmxpYyBTdHJpbmcgcmVuZGVyKFhXaWtpQ29udGV4dCBjb250ZXh0KSB0aHJvd3MgWFdpa2lFeGNlcHRpb24geworICAgICAgICBoYW5kbGVSZXZpc2lvbihjb250ZXh0KTsKKyAgICAgIAlyZXR1cm4gInJvbGxiYWNrIjsKKyAgICB9CiB9DQpkaWZmIC11IC1yIC0tZXhjbHVkZT0uc3ZuIC0tbmV3LWZpbGUgLS1pZ25vcmUtbWF0Y2hpbmctbGluZXM9J15pbXBvcnQnIC0taWdub3JlLWJsYW5rLWxpbmVzIC0taWdub3JlLWFsbC1zcGFjZSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvd2ViL1JvbGxiYWNrRm9ybS5qYXZhIHNyY19pbnRlcmZhY2UvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvd2ViL1JvbGxiYWNrRm9ybS5qYXZhCi0tLSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvd2ViL1JvbGxiYWNrRm9ybS5qYXZhCTIwMDYtMDctMTIgMTQ6MTA6MDAuMDAwMDAwMDAwICswMzAwCisrKyBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL3dlYi9Sb2xsYmFja0Zvcm0uamF2YQkyMDA2LTA4LTA5IDIyOjE3OjM0LjAwMDAwMDAwMCArMDMwMApAQCAtMjQsMTEgKzI0LDEzIEBACiBwdWJsaWMgY2xhc3MgUm9sbGJhY2tGb3JtIGV4dGVuZHMgWFdpa2lGb3JtIHsNCiAgICAgcHJpdmF0ZSBTdHJpbmcgcmV2Ow0KICAgICBwcml2YXRlIFN0cmluZyBsYW5ndWFnZTsNCisgICAgcHJpdmF0ZSBTdHJpbmcgY29uZmlybTsNCiANCiAgICAgcHVibGljIHZvaWQgcmVhZFJlcXVlc3QoKSB7DQogICAgICAgICBYV2lraVJlcXVlc3QgcmVxdWVzdCA9IGdldFJlcXVlc3QoKTsNCiAgICAgICAgIHNldFJldihyZXF1ZXN0LmdldFBhcmFtZXRlcigicmV2IikpOw0KICAgICAgICAgc2V0TGFuZ3VhZ2UocmVxdWVzdC5nZXRQYXJhbWV0ZXIoImxhbmd1YWdlIikpOw0KKyAgICAgICAgc2V0Q29uZmlybShyZXF1ZXN0LmdldFBhcmFtZXRlcigiY29uZmlybSIpKTsNCiAgICAgfQ0KIA0KICAgICBwdWJsaWMgU3RyaW5nIGdldFJldigpIHsNCkBAIC00Niw0ICs0OCwxMiBAQAogICAgIHB1YmxpYyB2b2lkIHNldExhbmd1YWdlKFN0cmluZyBsYW5ndWFnZSkgew0KICAgICAgICAgdGhpcy5sYW5ndWFnZSA9IGxhbmd1YWdlOw0KICAgICB9DQorCisJcHVibGljIFN0cmluZyBnZXRDb25maXJtKCkgeworCQlyZXR1cm4gY29uZmlybTsKKwl9CisKKwlwdWJsaWMgdm9pZCBzZXRDb25maXJtKFN0cmluZyBjb25maXJtKSB7CisJCXRoaXMuY29uZmlybSA9IGNvbmZpcm07CisJfQogfQpcIE5vIG5ld2xpbmUgYXQgZW5kIG9mIGZpbGUKZGlmZiAtdSAtciAtLWV4Y2x1ZGU9LnN2biAtLW5ldy1maWxlIC0taWdub3JlLW1hdGNoaW5nLWxpbmVzPSdeaW1wb3J0JyAtLWlnbm9yZS1ibGFuay1saW5lcyAtLWlnbm9yZS1hbGwtc3BhY2Ugc3JjL21haW4vamF2YS9jb20veHBuL3h3aWtpL3dlYi9Ta2luQWN0aW9uLmphdmEgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS93ZWIvU2tpbkFjdGlvbi5qYXZhCi0tLSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvd2ViL1NraW5BY3Rpb24uamF2YQkyMDA2LTA3LTEyIDE0OjEwOjAwLjAwMDAwMDAwMCArMDMwMAorKysgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS93ZWIvU2tpbkFjdGlvbi5qYXZhCTIwMDYtMDgtMDkgMjI6MjA6MDQuMDAwMDAwMDAwICswMzAwCkBAIC03MSw3ICs3MCwxMSBAQAogDQogICAgICAgICBpZiAoKGNvbnRlbnQhPW51bGwpJiYoIWNvbnRlbnQuZXF1YWxzKCIiKSkpIHsNCiAgICAgICAgICAgICAvLyBDaG9vc2UgdGhlIHJpZ2h0IGNvbnRlbnQgdHlwZQ0KLSAgICAgICAgICAgIHJlc3BvbnNlLnNldENvbnRlbnRUeXBlKHh3aWtpLmdldEVuZ2luZUNvbnRleHQoKS5nZXRNaW1lVHlwZShmaWxlbmFtZS50b0xvd2VyQ2FzZSgpKSk7DQorICAgICAgICAJU3RyaW5nIG1pbWV0eXBlID0geHdpa2kuZ2V0RW5naW5lQ29udGV4dCgpLmdldE1pbWVUeXBlKGZpbGVuYW1lLnRvTG93ZXJDYXNlKCkpOworICAgICAgICAJaWYobWltZXR5cGUuZXF1YWxzKCJ0ZXh0L2NzcyIpKXsKKyAgICAgICAgCQljb250ZW50ID0gY29udGV4dC5nZXRXaWtpKCkucGFyc2VDb250ZW50KGNvbnRlbnQsIGNvbnRleHQpOworICAgICAgICAJfQorICAgICAgICAgICAgcmVzcG9uc2Uuc2V0Q29udGVudFR5cGUobWltZXR5cGUpOwogICAgICAgICAgICAgcmVzcG9uc2Uuc2V0RGF0ZUhlYWRlcigiTGFzdC1Nb2RpZmllZCIsIGRvYy5nZXREYXRlKCkuZ2V0VGltZSgpKTsNCiAgICAgICAgICAgICAvLyBTZW5kaW5nIHRoZSBjb250ZW50IG9mIHRoZSBhdHRhY2htZW50DQogICAgICAgICAgICAgcmVzcG9uc2Uuc2V0Q29udGVudExlbmd0aChjb250ZW50Lmxlbmd0aCgpKTsNCkBAIC04OSw3ICs5MiwxMSBAQAogICAgICAgICAgICAgaWYgKGF0dGFjaG1lbnQhPW51bGwpIHsNCiAgICAgICAgICAgICAgICAgLy8gU2VuZGluZyB0aGUgY29udGVudCBvZiB0aGUgYXR0YWNobWVudA0KICAgICAgICAgICAgICAgICBieXRlW10gZGF0YSA9IGF0dGFjaG1lbnQuZ2V0Q29udGVudChjb250ZXh0KTsNCi0gICAgICAgICAgICAgICAgcmVzcG9uc2Uuc2V0Q29udGVudFR5cGUoeHdpa2kuZ2V0RW5naW5lQ29udGV4dCgpLmdldE1pbWVUeXBlKGZpbGVuYW1lLnRvTG93ZXJDYXNlKCkpKTsNCisgICAgICAgICAgICAgICAgU3RyaW5nIG1pbWV0eXBlID0geHdpa2kuZ2V0RW5naW5lQ29udGV4dCgpLmdldE1pbWVUeXBlKGZpbGVuYW1lLnRvTG93ZXJDYXNlKCkpOworICAgICAgICAgICAgICAgIGlmKG1pbWV0eXBlLmVxdWFscygidGV4dC9jc3MiKSl7CisgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBjb250ZXh0LmdldFdpa2koKS5wYXJzZUNvbnRlbnQobmV3IFN0cmluZyhkYXRhKSwgY29udGV4dCkuZ2V0Qnl0ZXMoKTsKKyAgICAgICAgICAgICAgICB9CisgICAgICAgICAgICAgICAgcmVzcG9uc2Uuc2V0Q29udGVudFR5cGUobWltZXR5cGUpOwogICAgICAgICAgICAgICAgIHJlc3BvbnNlLnNldERhdGVIZWFkZXIoIkxhc3QtTW9kaWZpZWQiLCBhdHRhY2htZW50LmdldERhdGUoKS5nZXRUaW1lKCkpOw0KICAgICAgICAgICAgICAgICByZXNwb25zZS5zZXRDb250ZW50TGVuZ3RoKGRhdGEubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgdHJ5IHsNCkBAIC0xMTksMTUgKzEyNiwxNCBAQAogICAgICAgICAgICAgICAgIHJlc3BvbnNlLnNldENvbnRlbnRUeXBlKCJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0iKTsNCiANCiAgICAgICAgICAgICAvLyBTZW5kaW5nIHRoZSBjb250ZW50IG9mIHRoZSBmaWxlDQotICAgICAgICAgICAgSW5wdXRTdHJlYW0gaXMgID0gY29udGV4dC5nZXRXaWtpKCkuZ2V0UmVzb3VyY2VBc1N0cmVhbShwYXRoKTsNCi0gICAgICAgICAgICBpZiAoaXM9PW51bGwpDQorICAgICAgICAgICAgYnl0ZVtdIGRhdGEgPSBjb250ZXh0LmdldFdpa2koKS5nZXRSZXNvdXJjZUNvbnRlbnRBc0J5dGVzKHBhdGgpOworICAgICAgICAgICAgaWYgKGRhdGEgPT0gbnVsbCB8fCBkYXRhLmxlbmd0aCA9PSAwKQogICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiANCi0gICAgICAgICAgICBpbnQgblJlYWQgPSAwOw0KLSAgICAgICAgICAgIGJ5dGVbXSBkYXRhID0gbmV3IGJ5dGVbNjU1MzVdOw0KLSAgICAgICAgICAgIHdoaWxlICgoblJlYWQgPSBpcy5yZWFkKGRhdGEpKSAhPS0xKSB7DQotICAgICAgICAgICAgICAgIHJlc3BvbnNlLmdldE91dHB1dFN0cmVhbSgpLndyaXRlKGRhdGEsMCxuUmVhZCk7DQorICAgICAgICAgICAgaWYobWltZXR5cGUuZXF1YWxzKCJ0ZXh0L2NzcyIpKXsKKyAgICAgICAgICAgIAlkYXRhID0gY29udGV4dC5nZXRXaWtpKCkucGFyc2VDb250ZW50KG5ldyBTdHJpbmcoZGF0YSksIGNvbnRleHQpLmdldEJ5dGVzKCk7CiAgICAgICAgICAgICB9DQorICAgICAgICAgICAgcmVzcG9uc2UuZ2V0T3V0cHV0U3RyZWFtKCkud3JpdGUoZGF0YSk7DQogICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7DQogICAgICAgICAgICAgaWYgKHNraW4uZXF1YWxzKHh3aWtpLmdldERlZmF1bHRCYXNlU2tpbihjb250ZXh0KSkpDQpkaWZmIC11IC1yIC0tZXhjbHVkZT0uc3ZuIC0tbmV3LWZpbGUgLS1pZ25vcmUtbWF0Y2hpbmctbGluZXM9J15pbXBvcnQnIC0taWdub3JlLWJsYW5rLWxpbmVzIC0taWdub3JlLWFsbC1zcGFjZSBzcmMvbWFpbi9qYXZhL2NvbS94cG4veHdpa2kvd2ViL1V0aWxzLmphdmEgc3JjX2ludGVyZmFjZS9tYWluL2phdmEvY29tL3hwbi94d2lraS93ZWIvVXRpbHMuamF2YQotLS0gc3JjL21haW4vamF2YS9jb20veHBuL3h3aWtpL3dlYi9VdGlscy5qYXZhCTIwMDYtMDctMTIgMTQ6MTA6MDAuMDAwMDAwMDAwICswMzAwCisrKyBzcmNfaW50ZXJmYWNlL21haW4vamF2YS9jb20veHBuL3h3aWtpL3dlYi9VdGlscy5qYXZhCTIwMDYtMDgtMDkgMjI6MjE6MTUuMDAwMDAwMDAwICswMzAwCkBAIC0xMDgsOCArMTE0LDEwIEBACiAgICAgICAgICAgICBpZiAoY29udGV4dC5nZXRSZXNwb25zZSgpIGluc3RhbmNlb2YgWFdpa2lTZXJ2bGV0UmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIGNvbnRlbnQgbGVuZ3RoIHRvIHRoZSBudW1uYmVyIG9mIGJ5dGVzLCBub3QgdGhlCiAgICAgICAgICAgICAgICAgLy8gc3RyaW5nIGxlbmd0aCwgc28gYXMgdG8gaGFuZGxlIG11bHRpLWJ5dGUgZW5jb2RpbmdzCi0gICAgICAgICAgICAgICAgcmVzcG9uc2Uuc2V0Q29udGVudExlbmd0aChjb250ZW50LmdldEJ5dGVzKCkubGVuZ3RoKTsKKyAgICAgICAgICAgICAgICB0cnl7CisgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLnNldENvbnRlbnRMZW5ndGgoY29udGVudC5nZXRCeXRlcygiVVRGLTgiKS5sZW5ndGgpOwogICAgICAgICAgICAgfQorICAgICAgICAgICAgICAgICAgY2F0Y2goVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiBleCl7cmVzcG9uc2Uuc2V0Q29udGVudExlbmd0aChjb250ZW50LmdldEJ5dGVzKCkubGVuZ3RoKTt9ICAgICAgICAgICAgfQogCiAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgIGlmICh3cml0ZSkK</content>
</attachment>
<object>
<class>
<name>XWiki.XWikiComments</name>
<customClass></customClass>
<customMapping></customMapping>
<defaultViewSheet></defaultViewSheet>
<defaultEditSheet></defaultEditSheet>
<defaultWeb></defaultWeb>
<nameField></nameField>
<author>
<name>author</name>
<prettyName>Author</prettyName>
<unmodifiable>0</unmodifiable>
<size>30</size>
<number>1</number>
<classType>com.xpn.xwiki.objects.classes.StringClass</classType>
</author>
<highlight>
<name>highlight</name>
<prettyName>Highlighted Text</prettyName>
<unmodifiable>0</unmodifiable>
<size>40</size>
<rows>2</rows>
<number>2</number>
<classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
</highlight>
<date>
<name>date</name>
<prettyName>Date</prettyName>
<unmodifiable>0</unmodifiable>
<size>20</size>
<dateFormat>dd/MM/yyyy HH:mm:ss</dateFormat>
<emptyIsToday>1</emptyIsToday>
<number>3</number>
<classType>com.xpn.xwiki.objects.classes.DateClass</classType>
</date>
<comment>
<name>comment</name>
<prettyName>Comment</prettyName>
<unmodifiable>0</unmodifiable>
<size>40</size>
<rows>5</rows>
<number>4</number>
<classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
</comment>
<replyto>
<name>replyto</name>
<prettyName>Reply To</prettyName>
<unmodifiable>0</unmodifiable>
<size>5</size>
<numberType>integer</numberType>
<number>5</number>
<classType>com.xpn.xwiki.objects.classes.NumberClass</classType>
</replyto>
</class>
<name>Sandbox.TestTopic1</name>
<number>0</number>
<className>XWiki.XWikiComments</className>
<property>
<comment>commmmeenttttt
hafhfhfhh</comment>
</property>
<property>
<date>2006-08-02 12:23:44.0</date>
</property>
<property>
<author>XWiki.XWikiGuest</author>
</property>
</object>
<content>[&amp;#355;&amp;#259;ru&amp;#351;|http://www.&amp;#355;&amp;#259;ru&amp;#351;.ro]</content>
</xwikidoc>
